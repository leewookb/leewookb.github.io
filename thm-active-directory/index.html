<!doctype html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/images/favicon.png" />

<title>[THM] Active Directory&nbsp;|&nbsp;Wook&#39;s blog</title>
<meta
  name="title"
  content="[THM] Active Directory"
/>
<meta
  name="description"
  content="Microsoft&rsquo;s Active Directory is the backbone of the corporate world. It simplifies the management of devices and users within a corporate environment.
Windows domain is a group of users and computers under the administration of a given business. The main idea behind a domain is to centralize the administration of common components of a Windows computer network in a sigle repository called Active Directory. The server that runs the Active Directory service is known as a Domain Controller (DC)."
/>
<meta
  name="keywords"
  content="TryHackMe,"
/>

  <meta name="author" content="Wook Lee" />




<meta property="og:url" content="http://localhost:1313/thm-active-directory/">
  <meta property="og:site_name" content="Wook&#39;s blog">
  <meta property="og:title" content="[THM] Active Directory">
  <meta property="og:description" content="Microsoft’s Active Directory is the backbone of the corporate world. It simplifies the management of devices and users within a corporate environment.
Windows domain is a group of users and computers under the administration of a given business. The main idea behind a domain is to centralize the administration of common components of a Windows computer network in a sigle repository called Active Directory. The server that runs the Active Directory service is known as a Domain Controller (DC).">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-07-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-07-16T00:00:00+00:00">
    <meta property="article:tag" content="TryHackMe">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[THM] Active Directory">
  <meta name="twitter:description" content="Microsoft’s Active Directory is the backbone of the corporate world. It simplifies the management of devices and users within a corporate environment.
Windows domain is a group of users and computers under the administration of a given business. The main idea behind a domain is to centralize the administration of common components of a Windows computer network in a sigle repository called Active Directory. The server that runs the Active Directory service is known as a Domain Controller (DC).">





  <meta itemprop="name" content="[THM] Active Directory">
  <meta itemprop="description" content="Microsoft’s Active Directory is the backbone of the corporate world. It simplifies the management of devices and users within a corporate environment.
Windows domain is a group of users and computers under the administration of a given business. The main idea behind a domain is to centralize the administration of common components of a Windows computer network in a sigle repository called Active Directory. The server that runs the Active Directory service is known as a Domain Controller (DC).">
  <meta itemprop="datePublished" content="2024-07-16T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-07-16T00:00:00+00:00">
  <meta itemprop="wordCount" content="1202">
  <meta itemprop="keywords" content="TryHackMe">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/blog/"
    
    >Blog</a
  >

  <a
    href="/photos/"
    
    >Photos</a
  >


  <a href="/index.xml">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 448 512">
      
      <path
        d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
    RSS
  </a>

</nav>

<h1>[THM] Active Directory</h1>


    </header>
    <main>
      
  
    
      
      <p>
        <i>
          <time datetime="2024-07-16" pubdate>
            2024-07-16
          </time>
        </i>
      </p>
    
  
  
  <content>
    <p>Microsoft&rsquo;s <strong><em>Active Directory</em></strong> is the backbone of the corporate world. It simplifies the management of devices and users within a corporate environment.</p>
<p><code>Windows domain</code> is a group of users and computers under the administration of a given business. The main idea behind a domain is to centralize the administration of common components of a Windows computer network in a sigle repository called <code>Active Directory</code>. The server that runs the Active Directory service is known as a <code>Domain Controller (DC)</code>.</p>
<p>The main advantages of having a configured Windows domain are:</p>
<ul>
<li><strong><em>Centralized identity management</em></strong>: All users across the network can be configured from Active Directory with minimum effort.</li>
<li><strong><em>Managing security policies</em></strong>: You can configure security policies directly from Active Directory and apply them to users and computers across the network as needed.</li>
</ul>
<h4 id="a-real-world-example">A Real-World Example</h4>
<p>In school/university networks, you will often be provided with a username and password that you can use on any of the computers available on campus. Your credentials are valid for all machines because whenever you input them on a machine, it will forward the authentication process back to the Active Directory, where you credentials will be checked. Thanks to Active Directory, your credentials don&rsquo;t need to exist in each machine and are available throughout the network.</p>
<h4 id="in-a-windows-domain-credentials-are-stored-in-a-centralised-repository-called">In a Windows domain, credentials are stored in a centralised repository called..</h4>






<pre tabindex="0"><code>Active Directory</code></pre>
<br>
<h4 id="the-server-in-charge-of-running-the-active-directory-services-is-called">The server in charge of running the Active Directory services is called..</h4>






<pre tabindex="0"><code>Domain Controller</code></pre>
<br>
<p>The core of any Windows Domain is the <strong><em>Active Directory Domain Service (AD DS)</em></strong>. This service acts as a catalogue that holds the information of all the &ldquo;objects&rdquo; that exist on your network. Amongst the many objects supported by AD, we have users, groups, machines, printers, shares, and many others.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="security-groups-vs-ous-orgianizational-units">Security Groups vs OUs (Orgianizational Units)</h4>
<ul>
<li><strong><em>OUs</em></strong> are handy for applying policies to users and computers, which include specific configurations that pertain to sets of users depending on their particular role in the enterprise. Remember, a user can only be a member of a single OU at a time, as it wouldn&rsquo;t make sense to try to apply two different policies to a single user.</li>
<li><strong><em>Security Groups</em></strong>, on the other hand, are used to grant permissions over resources. For example, you will use groups if you want to allow some users to access a shared folder or network printer. A user can be a part of many groups, which is needed to grant access to multiple resources.</li>
</ul>
<br>
<h4 id="which-group-normally-administrates-all-computers-and-resources-in-a-domain">Which group normally administrates all computers and resources in a domain?</h4>






<pre tabindex="0"><code>Domain Admins</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-would-be-the-name-of-the-machine-account-associated-with-a-machine-named-tom-pc">What would be the name of the machine account associated with a machine named TOM-PC?</h4>






<pre tabindex="0"><code>TOM-PC$</code></pre>
<br>
<h4 id="suppose-our-company-creates-a-new-department-for-quality-assurance-what-type-of-containers-should-we-use-to-group-all-quality-assurance-users-so-that-policies-can-be-applied-consistently-to-them">Suppose our company creates a new department for Quality Assurance. What type of containers should we use to group all Quality Assurance users so that policies can be applied consistently to them?</h4>






<pre tabindex="0"><code>Organizational Units</code></pre>
<br>
<h4 id="deletgation">Deletgation</h4>
<p>One of the nice things you can do in AD is to give specific users some control over some OUs. This process is known as <strong><em>delegation</em></strong> and allows you to grant users specific privileges to perform advanced tasks on OUs without needing a Domain Administrator to step in.</p>
<p>One of the most common use cases for this is granting <strong><em>IT Support</em></strong> the privileges to reset othe low-privilege users&rsquo; passwords.</p>
<br>
<p>I delegated our IT support (phillip) the rights to reset other people&rsquo;s passwords. Then I logged in as phillip then changed Sophie&rsquo;s passwords by running the following command:</p>
<p><code>Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password') - Verbose</code></p>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-was-the-flag-found-on-sophies-desktop">What was the flag found on Sophie&rsquo;s desktop?</h4>






<pre tabindex="0"><code>THM{thanks_for_contacting_support}</code></pre>
<p><img src="image-3.png#center" alt="alt text">
<img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="the-process-of-granting-privileges-to-a-user-over-some-ou-or-other-ad-object-is-called">The process of granting privileges to a user over some OU or other AD Object is called&hellip;</h4>






<pre tabindex="0"><code>delegation</code></pre>
<br>
<h4 id="after-organizing-the-available-computers-how-many-ended-up-in-the-workstations-ou">After organizing the available computers, how many ended up in the Workstations OU?</h4>






<pre tabindex="0"><code>7</code></pre>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="is-it-recommendable-to-create-separate-ous-for-servers-and-workstations-yaynay">Is it recommendable to create separate OUs for Servers and Workstations? (yay/nay)</h4>






<pre tabindex="0"><code>yay</code></pre>
<br>
<p>To deploy different policies for each OU individually Windows use <strong><em>Group Policy Objects (GPO)</em></strong>. GPOs are simply a collection of settings that can be applied to OUs. GPOs can contain policies aimed at either users or computers, allowing you to set a baseline on specific machines and identities.</p>
<br>
<h4 id="what-is-the-name-of-the-network-share-used-to-distribute-gpos-to-domain-machines">What is the name of the network share used to distribute GPOs to domain machines?</h4>






<pre tabindex="0"><code>SYSVOL</code></pre>
<p>GPOs are distributed to the network via a network share called <code>SYSVOL</code>, which is stored in the DC. All users in a domain should typically have access to this share over the network to sync their GPOs periodically.</p>
<br>
<h4 id="can-a-gpo-be-used-to-apply-settings-to-users-and-computers-yaynay">Can a GPO be used to apply settings to users and computers? (yay/nay)</h4>






<pre tabindex="0"><code>yay</code></pre>
<br>
<p>When using Windows domains, all credentials are stored in the <code>Domain Controllers</code>. Whenever a user tries to authenticate to a service using domain credentials, the service will need to ask the Domain Controller to verify if they are correct. Two protocols can be used for network authentication in windows domains:</p>
<ul>
<li><strong><em>Kerberos</em></strong>: used by any recent version of Windows. This is the default protocol in any recent domain.</li>
<li><strong><em>NetNTLM</em></strong>: Legacy authentication protocol kept for compatibility purposes.</li>
</ul>
<h4 id="kerberos-authentication">Kerberos Authentication</h4>
<p>Kerberos authentication is the default authentication protocol for any recent version of Windows. users who log into a service using Kerberos will be assigned tickets. Think of tickets as proof of a previous authentication. users with tickets can present them to a service to demonstrate they have already authenticated into the network before and are therefore enabled to use it.</p>
<p>When <code>Kerberos</code> is used for authentication, the following process happens:</p>
<ol>
<li>The user sends their encrypted credentials to the <code>Key Distribution Center (KDC)</code> in charge of creating Kerberos tickets on the network. The KDC will create and send back a <code>Ticket Granting Ticket</code>, which will allow the user to request additional tickets to access specific services. <code>TGT</code> is encrypted using the <code>krbgt</code> account&rsquo;s password hash and therefore the user can&rsquo;t access its contents.</li>
</ol>
<p><img src="image-6.png#center" alt="alt text"></p>
<ol start="2">
<li>
<p>When a user wants to connect to a service on the network, they will use their TGT to ask the KDC for a <code>Ticket Granting Service (TGS)</code>.
TGS are tickets that allow connection only to the specific service they were created for. To request a TGS, the user will send their credentials encrypted using the Session Key, along with the TGT and a <code>Service Principal Name (SPN)</code>, which indicates the service and server name we intend to access.</p>
<p>As a result, the KDC will send us a TGS along with a <code>Service Session Key</code>, which we will need to authenticate to the service we want to access. The TGS is encrypted using a key derived from the <code>Service Owner Hash</code>.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
</li>
<li>
<p>The TGS can then be sent to the desired service to authenticate and establish a connection. The service will use its configured account&rsquo;s password hash to decrypt the TGS and validate the Service Session Key.
<img src="image-8.png#center" alt="alt text"></p>
</li>
</ol>
<br>
<h4 id="netntlm-authentication">NetNTLM Authentication</h4>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<h4 id="will-a-current-version-of-windows-use-netntlm-as-the-preferred-authentication-protocol-by-default-yaynay">Will a current version of Windows use NetNTLM as the preferred authentication protocol by default? (yay/nay)</h4>






<pre tabindex="0"><code>nay</code></pre>
<br>
<h4 id="when-referring-to-kerberos-what-type-of-ticket-allows-us-to-request-further-tickets-known-as-tgs">When referring to Kerberos, what type of ticket allows us to request further tickets known as TGS?</h4>






<pre tabindex="0"><code>Ticket Granting Ticket</code></pre>
<br>
<h4 id="when-using-netntlm-is-a-users-password-transmitted-over-the-network-at-any-point-yaynay">When using NetNTLM, is a user&rsquo;s password transmitted over the network at any point? (yay/nay)</h4>






<pre tabindex="0"><code>nay</code></pre>
<br>
<h4 id="what-is-a-group-of-windows-domains-that-share-the-same-namespace-called">What is a group of Windows domains that share the same namespace called?</h4>






<pre tabindex="0"><code>Tree</code></pre>
<br>
<h4 id="what-should-be-configured-between-two-domains-for-a-user-in-domain-a-to-access-a-resource-in-domain-b">What should be configured between two domains for a user in Domain A to access a resource in Domain B?</h4>






<pre tabindex="0"><code>A Trust Relationship</code></pre>
<br>

  </content>
  
  <p>
    
    <a href="/blog/tryhackme/">#TryHackMe</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      

  <span>
    
    Made with
    <a href="https://github.com/maolonglong/hugo-simple/">Hugo ʕ•ᴥ•ʔ Simple</a>
  </span>


    </footer>

    
</body>
</html>
