<!doctype html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/images/favicon.png" />

<title>[HTB] Netmon&nbsp;|&nbsp;Wook&#39;s blog</title>
<meta
  name="title"
  content="[HTB] Netmon"
/>
<meta
  name="description"
  content="
As usual, I started with an nmap scan. There were a lot of open ports, but what immediately caught my eye was the FTP server. From the screenshot above, you can see that the Anonymous FTP login was allowed, and it appeared that the C drive directory accessible, which I could potentially get a lot of important information from.


As expected, I was able to obtain the user flag immediately after accessing the FTP server."
/>
<meta
  name="keywords"
  content="Hack The Box,"
/>

  <meta name="author" content="Wook Lee" />




<meta property="og:url" content="http://localhost:1313/htb-netmon/">
  <meta property="og:site_name" content="Wook&#39;s blog">
  <meta property="og:title" content="[HTB] Netmon">
  <meta property="og:description" content="As usual, I started with an nmap scan. There were a lot of open ports, but what immediately caught my eye was the FTP server. From the screenshot above, you can see that the Anonymous FTP login was allowed, and it appeared that the C drive directory accessible, which I could potentially get a lot of important information from.
As expected, I was able to obtain the user flag immediately after accessing the FTP server.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-08-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-08-12T00:00:00+00:00">
    <meta property="article:tag" content="Hack The Box">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[HTB] Netmon">
  <meta name="twitter:description" content="As usual, I started with an nmap scan. There were a lot of open ports, but what immediately caught my eye was the FTP server. From the screenshot above, you can see that the Anonymous FTP login was allowed, and it appeared that the C drive directory accessible, which I could potentially get a lot of important information from.
As expected, I was able to obtain the user flag immediately after accessing the FTP server.">





  <meta itemprop="name" content="[HTB] Netmon">
  <meta itemprop="description" content="As usual, I started with an nmap scan. There were a lot of open ports, but what immediately caught my eye was the FTP server. From the screenshot above, you can see that the Anonymous FTP login was allowed, and it appeared that the C drive directory accessible, which I could potentially get a lot of important information from.
As expected, I was able to obtain the user flag immediately after accessing the FTP server.">
  <meta itemprop="datePublished" content="2024-08-12T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-08-12T00:00:00+00:00">
  <meta itemprop="wordCount" content="486">
  <meta itemprop="keywords" content="Hack The Box">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/blog/"
    
    >Blog</a
  >


  <a href="/index.xml">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 448 512">
      
      <path
        d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
    RSS
  </a>

</nav>

<h1>[HTB] Netmon</h1>


    </header>
    <main>
      
  
    
      
      <p>
        <i>
          <time datetime="2024-08-12" pubdate>
            2024-08-12
          </time>
        </i>
      </p>
    
  
  
  <content>
    <p><img src="image.png#center" alt="alt text"></p>
<p>As usual, I started with an <strong><em>nmap</em></strong> scan. There were a lot of open ports, but what immediately caught my eye was the <strong><em>FTP</em></strong> server. From the screenshot above, you can see that the <strong><em>Anonymous FTP login</em></strong> was allowed, and it appeared that the C drive directory accessible, which I could potentially get a lot of important information from.</p>
<br>
<p><img src="image-1.png#center" alt="alt text">
As expected, I was able to obtain the user flag immediately after accessing the FTP server.</p>
<br>
<p><img src="image-2.png#center" alt="alt text">
Got the user flag.</p>
<br>
<p><img src="image-3.png#center" alt="alt text">
I navigated to the web page of the target address and it&rsquo;s titled <strong>PRTG Network Monitor</strong>.</p>
<br>
<p><img src="image-4.png#center" alt="alt text">
I googled <strong>&ldquo;PRTG Network Monitor default credentials&rdquo;</strong> and found the credentials above, <strong>prtgadmin:prtgadmin</strong>. However, they did not work.</p>
<br>
<p><img src="image-5.png#center" alt="alt text">
Also googled <strong>&ldquo;PRTG Network Monitor exploit&rdquo;</strong> and found the exploit above. But as you can see, it requires <strong>authenticated</strong> meaning I had to find the password first in order to run the exploit.</p>
<br>
<p><img src="image-7.png#center" alt="alt text">
While I was researching about the <strong>PRTG Network Monitor</strong> I found an interesting information about where it stores its data. The path of the default data folder is the following: <code>%programdata%\Paessler\PRTG Network Monitor</code>.</p>
<br>
<p><img src="image-6.png#center" alt="alt text">
I <strong>cd</strong> into the location path as learned and I found 3 <strong>PRTG Configuration</strong> files. Downloaded all of the 3 files using the command <code>get</code>.</p>
<br>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<p><img src="image-9.png#center" alt="alt text">
The command <strong>md5sum</strong> returned that the hash of the first two files are identical meaning the contents inside those files are exactly the same. So I just needed to check either of the files and the <strong>PRTG Configuration.old.bak</strong> file.</p>
<br>
<p><img src="image-10.png#center" alt="alt text">
Inside the first file I checked, the password was encrypted.</p>
<br>
<p><img src="image-11.png#center" alt="alt text">
Inside the <strong>PRTG Configuration.old.bak</strong> file, I found the credentials.</p>
<p><strong>Username: prtgadmin</strong>, <strong>Password: PrTg@dmin2018</strong></p>
<br>
<p><img src="image-12.png#center" alt="alt text">
Navigated back to the webpage to confirm if the credentials that I obtained actually work, and they did.</p>
<br>
<p><img src="image-13.png#center" alt="alt text">
Under the exploit-db page that I found earlier, there was this piece of information that instructed me to obtain the <strong>cookie</strong> info use it with the script and it will create a new user <strong>&lsquo;pentest&rsquo;</strong> in the administrators group with the password &lsquo;<strong>P3nT3st!</strong>&rsquo;.</p>
<br>
<p><img src="image-14.png#center" alt="alt text">
I powered on the <strong><em>burpsuite</em></strong> to intercept the traffic and get the cookie information.</p>
<br>
<p><img src="image-16.png#center" alt="alt text"></p>
<p><code>./prtg-exploit.sh -u http://10.10.10.152 -c &quot;_ga=GA1.4.620613745.1723521193; _gid=GA1.4.536926311.1723521193; OCTOPUS1813713946=ezYyRkZGRkIyLTg4MTYtNEU1NC1BQ0U3LTQ1MjdCRUY1QzI1QX0%3D; _gat=1&quot;</code></p>
<p>Once I grabbed the cookie information, I replaced the placeholder and ran the above script.</p>
<br>
<p><img src="image-17.png#center" alt="alt text">
The exploit successfully created new user <strong>&lsquo;pentest&rsquo;</strong> with password <strong>&lsquo;P3nT3st!&rsquo;</strong> just as expected!</p>
<br>
<p><img src="image-18.png#center" alt="alt text">
I could have used the <strong>msfconsole</strong> for getting the shell but I wanted to practice another way around and I learned about <strong><em>Impacket</em></strong>. It is a collection of Python classes for working with network protocols and of course used by pentesters.</p>
<br>
<p><img src="image-20.png#center" alt="alt text">
Installed the <strong><em>impacket-scripts</em></strong> to use <strong>psexec.py</strong> file. The <strong><em>psexec.py</em></strong> is often used during penestration tests to gain remote command execution on target systems once valid credentials are obtained. It can also help in lateral movement within a network by allowing attackers to execute commands on multiple machines using stolen or cracked credentials.</p>
<br>
<p><img src="image-19.png#center" alt="alt text">
<strong>psexec.py</strong> script with the obtained credentials got me the root administrator shell.</p>
<br>
<p><img src="image-21.png#center" alt="alt text">
Got the root flag!</p>
<br>
<p><img src="image-22.png#center" alt="alt text"></p>
<br>

  </content>
  
  <p>
    
    <a href="/blog/hack-the-box/">#Hack The Box</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      

  <span>
    
    Made with
    <a href="https://github.com/maolonglong/hugo-simple/">Hugo ʕ•ᴥ•ʔ Simple</a>
  </span>


    </footer>

    
</body>
</html>
