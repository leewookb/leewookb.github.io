<!doctype html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=51400&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/images/favicon.png" />

<title>[picoCTF] heap 1 &amp; heap 0&nbsp;|&nbsp;Wook&#39;s blog</title>
<meta
  name="title"
  content="[picoCTF] heap 1 &amp; heap 0"
/>
<meta
  name="description"
  content="heap 0 author: ABRXS, PR1OR1TYQ
Description Are overflows just a stack concern? Download the binary Download the source Here&rsquo;s the source code provided
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4 5#define FLAGSIZE_MAX 64 6// amount of memory allocated for input_data 7#define INPUT_DATA_SIZE 5 8// amount of memory allocated for safe_var 9#define SAFE_VAR_SIZE 5 10 11int num_allocs; 12char *safe_var; 13char *input_data; 14 15void check_win() { 16 if (strcmp(safe_var, &#34;bico&#34;) != 0) { 17 printf(&#34;\nYOU WIN\n&#34;); 18 19 // Print flag 20 char buf[FLAGSIZE_MAX]; 21 FILE *fd = fopen(&#34;flag."
/>
<meta
  name="keywords"
  content="picoCTF,"
/>

  <meta name="author" content="Wook Lee" />




<meta property="og:url" content="http://localhost:51400/picoctf-heap-1-heap-0/">
  <meta property="og:site_name" content="Wook&#39;s blog">
  <meta property="og:title" content="[picoCTF] heap 1 &amp; heap 0">
  <meta property="og:description" content="heap 0 author: ABRXS, PR1OR1TYQ
Description Are overflows just a stack concern? Download the binary Download the source Here’s the source code provided
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4 5#define FLAGSIZE_MAX 64 6// amount of memory allocated for input_data 7#define INPUT_DATA_SIZE 5 8// amount of memory allocated for safe_var 9#define SAFE_VAR_SIZE 5 10 11int num_allocs; 12char *safe_var; 13char *input_data; 14 15void check_win() { 16 if (strcmp(safe_var, &#34;bico&#34;) != 0) { 17 printf(&#34;\nYOU WIN\n&#34;); 18 19 // Print flag 20 char buf[FLAGSIZE_MAX]; 21 FILE *fd = fopen(&#34;flag.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-07-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-07-05T00:00:00+00:00">
    <meta property="article:tag" content="picoCTF">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[picoCTF] heap 1 &amp; heap 0">
  <meta name="twitter:description" content="heap 0 author: ABRXS, PR1OR1TYQ
Description Are overflows just a stack concern? Download the binary Download the source Here’s the source code provided
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4 5#define FLAGSIZE_MAX 64 6// amount of memory allocated for input_data 7#define INPUT_DATA_SIZE 5 8// amount of memory allocated for safe_var 9#define SAFE_VAR_SIZE 5 10 11int num_allocs; 12char *safe_var; 13char *input_data; 14 15void check_win() { 16 if (strcmp(safe_var, &#34;bico&#34;) != 0) { 17 printf(&#34;\nYOU WIN\n&#34;); 18 19 // Print flag 20 char buf[FLAGSIZE_MAX]; 21 FILE *fd = fopen(&#34;flag.">





  <meta itemprop="name" content="[picoCTF] heap 1 &amp; heap 0">
  <meta itemprop="description" content="heap 0 author: ABRXS, PR1OR1TYQ
Description Are overflows just a stack concern? Download the binary Download the source Here’s the source code provided
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4 5#define FLAGSIZE_MAX 64 6// amount of memory allocated for input_data 7#define INPUT_DATA_SIZE 5 8// amount of memory allocated for safe_var 9#define SAFE_VAR_SIZE 5 10 11int num_allocs; 12char *safe_var; 13char *input_data; 14 15void check_win() { 16 if (strcmp(safe_var, &#34;bico&#34;) != 0) { 17 printf(&#34;\nYOU WIN\n&#34;); 18 19 // Print flag 20 char buf[FLAGSIZE_MAX]; 21 FILE *fd = fopen(&#34;flag.">
  <meta itemprop="datePublished" content="2024-07-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-07-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="1671">
  <meta itemprop="keywords" content="picoCTF">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/blog/"
    
    >Blog</a
  >

  <a
    href="/photos/"
    
    >Photos</a
  >


  <a href="/index.xml">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 448 512">
      
      <path
        d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
    RSS
  </a>

</nav>

<h1>[picoCTF] heap 1 &amp; heap 0</h1>


    </header>
    <main>
      
  
    
      
      <p>
        <i>
          <time datetime="2024-07-05" pubdate>
            2024-07-05
          </time>
        </i>
      </p>
    
  
  
  <content>
    <h3 id="heap-0">heap 0</h3>
<p><em>author: ABRXS, PR1OR1TYQ</em></p>
<h4 id="description">Description</h4>
<p>Are overflows just a stack concern? <br>
Download the binary <br>
Download the source <br></p>
<p>Here&rsquo;s the source code provided</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  2</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  3</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  4</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  5</span><span><span style="color:#6c7086;font-style:italic">#define FLAGSIZE_MAX 64
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  6</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for input_data
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  7</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define INPUT_DATA_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  8</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  9</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define SAFE_VAR_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 10</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 11</span><span><span style="color:#f38ba8">int</span> num_allocs;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 12</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>safe_var;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 13</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>input_data;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 15</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 16</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>) <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">0</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 17</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 19</span><span>        <span style="color:#6c7086;font-style:italic">// Print flag
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 20</span><span><span style="color:#6c7086;font-style:italic"></span>        <span style="color:#f38ba8">char</span> buf[FLAGSIZE_MAX];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 21</span><span>        FILE <span style="color:#89dceb;font-weight:bold">*</span>fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 22</span><span>        <span style="color:#89b4fa">fgets</span>(buf, FLAGSIZE_MAX, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 23</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 24</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 26</span><span>        <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 27</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 28</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Looks like everything is still secure!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 29</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">No flage for you :(</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 30</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 31</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 32</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 34</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_menu</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 35</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">1. Print Heap:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(print the current state of the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 36</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">2. Write to buffer:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(write to your own personal block of data &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 37</span><span>           <span style="color:#a6e3a1">&#34;on the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 38</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">3. Print safe_var:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(I&#39;ll even let you look at my variable on &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 39</span><span>           <span style="color:#a6e3a1">&#34;the heap, &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 40</span><span>           <span style="color:#a6e3a1">&#34;I&#39;m confident it can&#39;t be modified)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 41</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">4. Print Flag:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(Try to print the flag, good luck)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 42</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">5. Exit</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Enter your choice: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 43</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 44</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 46</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">init</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 47</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">Welcome to heap0!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 48</span><span>    <span style="color:#89b4fa">printf</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 49</span><span>        <span style="color:#a6e3a1">&#34;I put my data on the heap so it should be safe from any tampering.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 50</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Since my data isn&#39;t on the stack I&#39;ll even let you write whatever &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 51</span><span>           <span style="color:#a6e3a1">&#34;info you want to the heap, I already took care of using malloc for &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 52</span><span>           <span style="color:#a6e3a1">&#34;you.</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 53</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 54</span><span>    input_data <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 55</span><span>    <span style="color:#89b4fa">strncpy</span>(input_data, <span style="color:#a6e3a1">&#34;pico&#34;</span>, INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 56</span><span>    safe_var <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 57</span><span>    <span style="color:#89b4fa">strncpy</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>, SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 58</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 60</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 61</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 62</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 63</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 64</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 66</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_heap</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 67</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Heap State:</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 68</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 69</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*] Address   -&gt;   Heap Data   </span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 70</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 71</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, input_data, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 72</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 73</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, safe_var, safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 74</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 75</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 76</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 77</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 78</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>(<span style="color:#f38ba8">void</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 79</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 80</span><span>    <span style="color:#6c7086;font-style:italic">// Setup
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 81</span><span><span style="color:#6c7086;font-style:italic"></span>    <span style="color:#89b4fa">init</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 82</span><span>    <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 83</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 84</span><span>    <span style="color:#f38ba8">int</span> choice;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 85</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 86</span><span>    <span style="color:#cba6f7">while</span> (<span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 87</span><span>        <span style="color:#89b4fa">print_menu</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 88</span><span>	<span style="color:#f38ba8">int</span> rval <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%d&#34;</span>, <span style="color:#89dceb;font-weight:bold">&amp;</span>choice);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 89</span><span>	<span style="color:#cba6f7">if</span> (rval <span style="color:#89dceb;font-weight:bold">==</span> EOF){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 90</span><span>	    <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 91</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 92</span><span>        <span style="color:#cba6f7">if</span> (rval <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 93</span><span>            <span style="color:#6c7086;font-style:italic">//printf(&#34;Invalid input. Please enter a valid choice.\n&#34;);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 94</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//fflush(stdout);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 95</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">// Clear input buffer
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 96</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//while (getchar() != &#39;\n&#39;);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 97</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//continue;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 98</span><span><span style="color:#6c7086;font-style:italic"></span>	    <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 99</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">100</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">101</span><span>        <span style="color:#cba6f7">switch</span> (choice) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">102</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">103</span><span>            <span style="color:#6c7086;font-style:italic">// print heap
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">104</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">105</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">106</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">107</span><span>            <span style="color:#89b4fa">write_buffer</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">108</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">109</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">110</span><span>            <span style="color:#6c7086;font-style:italic">// print safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">111</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Take a look at my variable: safe_var = %s</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">112</span><span>                   safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">113</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">114</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">115</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">116</span><span>            <span style="color:#6c7086;font-style:italic">// Check for win condition
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">117</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">check_win</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">118</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">119</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">120</span><span>            <span style="color:#6c7086;font-style:italic">// exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">121</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">122</span><span>        <span style="color:#cba6f7">default</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">123</span><span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Invalid choice</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">124</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">125</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">126</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">127</span><span>}</span></span></code></pre></div>
<p>If you look closely at the <code>check_win</code> function, our job is to make <code>safe_var</code> variable and the string <code>bico</code> not equal to each other. We can see that the variables <code>input_data</code> and <code>safe_var</code> are allocated 5 bytes of memory. The allocations are likely to be sequential, meaning <code>input_data</code> and <code>safe_var</code> are placed next to each other in memory.</p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>}</span></span></code></pre></div>
<p>Check out the <code>write_buffer</code> function. We can write data to <code>input_data</code> variable, meaning if we write more data than it can hold, it will result in a <strong><em>buffer overflow</em></strong> and the extra bytes will overflow into the memory space allocated for <code>safe_var</code> and eventually overwrite the data of <code>safe_var</code> variable.</p>
<p>First, we are going to select <code>2</code> to write to buffer, and as we can see from the heap table, the address of <strong>input_data</strong> is <code>0x5e2f114332b0</code> and the address of <strong>safe_var</strong> is <code>0x5e2f114332d0</code>. They are 0x20 hexadecimal digits, or 32 bits apart. Therefore, all we gotta do is input more than 32 bits to overflow the input_data and eventually overwrite safe_var variable.</p>






<pre tabindex="0"><code>1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 2
Data for buffer: abcdefghijklmnopqrstuvwxyz1234567890

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 3


Take a look at my variable: safe_var = 7890


1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 4

YOU WIN
picoCTF{my_first_heap_overflow_c3935a08}</code></pre>
<p><strong><em>flag</em></strong>: picoCTF{my_first_heap_overflow_c3935a08}</p>
<hr>
<h3 id="heap-1">heap 1</h3>
<p><em>author: ABRXS, PR1OR1TYQ</em></p>
<h4 id="description-1">Description</h4>
<p>Can you control your overflow?
Connect with the challenge instance here:
nc tethys.picoctf.net 50046</p>
<br>
<p>Here is the source code provided</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  2</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  3</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  4</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  5</span><span><span style="color:#6c7086;font-style:italic">#define FLAGSIZE_MAX 64
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  6</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for input_data
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  7</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define INPUT_DATA_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  8</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  9</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define SAFE_VAR_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 10</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 11</span><span><span style="color:#f38ba8">int</span> num_allocs;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 12</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>safe_var;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 13</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>input_data;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 15</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 16</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;pico&#34;</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 17</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 19</span><span>        <span style="color:#6c7086;font-style:italic">// Print flag
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 20</span><span><span style="color:#6c7086;font-style:italic"></span>        <span style="color:#f38ba8">char</span> buf[FLAGSIZE_MAX];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 21</span><span>        FILE <span style="color:#89dceb;font-weight:bold">*</span>fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 22</span><span>        <span style="color:#89b4fa">fgets</span>(buf, FLAGSIZE_MAX, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 23</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 24</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 26</span><span>        <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 27</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 28</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Looks like everything is still secure!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 29</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">No flage for you :(</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 30</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 31</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 32</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 34</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_menu</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 35</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">1. Print Heap:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(print the current state of the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 36</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">2. Write to buffer:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(write to your own personal block of data &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 37</span><span>           <span style="color:#a6e3a1">&#34;on the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 38</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">3. Print safe_var:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(I&#39;ll even let you look at my variable on &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 39</span><span>           <span style="color:#a6e3a1">&#34;the heap, &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 40</span><span>           <span style="color:#a6e3a1">&#34;I&#39;m confident it can&#39;t be modified)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 41</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">4. Print Flag:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(Try to print the flag, good luck)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 42</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">5. Exit</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Enter your choice: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 43</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 44</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 46</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">init</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 47</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">Welcome to heap1!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 48</span><span>    <span style="color:#89b4fa">printf</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 49</span><span>        <span style="color:#a6e3a1">&#34;I put my data on the heap so it should be safe from any tampering.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 50</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Since my data isn&#39;t on the stack I&#39;ll even let you write whatever &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 51</span><span>           <span style="color:#a6e3a1">&#34;info you want to the heap, I already took care of using malloc for &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 52</span><span>           <span style="color:#a6e3a1">&#34;you.</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 53</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 54</span><span>    input_data <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 55</span><span>    <span style="color:#89b4fa">strncpy</span>(input_data, <span style="color:#a6e3a1">&#34;pico&#34;</span>, INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 56</span><span>    safe_var <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 57</span><span>    <span style="color:#89b4fa">strncpy</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>, SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 58</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 60</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 61</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 62</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 63</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 64</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 66</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_heap</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 67</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Heap State:</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 68</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 69</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*] Address   -&gt;   Heap Data   </span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 70</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 71</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, input_data, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 72</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 73</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, safe_var, safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 74</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 75</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 76</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 77</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 78</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>(<span style="color:#f38ba8">void</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 79</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 80</span><span>    <span style="color:#6c7086;font-style:italic">// Setup
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 81</span><span><span style="color:#6c7086;font-style:italic"></span>    <span style="color:#89b4fa">init</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 82</span><span>    <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 83</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 84</span><span>    <span style="color:#f38ba8">int</span> choice;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 85</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 86</span><span>    <span style="color:#cba6f7">while</span> (<span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 87</span><span>        <span style="color:#89b4fa">print_menu</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 88</span><span>	<span style="color:#cba6f7">if</span> (<span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%d&#34;</span>, <span style="color:#89dceb;font-weight:bold">&amp;</span>choice) <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">1</span>) <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 89</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 90</span><span>        <span style="color:#cba6f7">switch</span> (choice) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 91</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 92</span><span>            <span style="color:#6c7086;font-style:italic">// print heap
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 93</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 94</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 95</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 96</span><span>            <span style="color:#89b4fa">write_buffer</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 97</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 98</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 99</span><span>            <span style="color:#6c7086;font-style:italic">// print safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">100</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Take a look at my variable: safe_var = %s</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">101</span><span>                   safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">102</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">103</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">104</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">105</span><span>            <span style="color:#6c7086;font-style:italic">// Check for win condition
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">106</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">check_win</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">107</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">108</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">109</span><span>            <span style="color:#6c7086;font-style:italic">// exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">110</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">111</span><span>        <span style="color:#cba6f7">default</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">112</span><span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Invalid choice</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">113</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">114</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">115</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">116</span><span>}</span></span></code></pre></div>
<br>
<p>Check out <code>check_win</code> function for the win condition:</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;pico&#34;</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);</span></span></code></pre></div>
<p>Heap 1 task is every similar to Heap 0. The only difference is that we need to make the value of <code>safe_var</code> variable to &ldquo;<strong>pico</strong>&rdquo;. The address values of the variables are the same with Heap 0. Therefore, we already know they are 32bits apart. All we need to do is input 32-bit long characters to fill <code>input_data</code> variable and type &ldquo;<strong>pico</strong>&rdquo; after to overwrite the value of <code>safe_var</code> variable.</p>
<br>
<br>
<br>
Here's the solution:






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>Welcome to heap1!
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>I put my data on the heap so it should be safe from any tampering.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Since my data isn<span style="color:#a6e3a1">&#39;t on the stack I&#39;</span>ll even <span style="color:#89dceb">let</span> you write whatever info you want to the heap, I already took care of using malloc <span style="color:#cba6f7">for</span> you.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Heap State:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Address   -&gt;   Heap Data
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span>   0x63e0c8e3d2b0  -&gt;   pico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span>   0x63e0c8e3d2d0  -&gt;   bico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>1. Print Heap:          <span style="color:#89dceb;font-weight:bold">(</span>print the current state of the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>2. Write to buffer:     <span style="color:#89dceb;font-weight:bold">(</span>write to your own personal block of data on the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>3. Print safe_var:      <span style="color:#89dceb;font-weight:bold">(</span>I<span style="color:#a6e3a1">&#39;ll even let you look at my variable on the heap, I&#39;</span>m confident it can<span style="color:#a6e3a1">&#39;t be modified)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#a6e3a1">4. Print Flag:          (Try to print the flag, good luck)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#a6e3a1">5. Exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#a6e3a1">Enter your choice: 2
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#a6e3a1">Data for buffer: abcdefghijklmnopqrstuvwxyz123456pico
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#a6e3a1">1. Print Heap:          (print the current state of the heap)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#a6e3a1">2. Write to buffer:     (write to your own personal block of data on the heap)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span><span style="color:#a6e3a1">3. Print safe_var:      (I&#39;</span>ll even <span style="color:#89dceb">let</span> you look at my variable on the heap, I<span style="color:#a6e3a1">&#39;m confident it can&#39;</span>t be modified<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>4. Print Flag:          <span style="color:#89dceb;font-weight:bold">(</span>Try to print the flag, good luck<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>5. Exit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>Enter your choice: <span style="color:#fab387">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>Take a look at my variable: <span style="color:#f5e0dc">safe_var</span> <span style="color:#89dceb;font-weight:bold">=</span> pico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>1. Print Heap:          <span style="color:#89dceb;font-weight:bold">(</span>print the current state of the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>2. Write to buffer:     <span style="color:#89dceb;font-weight:bold">(</span>write to your own personal block of data on the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>3. Print safe_var:      <span style="color:#89dceb;font-weight:bold">(</span>I<span style="color:#a6e3a1">&#39;ll even let you look at my variable on the heap, I&#39;</span>m confident it can<span style="color:#f38ba8">&#39;</span>t be modified<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>4. Print Flag:          <span style="color:#89dceb;font-weight:bold">(</span>Try to print the flag, good luck<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span>5. Exit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>Enter your choice: <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>YOU WIN
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>starting_to_get_the_hang_ce5bee9b<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p><strong><em>flag</em></strong>: picoCTF{starting_to_get_the_hang_ce5bee9b}</p>
<hr>

  </content>
  
  <p>
    
    <a href="/blog/picoctf/">#picoCTF</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      

  <span>
    
    Made with
    <a href="https://github.com/maolonglong/hugo-simple/">Hugo ʕ•ᴥ•ʔ Simple</a>
  </span>


    </footer>

    
</body>
</html>
